{"category":"Svelte","posts":[{"sectids":"","toc-placement":"auto","notitle":"","stylesheet":"","webfonts":"","prewrap":"","attribute-undefined":"drop-line","attribute-missing":"skip","iconfont-remote":"","caution-caption":"Caution","important-caption":"Important","note-caption":"Note","tip-caption":"Tip","warning-caption":"Warning","example-caption":"Example","figure-caption":"Figure","table-caption":"Table","toc-title":"Table of Contents","section-refsig":"Section","part-refsig":"Part","chapter-refsig":"Chapter","appendix-refsig":"Appendix","appendix-caption":"Appendix","untitled-label":"Untitled","version-label":"Version","last-update-label":"Last updated","docfile":"pwa-lessons-learned-cra.en.adoc","docdir":"","docfilesuffix":".adoc","docname":"pwa-lessons-learned-cra.en","embedded":"","asciidoctor":"","asciidoctor-version":"2.0.10","safe-mode-name":"secure","safe-mode-secure":"","safe-mode-level":20,"max-include-depth":64,"user-home":".","backend":"html5","max-attribute-value-size":4096,"linkcss":"","doctype":"article","htmlsyntax":"html","backend-html5-doctype-article":"","doctype-article":"","backend-html5":"","outfilesuffix":".html","filetype":"html","filetype-html":"","basebackend-html-doctype-article":"","basebackend-html":"","basebackend":"html","stylesdir":".","iconsdir":"./images/icons","localdate":"2020-04-26","localyear":"2020","localtime":"18:11:34 +0200","localdatetime":"2020-04-26 18:11:34 +0200","docdate":"2020-04-19","docyear":"2020","doctime":"10:46:31 +0200","docdatetime":"2020-04-19 10:46:31 +0200","doctitle":"Lessons learned developing a PWA with Create React App","date":"2019/11/04","lang":"en","keywords":["React","Typescript","CRA","PWA","Create React App","Firebase","Firestore","Svelte","Sapper"],"link":"https://btapp.netlify.com","description":"Lessons learned developing a PWA: Budget Tracker","toc":"","react":"https://reactjs.org[React,window=_blank]","webpack":"https://webpack.js.org[Webpack,window=_blank]","parcel":"https://parceljs.org[Parcel,window=_blank]","cra":"https://create-react-app.dev[CRA,window=_blank]","cralong":"https://create-react-app.dev[Create React App,window=_blank]","pwa":"https://developers.google.com/web/progressive-web-apps/[PWA,window=_blank]","typescript":"https://www.typescriptlang.org[Typescript,window=_blank]","material-ui":"https://material-ui.com[Material UI,window=_blank]","frappe":"https://frappe.io/charts[Frappe charts,window=_blank]","btapp":"https://btapp.netlify.com[Budget Tracker,window=_blank]","sw":"https://developers.google.com/web/fundamentals/primers/service-workers[Service Worker,window=_blank]","firestore":"https://firebase.google.com/docs/firestore[Firestore,window=_blank]","firebase-auth":"https://firebase.google.com/docs/auth[Firebase Authentication,window=_blank]","ww":"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers[Web Workers,window=_blank]","indexeddb":"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API[IndexedDB,window=_blank]","svelte":"https://svelte.dev[Svelte,window=_blank]","sapper":"https://sapper.svelte.dev[Sapper,window=_blank]","firebase":"https://firebase.google.com/[Firebase,window=_blank]","authorcount":0,"title":"Lessons learned developing a PWA with Create React App","summary":"Lessons learned developing a PWA: Budget Tracker","html":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">Table of Contents</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_chosen_technology_stack_for_budget_tracker\">Chosen Technology Stack for Budget Tracker</a></li>\n<li><a href=\"#_create_react_application_cra\">Create React Application: CRA</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_service_worker\">Service worker</a></li>\n<li><a href=\"#_web_worker\">Web worker</a></li>\n<li><a href=\"#_webpack\">Webpack</a></li>\n</ul>\n</li>\n<li><a href=\"#_firebase\">Firebase</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_drawbacks\">Drawbacks</a></li>\n<li><a href=\"#_firebase_alternatives\">Firebase alternatives</a></li>\n</ul>\n</li>\n<li><a href=\"#_ui_components_library_material_ui\">UI Components Library: Material UI</a></li>\n<li><a href=\"#_charts_library\">Charts library</a></li>\n<li><a href=\"#_conclusion\">Conclusion</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_do_not_go_for_cra_if\">Do not go for CRA if</a></li>\n<li><a href=\"#_do_not_go_for_firestore_if\">Do not go for Firestore if</a></li>\n<li><a href=\"#_do_not_go_blindly_for_the_best_charting_library\">Do not go blindly for the best charting library</a></li>\n</ul>\n</li>\n<li><a href=\"#_what_next\">What next?</a></li>\n</ul>\n</div>\n<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>I started working with <a href=\"https://reactjs.org\" target=\"_blank\" rel=\"noopener\">React</a> few year ago, always the project creation was from scratch, not using any template/scaffolding. Regarding bundlers normally I used either <a href=\"https://webpack.js.org\" target=\"_blank\" rel=\"noopener\">Webpack</a> at work or <a href=\"https://parceljs.org\" target=\"_blank\" rel=\"noopener\">Parcel</a> for personal projects.</p>\n</div>\n<div class=\"paragraph\">\n<p>Few months ago, I wanted to start a personal project to keep track of my travel expenses. I was in a kind of rush because at that time, I was almost in the middle of my gap year, I wanted to focus on implementing main functionality and get an <a href=\"https://en.wikipedia.org/wiki/Minimum_viable_product\">MVP</a> (minimum viable product) the sooner the better, so I thought it was the right time to try out <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">Create React App</a> or <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Note</div>\n</td>\n<td class=\"content\">\n<a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a> allows you to have a production ready <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> in <a href=\"https://reactjs.org\" target=\"_blank\" rel=\"noopener\">React</a> quickly, which is awesome. They take care of configuration and package dependencies, you only have to take care of dependencies you need for your project and of course, implement your project, <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a> is good, but is not magic.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>As I said, I wanted to be implementing business logic ASAP, so together with using <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>, I also took other decisions/shortcuts driven by the need of speeding up the development pace, I will talk about those choices in following sections describing some drawbacks and benefits.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_chosen_technology_stack_for_budget_tracker\">Chosen Technology Stack for <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a></h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a></p>\n</li>\n<li>\n<p><a href=\"https://reactjs.org\" target=\"_blank\" rel=\"noopener\">React</a></p>\n</li>\n<li>\n<p><a href=\"https://www.typescriptlang.org\" target=\"_blank\" rel=\"noopener\">Typescript</a></p>\n</li>\n<li>\n<p><a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a></p>\n</li>\n<li>\n<p><span class=\"line-through\"><a href=\"https://formidable.com/open-source/victory\">Victory</a></span> <a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a></p>\n</li>\n<li>\n<p><a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a></p>\n</li>\n<li>\n<p><a href=\"https://firebase.google.com/docs/auth\" target=\"_blank\" rel=\"noopener\">Firebase Authentication</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>So far I am quite happy with the outcome, but with the lessons learned while developing this app, <strong>in the future, with enough time, most likely I will not choose same technology stack again</strong>. You can try the application <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> and judge for yourself.</p>\n</div>\n<div class=\"paragraph\">\n<p>Along this post I will describe what are, in my experience, the benefits and drawbacks of taking these shortcuts and technical decisions.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_create_react_application_cra\">Create React Application: <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a></h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">Create React App</a> doesn’t support <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a> neither allows to customize <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers\" target=\"_blank\" rel=\"noopener\">Service Worker</a> implementation without <a href=\"https://stackoverflow.com/questions/49737652/what-does-eject-do-in-create-react-app\">ejecting</a>.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_service_worker\">Service worker</h3>\n<div class=\"paragraph\">\n<p>You might want to customize your <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers\" target=\"_blank\" rel=\"noopener\">Service Worker</a> to send/receive <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Client/postMessage\">post messages</a>, to perform <a href=\"https://wicg.github.io/BackgroundSync/spec/\">background sync</a> or <a href=\"https://developer.mozilla.org/en/docs/Web/API/notification\">show web notifications</a>. In that case, you will have to <a href=\"https://stackoverflow.com/questions/49737652/what-does-eject-do-in-create-react-app\">eject your project</a> and maintain the configuration by yourself, which might imply a little bit of headache.</p>\n</div>\n<div class=\"paragraph\">\n<p>There are <a href=\"https://www.freecodecamp.org/news/how-to-customize-service-workers-with-create-react-app-4424dda6210c/\">other options to customize service worker and avoid ejecting CRA</a>, but they are not straightforward enough for my taste.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_web_worker\">Web worker</h3>\n<div class=\"paragraph\">\n<p>If you need to perform any heavy processing without blocking the main thread, you can just use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a>, but this feature is not supported by <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>. The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a> can communicate with main thread using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Client/postMessage\">post messages</a> and it can also show <a href=\"https://medium.com/young-coder/a-simple-introduction-to-web-workers-in-javascript-b3504f9d9d1c\">web push notifications</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>There are also <a href=\"https://medium.com/@danilog1905/how-to-use-web-workers-with-react-create-app-and-not-ejecting-in-the-attempt-3718d2a1166b\">other options to use Web Workers in CRA and not eject</a>, but they imply quite some extra work.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_webpack\">Webpack</h3>\n<div class=\"paragraph\">\n<p><a href=\"https://webpack.js.org\" target=\"_blank\" rel=\"noopener\">Webpack</a> is the bundler used by <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>. You don’t need to know much about it, unless you <a href=\"https://stackoverflow.com/questions/49737652/what-does-eject-do-in-create-react-app\">eject your project</a>, then you will have to deal with <a href=\"https://webpack.js.org/configuration/\">Webpack configuration file</a>, this is just a warning, just in case you are not comfortable with it.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_firebase\">Firebase</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> supports data synchronization between different devices, so it requires a <a href=\"https://en.wikipedia.org/wiki/Front_and_back_ends\">backend</a> side to deal with authentication and to save/read data remotely. I considered two options: <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> or implement <a href=\"https://en.wikipedia.org/wiki/Representational_state_transfer\">REST</a> API.</p>\n</div>\n<div class=\"paragraph\">\n<p>For this <a href=\"https://en.wikipedia.org/wiki/Front_and_back_ends\">backend</a>, I chose <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> because it is super easy to implement, because there is nothing to implement. You only have to configure <a href=\"https://support.google.com/firebase/answer/6400716?hl=en\">authentication methods</a> and <a href=\"https://firebase.google.com/docs/firestore/security/get-started\">security rules</a> for <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>But <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> brings some drawbacks you must know before choosing it.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_drawbacks\">Drawbacks</h3>\n<div class=\"sect3\">\n<h4 id=\"_bundle_size\">Bundle size</h4>\n<div class=\"paragraph\">\n<p>I got really shocked first time I analyzed <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> bundle size after integrating it with <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a>, <strong>it grew around a 39%!</strong></p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>27% from <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> library.</p>\n</li>\n<li>\n<p>12% from <a href=\"https://firebase.google.com/docs/auth\" target=\"_blank\" rel=\"noopener\">Firebase Authentication</a> library.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Happily <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> implementation is following <a href=\"https://reactjs.org/docs/code-splitting.html\">code-splitting</a> principle, so user experience was not really affected with this integration. But user’s device will eventually have to download this extra 39% (<strong>539KB</strong>).</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_offline_first_not_really\">Offline first, not really</h4>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Important</div>\n</td>\n<td class=\"content\">\nThis section is not relevant if your use case doesn’t imply saving data linked to the user.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> requires user to be authenticated, but <a href=\"https://firebase.google.com/docs/auth/web/anonymous-auth\">user can be anonymous</a>, this is really cool feature if you don’t want to force the user to identify to use the app.</p>\n</div>\n<div class=\"paragraph\">\n<p>Another very useful and cool <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> feature is that <a href=\"https://firebase.google.com/docs/firestore/manage-data/enable-offline\">it supports offline mode</a>, so data can be saved and read even there is no Internet connection.</p>\n</div>\n<div class=\"paragraph\">\n<p>Anonymous user + offline mode features will allow an application to work as offline first.</p>\n</div>\n<div class=\"paragraph\">\n<p>So… what is this <a href=\"#Offline first\">not really</a> issue about? Let me explain a tricky scenario. First time the application is opened, <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> needs to authenticate the user, to do so, user’s device has to be connected to Internet, so <strong>you have to consider following scenario</strong> and either be OK with it or deal with it:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p><a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> is installed in your device.</p>\n</li>\n<li>\n<p>User is not authenticated.</p>\n</li>\n<li>\n<p>User’s device is offline.</p>\n</li>\n<li>\n<p>User opens the <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> and tries to save some data.</p>\n</li>\n<li>\n<p><strong>That data won’t be saved correctly</strong>, because there is no user to link the data with, not even an anonymous user, because application needs to call <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> API to create an anonymous user.</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>This is not big deal, because it will seldom occur. If you want to deal with it anyway, check next section explaining how and why I did deal with this scenario.</p>\n</div>\n<div class=\"sect4\">\n<h5 id=\"_how_did_i_deal_with_this_issue_with_budget_tracker\">How did I deal with this issue with Budget Tracker?</h5>\n<div class=\"paragraph\">\n<p>First of all, this <strong>might not be an issue for your use case</strong>, because it will happen only first time application is loaded. I just wanted <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> to be fully offline first, because it brings other benefits.</p>\n</div>\n<div class=\"sect5\">\n<h6 id=\"_implementation_details\">Implementation details</h6>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Implement 2 persistence layers: Local (<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\" target=\"_blank\" rel=\"noopener\">IndexedDB</a>) and Remote (<a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>).</p>\n</li>\n<li>\n<p>Save always data locally, regardless user authentication status.</p>\n</li>\n<li>\n<p>If there is any authenticated user, after saving to local layer, propagate same action to remote layer (<a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>) asynchronously.</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect5\">\n<h6 id=\"_benefits\">Benefits</h6>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>If user is not authenticated, <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> won’t load <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> client bundle. As I explained before, it is 27% of application size.</p>\n</li>\n<li>\n<p>Application reads and writes are faster, because latest valid data is always saved locally.</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><strong>Clarification</strong>: Save data in <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> is also fast, because data is also cached locally, but it does a little bit more than just saving to <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\" target=\"_blank\" rel=\"noopener\">IndexedDB</a> and you need an authenticated user.</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>You can find a <a href=\"https://github.com/carlosvin/budget-tracker/blob/master/doc/preformance.md#desktop-slow-clear-storage-0-budgets-1\">more detailed performance report</a>, where I analyze 3 different implementations:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Only <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> client.</p>\n</li>\n<li>\n<p>Local (<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\" target=\"_blank\" rel=\"noopener\">IndexedDB</a>) and remote (<a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>) persistence layers.</p>\n</li>\n<li>\n<p>Same as previous one, but remote layer implemented in service worker.</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>The performance results were in general better for option 2.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_data_model\">Data model</h4>\n<div class=\"paragraph\">\n<p>Firestore API is easy and intuitive, I really like it, but don’t assume it will have same features as other document DBs or SQL DBs.</p>\n</div>\n<div class=\"paragraph\">\n<p>Check if <a href=\"https://googleapis.github.io/google-cloud-dotnet/docs/Google.Cloud.Firestore/datamodel.html\">Firestore limitations</a> fit into your data model, or if it is not too late, define your data model following <a href=\"https://cloud.google.com/firestore/docs/best-practices\">Firestore best practices</a> and having those limitations in mind.</p>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_firebase_alternatives\">Firebase alternatives</h3>\n<div class=\"paragraph\">\n<p>Besides implementing a <a href=\"https://en.wikipedia.org/wiki/Representational_state_transfer\">REST</a> API, there are other services similar to <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> with smaller client bundle size and other features which might fit better to your requirements.</p>\n</div>\n<div class=\"paragraph\">\n<p>Consider other alternatives:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Based on <a href=\"http://couchdb.apache.org/\">Apache CouchDB</a>: <a href=\"https://pouchdb.com\">PouchDB</a>, <a href=\"https://en.wikipedia.org/wiki/Cloudant\">Cloudant</a>.</p>\n</li>\n<li>\n<p>Based on <a href=\"https://parseplatform.org/\">Parse server</a>: <a href=\"https://www.back4app.com\">back4apps</a>.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_ui_components_library_material_ui\">UI Components Library: <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a></h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>I chose <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a>.</p>\n</div>\n<div class=\"quoteblock\">\n<blockquote>\nReact components for faster and easier web development. Build your own design system, or start with Material Design.\n</blockquote>\n<div class=\"attribution\">\n&#8212; https://material-ui.com[Material UI\n</div>\n</div>\n<div class=\"paragraph\">\n<p>There were two reasons which drove me to use <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a>:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>To create simple UI components which are accessible, <a href=\"https://material-ui.com/guides/responsive-ui/#responsive-ui\">responsive</a> and with a consistent design is tricky and time consuming.</p>\n</li>\n<li>\n<p>It has SVG set of <a href=\"https://material-ui.com/components/material-icons/\">Material Icons</a>. <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> allows to create categories defined by a name and a selectable icon, so this icon set was really convenient.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>There are some <strong>drawbacks</strong>, not very important in my opinion, maybe the most annoying for me is the first one:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://jestjs.io/docs/en/snapshot-testing\">Jest Snapshots</a> + <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a>: The snapshots are generated with <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a> CSS class names, but CSS classes order might not be deterministic, so a test might pass in your local host but not in <a href=\"https://en.wikipedia.org/wiki/Continuous_integration\">CI</a> host. They are working on solve <a href=\"https://github.com/mui-org/material-ui/issues/14357\">this issue, more info at github</a>.</p>\n</li>\n<li>\n<p>Performance: There are some performance <a href=\"https://github.com/mui-org/material-ui/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+is%3Aopen+performance\">issues in Github</a>. During last months, whilst I’ve been using this library, I can say they are working hard on fix them and bring new features.</p>\n</li>\n<li>\n<p>UI components libraries are complex and do quite a lot work, so most of them are quite heavy. <a href=\"https://bundlephobia.com/result?p=@material-ui/core@4.5.2\">Material UI bundle size weights: 304.2kB minified</a>. You can find some <a href=\"https://material-ui.com/guides/minimizing-bundle-size\">recommendations to reduce bundle size at Material UI website</a>.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_charts_library\">Charts library</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Many of the chart libraries I’ve found are really powerful and complete, but they are also heavy because they depend on other third party libraries like <a href=\"https://d3js.org/\">D3</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Initially I chose <a href=\"https://formidable.com/open-source/victory\">Victory</a>, but I realized that I only needed charts to show percentages and time series and <a href=\"https://formidable.com/open-source/victory\">Victory</a>’s <a href=\"https://bundlephobia.com/result?p=victory@33.1.2\">bundle size is 468KB minified</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>After quick search in the Internet I discovered other lighter alternatives:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a> <a href=\"https://bundlephobia.com/result?p=frappe-charts@1.3.0\">63KB minified</a>.</p>\n</li>\n<li>\n<p><a href=\"https://gionkunz.github.io/chartist-js\">Chartist</a> <a href=\"https://bundlephobia.com/result?p=chartist@0.11.4\">39KB minified</a>.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>I tried them and I liked both. I chose <a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a> because I thought its default color scheme fits better with <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> theme.</p>\n</div>\n<div class=\"paragraph\">\n<p>Both libraries come with more chart types than just bars and XY axis, take a quick look at their websites if you are interested about their supported chart set and to check how they look like.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_conclusion\">Conclusion</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>I will try to come up with a conclusion better than: <em>\"It depends\"</em>, <em>\"Your use case will tell you\"</em> and so on.</p>\n</div>\n<div class=\"paragraph\">\n<p>That said. It depends on your needs :p.</p>\n</div>\n<div class=\"paragraph\">\n<p>Seriously, let’s play <em>\"do not go for … if …\"</em>:</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_do_not_go_for_cra_if\">Do not go for CRA if</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>You want to customize <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers\" target=\"_blank\" rel=\"noopener\">Service Worker</a> for <a href=\"https://developers.google.com/web/updates/2015/12/background-sync\">Background sync</a> or <a href=\"https://developer.mozilla.org/en/docs/Web/API/notification\">showing push notifications</a>.</p>\n</li>\n<li>\n<p>You want to use <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a>.</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_do_not_go_for_firestore_if\">Do not go for Firestore if</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>You are aiming for your app to be hit by many users and you don’t know the estimated amount of reads/writes, otherwise you might get surprised with the bill. <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> scales like charm, maybe your budget doesn’t.</p>\n</li>\n<li>\n<p>Bundle size is critical for your web application. Remember that bundle size is not that critical if you are implementing a <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a>, because your app files are cached.</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_do_not_go_blindly_for_the_best_charting_library\">Do not go blindly for the best charting library</h3>\n<div class=\"paragraph\">\n<p>First of all, check what kind of charts you need. In many applications you are OK with XY axis chart, time series, bars or pie charts. You can easily get an smaller bundle size by just using a simple charting library like <a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a> or <a href=\"https://gionkunz.github.io/chartist-js\">Chartist</a></p>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Tip</div>\n</td>\n<td class=\"content\">\nJust check what are your requirements, if you are not sure about them, <a href=\"#_chosen_technology_stack_for_budget_tracker\">Chosen Technology Stack for <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a></a> consists of awesome products which most likely will fit your use case.\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_what_next\">What next?</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>My next technology stack bet goes for <a href=\"https://svelte.dev\" target=\"_blank\" rel=\"noopener\">Svelte</a>/https://sapper.svelte.dev[Sapper,window=_blank], it is promising project, the results for small projects are really impressive, mainly in regards to bundle size, it is ridiculously small and development experience is quick and intuitive.</p>\n</div>\n<div class=\"paragraph\">\n<p>I’ve created a tiny <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> to estimate <a href=\"https://currency-loss.netlify.com\">currency exchange loss</a> when you go to a money changer shop: <a href=\"https://currency-loss.netlify.com\">currency-loss.netlify.com</a>. Note, I got that app up and running in few hours, thanks to <a href=\"https://svelte.dev\" target=\"_blank\" rel=\"noopener\">Svelte</a>.</p>\n</div>\n</div>\n</div>","slug":"pwa-lessons-learned-cra"},{"sectids":"","toc-placement":"auto","notitle":"","stylesheet":"","webfonts":"","prewrap":"","attribute-undefined":"drop-line","attribute-missing":"skip","iconfont-remote":"","caution-caption":"Caution","important-caption":"Important","note-caption":"Note","tip-caption":"Tip","warning-caption":"Warning","example-caption":"Example","figure-caption":"Figure","table-caption":"Table","toc-title":"Table of Contents","section-refsig":"Section","part-refsig":"Part","chapter-refsig":"Chapter","appendix-refsig":"Appendix","appendix-caption":"Appendix","untitled-label":"Untitled","version-label":"Version","last-update-label":"Last updated","docfile":"pwa-lessons-learned-cra.es.adoc","docdir":"","docfilesuffix":".adoc","docname":"pwa-lessons-learned-cra.es","embedded":"","asciidoctor":"","asciidoctor-version":"2.0.10","safe-mode-name":"secure","safe-mode-secure":"","safe-mode-level":20,"max-include-depth":64,"user-home":".","backend":"html5","max-attribute-value-size":4096,"linkcss":"","doctype":"article","htmlsyntax":"html","backend-html5-doctype-article":"","doctype-article":"","backend-html5":"","outfilesuffix":".html","filetype":"html","filetype-html":"","basebackend-html-doctype-article":"","basebackend-html":"","basebackend":"html","stylesdir":".","iconsdir":"./images/icons","localdate":"2020-04-26","localyear":"2020","localtime":"18:11:34 +0200","localdatetime":"2020-04-26 18:11:34 +0200","docdate":"2020-04-19","docyear":"2020","doctime":"10:46:31 +0200","docdatetime":"2020-04-19 10:46:31 +0200","doctitle":"Lecciones aprendidas creando una PWA con Create React App","date":"2019/11/04","lang":"es","keywords":["React","Typescript","CRA","PWA","Create React App","Firebase","Firestore","Svelte","Sapper"],"link":"https://btapp.netlify.com","description":"Lecciones aprendidas durante la creacion de una PWA: Budget Tracker","toc":"","react":"https://reactjs.org[React,window=_blank]","webpack":"https://webpack.js.org[Webpack,window=_blank]","parcel":"https://parceljs.org[Parcel,window=_blank]","cra":"https://create-react-app.dev[CRA,window=_blank]","cralong":"https://create-react-app.dev[Create React App,window=_blank]","pwa":"https://developers.google.com/web/progressive-web-apps/[PWA,window=_blank]","typescript":"https://www.typescriptlang.org[Typescript,window=_blank]","material-ui":"https://material-ui.com[Material UI,window=_blank]","frappe":"https://frappe.io/charts[Frappe charts,window=_blank]","btapp":"https://btapp.netlify.com[Budget Tracker,window=_blank]","sw":"https://developers.google.com/web/fundamentals/primers/service-workers[Service Worker,window=_blank]","firestore":"https://firebase.google.com/docs/firestore[Firestore,window=_blank]","firebase-auth":"https://firebase.google.com/docs/auth[Firebase Authentication,window=_blank]","ww":"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers[Web Workers,window=_blank]","indexeddb":"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API[IndexedDB,window=_blank]","firebase":"https://firebase.google.com/[Firebase,window=_blank]","authorcount":0,"title":"Lecciones aprendidas creando una PWA con Create React App","summary":"Lecciones aprendidas durante la creacion de una PWA: Budget Tracker","html":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">Table of Contents</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_tecnologías_escogidas_para_crear_budget_tracker\">Tecnologías escogidas para crear Budget Tracker</a></li>\n<li><a href=\"#_create_react_application_cra\">Create React Application: CRA</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_service_worker\">Service worker</a></li>\n<li><a href=\"#_web_worker\">Web worker</a></li>\n<li><a href=\"#_webpack\">Webpack</a></li>\n</ul>\n</li>\n<li><a href=\"#_firebase\">Firebase</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_inconvenientes\">Inconvenientes</a></li>\n<li><a href=\"#_alternativas_a_firebase\">Alternativas a Firebase</a></li>\n</ul>\n</li>\n<li><a href=\"#_librería_de_componentes_de_interfaz_de_usuario_material_ui\">Librería de componentes de interfaz de usuario: Material UI</a></li>\n<li><a href=\"#_librerías_de_gráficas\">Librerías de gráficas</a></li>\n<li><a href=\"#_conclusión\">Conclusión</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_no_utilices_cra_si\">No utilices CRA si</a></li>\n<li><a href=\"#_no_utilices_firestore_si\">No utilices Firestore si</a></li>\n<li><a href=\"#_no_elijas_la_mejor_librería_de_gráficos\">No elijas la mejor librería de gráficos</a></li>\n</ul>\n</li>\n<li><a href=\"#_y_ahora_qué\">¿Y ahora qué?</a></li>\n</ul>\n</div>\n<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Empezé trabajando con <a href=\"https://reactjs.org\" target=\"_blank\" rel=\"noopener\">React</a> hace unos años, siempre he comenzado los proyectos desde cero, sin utilizar ninguna plantilla o generador de proyectos. En lo que ser refiere a los empaquetadores, normalmente utilizo <a href=\"https://webpack.js.org\" target=\"_blank\" rel=\"noopener\">Webpack</a> en el trabajo o <a href=\"https://parceljs.org\">Parcel</a> en proyectos personales.</p>\n</div>\n<div class=\"paragraph\">\n<p>Hace unos meses, quería comenzar un proyecto personal para hacer un seguimiento de mis gastos durante mi año sabático, <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> lo llamé. Llevaba un poco de prisa, porque en ese momento llevaba ya unos 4 meses viajando y quería centrarme cuanto antes en implementar la funcionalidad principal y tener algo funcionando cuanto antes, un <a href=\"https://en.wikipedia.org/wiki/Minimum_viable_product\">MVP</a> (minimum viable product), estaba en la situación perfecta para probar <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">Create React App</a> o <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Note</div>\n</td>\n<td class=\"content\">\n<a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a> te permite crear una <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> en <a href=\"https://reactjs.org\" target=\"_blank\" rel=\"noopener\">React</a> lista para producción en un momento, lo que es impresionante. Solo tienes el esqueleto de la aplicación, tampoco hace milagros, el resto lo tienes que programar tú. <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a> se encarga de la gestión de dependencias de desarrollo y configuración de el empaquetador, <a href=\"https://webpack.js.org\" target=\"_blank\" rel=\"noopener\">Webpack</a> en este caso.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Como decía antes, quería implementar la lógica del programa cuanto antes, así que junto con la utilización de <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>, tambien tomé otras decisiones y atajos, condicionados por la necesidad de acelerar el proceso de desarrollo, hablaré sobre todas estas decisiones a lo largo de este artículo.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_tecnologías_escogidas_para_crear_budget_tracker\">Tecnologías escogidas para crear <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a></h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a></p>\n</li>\n<li>\n<p><a href=\"https://reactjs.org\" target=\"_blank\" rel=\"noopener\">React</a></p>\n</li>\n<li>\n<p><a href=\"https://www.typescriptlang.org\" target=\"_blank\" rel=\"noopener\">Typescript</a></p>\n</li>\n<li>\n<p><a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a></p>\n</li>\n<li>\n<p><span class=\"line-through\"><a href=\"https://formidable.com/open-source/victory\">Victory</a></span> <a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a></p>\n</li>\n<li>\n<p><a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a></p>\n</li>\n<li>\n<p><a href=\"https://firebase.google.com/docs/auth\" target=\"_blank\" rel=\"noopener\">Firebase Authentication</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Estoy bastante contento con el resultado, pero teniendo en cuenta lo aprendido durante el desarrollo de este proyecto, <strong>en el futuro y con el tiempo suficiente, lo más seguro es que no volviese a elegir este mismo conjunto</strong>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Puedes evaluar el resultado de usar este conjunto de tecnologías abriendo <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>A continuación, haré un análisis más detallado de algunos de los beneficios e inconvenientes de las decisiones y atajos que tomé durante el desarrollo de <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a>.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_create_react_application_cra\">Create React Application: <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a></h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">Create React App</a> no ofrece soporte para <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a> ni permite modificar la implementación del <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers\" target=\"_blank\" rel=\"noopener\">Service Worker</a> sin <a href=\"https://stackoverflow.com/questions/49737652/what-does-eject-do-in-create-react-app\">expulsar (eject)</a> la configuración.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Note</div>\n</td>\n<td class=\"content\">\n¿Qué significa explusar o &#8220;eject&#8221; en <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>? Básicamente es que la configuración de tu proyecto ya no está gestionada por <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>, por lo que tienes que te tienes que hacer cargo de ella, mantener las dependencias y configuración de todos los aspectos de tu proyecto como las pruebas, el análisis estático de código, la configuración de Babel y la lista continúa.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_service_worker\">Service worker</h3>\n<div class=\"paragraph\">\n<p>Es posible que necesites modificar el comportamiento de tu <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers\" target=\"_blank\" rel=\"noopener\">Service Worker</a> para enviar/recibir <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Client/postMessage\">mensajes post</a>, para realizar <a href=\"https://wicg.github.io/BackgroundSync/spec/\">sincronización en segundo plano</a> o <a href=\"https://developer.mozilla.org/en/docs/Web/API/notification\">mostrar notificaciones web</a>. En ese caso tendrá que <a href=\"https://stackoverflow.com/questions/49737652/what-does-eject-do-in-create-react-app\">extraer tu proyecto (eject)</a> y mantener la configuración por tí misma/mismo, lo cual puede suponer algún que otro dolor de cabeza innecesario.</p>\n</div>\n<div class=\"paragraph\">\n<p>Hay <a href=\"https://www.freecodecamp.org/news/how-to-customize-service-workers-with-create-react-app-4424dda6210c/\">otras opciones para evitar extraer CRA</a>, pero son un poco complicadas para mi gusto.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_web_worker\">Web worker</h3>\n<div class=\"paragraph\">\n<p>Cuando necesitas ejecutar algún procesamiento sin bloquear el hilo principal, puedes enviarlo a un <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a>, lo malo es que tampoco están soportados por <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>. El <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a> también puebe comunicarse con el hilo principal usando <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Client/postMessage\">mensajes post</a> y también puede mostrar <a href=\"https://medium.com/young-coder/a-simple-introduction-to-web-workers-in-javascript-b3504f9d9d1c\">notificaciones web</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>También hay <a href=\"https://medium.com/@danilog1905/how-to-use-web-workers-with-react-create-app-and-not-ejecting-in-the-attempt-3718d2a1166b\">otras opciones para evitar extraer la configuración de CRA</a>, pero requieren un poco de trabajo extra.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_webpack\">Webpack</h3>\n<div class=\"paragraph\">\n<p><a href=\"https://webpack.js.org\" target=\"_blank\" rel=\"noopener\">Webpack</a> es el empaquetador utilizado por <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>. Cuando utilizas <a href=\"https://create-react-app.dev\" target=\"_blank\" rel=\"noopener\">CRA</a>, no necesitas saber mucho sobre éste, pero cuando tienes que <a href=\"https://stackoverflow.com/questions/49737652/what-does-eject-do-in-create-react-app\">extraer tu proyecto (eject)</a>, entonces tendrás que lidiar con el <a href=\"https://webpack.js.org/configuration/\">archivo de configuracion de Webpack</a>.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_firebase\">Firebase</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> permite sincronizar tus presupuestos entre distintos dispositivos, por lo que esta aplicación necesita un lado <a href=\"https://en.wikipedia.org/wiki/Front_and_back_ends\">backend</a> para gestionar la autenticación y guardar/leer los datos. Consideré dos opciones: <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> implementar una API <a href=\"https://en.wikipedia.org/wiki/Representational_state_transfer\">REST</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Elegí <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> porque no hay que implementar nada en el lado servidor, sólo hay que configurar los <a href=\"https://support.google.com/firebase/answer/6400716?hl=en\">métodos de autenticación</a> y las <a href=\"https://firebase.google.com/docs/firestore/security/get-started\">reglas de seguridad</a> en <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Pero <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> viene con algunos inconvenientes que debes conocer antes de elegirlo.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_inconvenientes\">Inconvenientes</h3>\n<div class=\"sect3\">\n<h4 id=\"_tamaño_de_la_librería\">Tamaño de la librería</h4>\n<div class=\"paragraph\">\n<p>Me sorprendió mucho la primera vez que analicé el tamaño de la aplicación <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> justo después de integrarla con <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a>, <strong>¡creció un 39%!</strong>.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>27% por la librería <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>.</p>\n</li>\n<li>\n<p>12% por la librería <a href=\"https://firebase.google.com/docs/auth\" target=\"_blank\" rel=\"noopener\">Firebase Authentication</a>.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Afortunadamente <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> está implementado particionando el código (<a href=\"https://reactjs.org/docs/code-splitting.html\">code-splitting</a>), lo que permite cargar solo las partes necesarias de la aplicación, así que, la experiencia de usuario no se vió gravemente afectada. Lo malo es que el usuario, en algún momento, tendrá que descargar ese <strong>39% extra</strong> (<strong>539KB</strong>).</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_no_realmente_primero_offline\">No realmente primero offline</h4>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Important</div>\n</td>\n<td class=\"content\">\nEsto no es relevante, si para tu caso de uso no tienes que vincular los datos al usuario.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> necesita un usuario identificado para realizar lecturas y escrituras, pero <a href=\"https://firebase.google.com/docs/auth/web/anonymous-auth\">permite trabajar con usuarios anónimos</a>, esta característica es muy interesante si no quieres forzar al usuario a identificarse para utilizar la aplicación.</p>\n</div>\n<div class=\"paragraph\">\n<p>Otra característica muy útil es que <a href=\"https://firebase.google.com/docs/firestore/manage-data/enable-offline\">soporta modo offline</a>, lo que permite guardar y leer información cuando no hay conexión a Internet.</p>\n</div>\n<div class=\"paragraph\">\n<p>Los usuarios anónimos junto con el modo offline, casi permiten tener una aplicación que funcione completamente offline.</p>\n</div>\n<div class=\"paragraph\">\n<p>Entonces… ¿Qué es esto de <a href=\"#_no_realmente_primero_offline\">No realmente primero offline</a>? Esto significa, que la primera vez que la aplicación es abierta, <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> necesita identificar al usuario, para ello, en este momento, el dispositivo del usuario debe estar conectado a Internet, en este caso, <strong>debes considerar el siguiente escenario</strong>:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>La <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> está instalada en tu dispositivo.</p>\n</li>\n<li>\n<p>El usuario no está identificado.</p>\n</li>\n<li>\n<p>El dipositivo no tiene acceso a Internet.</p>\n</li>\n<li>\n<p>El usuario abre la <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> e intenta guardar o leer datos.</p>\n</li>\n<li>\n<p><strong>La información no se podrá guardar correctamente</strong>, porque se desconoce el usuario al que pertenece esta información y tampoco se puede vincular a un usuario anónimo, porque se necesita conexión para crearlo.</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>Esto no es un problema importane, la aplicación funcionará perfectamente en la mayoría de casos. Si, aún así quieres resolver este caso, a continuación explicaré cómo lo he solucionado en <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a>.</p>\n</div>\n<div class=\"sect4\">\n<h5 id=\"_convertir_budget_tracker_como_offline_first\">Convertir Budget Tracker como offline first</h5>\n<div class=\"paragraph\">\n<p>Antes de nada, me gustaría remarcar que esto <strong>podría no ser necesario para tu caso de uso</strong>, porque sólo ocurrirá la primera vez que arranque la aplicación y no tenga conexión a Internet. En el caso de <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> me aseguré de que funcionase en todo momento en modo offline porque traía otros beneficios que más adelante enumeraré.</p>\n</div>\n<div class=\"sect5\">\n<h6 id=\"_detalles_de_implementación\">Detalles de implementación</h6>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Crear dos capas de persistencia: Local (<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\" target=\"_blank\" rel=\"noopener\">IndexedDB</a>) y Remota (<a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>).</p>\n</li>\n<li>\n<p>Guardar los datos siempre de forma local, independientemente de si el usuario está identificado o no.</p>\n</li>\n<li>\n<p>Si hay un usuario que ya está identificado, después de actuar sobre el almacenamiento local, realizar exactamente la misma acción sobre la capa de almacenamiento remoto <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> de forma asíncrona.</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect5\">\n<h6 id=\"_beneficios\">Beneficios</h6>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Si el usuario no se ha identificado, <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a> no cargará la librería cliente de <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>. Como ya comenté antes, ésta supone un 27% del tamaño de la aplicación.</p>\n</li>\n<li>\n<p>Las escrituras y lecturas son algo más rápidas, porque el almacenamiento primario es local.</p>\n</li>\n<li>\n<p><strong>Aclaración</strong>: La interación con <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> también es rápida, porque también almacena la información localmente, pero también hace unas cuantas cosas más que simplemente interactuar con <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\" target=\"_blank\" rel=\"noopener\">IndexedDB</a> y necesitas un usuario identificado.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Puedes encontrar un <a href=\"https://github.com/carlosvin/budget-tracker/blob/master/doc/preformance.md#desktop-slow-clear-storage-0-budgets-1\">informe más detallado sobre el rendimiento</a>, donde se analizan tres escenarios diferentes:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p><a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> como única capa de persistencia.</p>\n</li>\n<li>\n<p>Dos capas de persistencia, una local (<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\" target=\"_blank\" rel=\"noopener\">IndexedDB</a>) y otra remota (<a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a>),</p>\n</li>\n<li>\n<p>Igual que la anterior, pero se interactúa con <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> desde un service worker.</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>En general, se obtienen mejores resultados con la opción 2.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_modelo_de_datos\">Modelo de Datos</h4>\n<div class=\"paragraph\">\n<p>La API de <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> es fácil e intuitiva, me encanta, pero no asumas que tendrá todas las características que ofrecen otras bases de datos documentales o relacionales (SQL).</p>\n</div>\n<div class=\"paragraph\">\n<p>Comprueba que las <a href=\"https://googleapis.github.io/google-cloud-dotnet/docs/Google.Cloud.Firestore/datamodel.html\">limitaciones de Firestore</a> encajan con tu modelo de datos, o si no es demasiado tarde, diseña tu modelo de datos siguiendo la guía de <a href=\"https://cloud.google.com/firestore/docs/best-practices\">buenas prácticas de Firestore</a>.</p>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_alternativas_a_firebase\">Alternativas a Firebase</h3>\n<div class=\"paragraph\">\n<p>A parte de implementar una API <a href=\"https://en.wikipedia.org/wiki/Representational_state_transfer\">REST</a> para tu aplicación, hay otros servicios similares a <a href=\"https://firebase.google.com/\" target=\"_blank\" rel=\"noopener\">Firebase</a> con un tamaño menor de la librería cliente y otras características que pueden adaptarse mejor a tus necesidades.</p>\n</div>\n<div class=\"paragraph\">\n<p>Algunas alternativas a considerar:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Basado en <a href=\"http://couchdb.apache.org/\">Apache CouchDB</a>: <a href=\"https://pouchdb.com\">PouchDB</a>, <a href=\"https://en.wikipedia.org/wiki/Cloudant\">Cloudant</a>.</p>\n</li>\n<li>\n<p>Basado en <a href=\"https://parseplatform.org/\">Parse server</a>: <a href=\"https://www.back4app.com\">back4apps</a>.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_librería_de_componentes_de_interfaz_de_usuario_material_ui\">Librería de componentes de interfaz de usuario: <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a></h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Elegí <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a>.</p>\n</div>\n<div class=\"quoteblock\">\n<blockquote>\nComponentes de React para un desarrollo web más rápido y sencillo. Construya su propio sistema de diseño, o empiece con Material Design.\n</blockquote>\n<div class=\"attribution\">\n&#8212; https://material-ui.com[Material UI\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Hay dos razones principales por las que elegí una libreria de componentes UI:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Es laborioso crear tus propios componentes de interfaz de usuario que sean accesibles, que se adapten correctamente a distintos dispositivos y con un diseño estéticamente correcto.</p>\n</li>\n<li>\n<p><a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a> tiene un conjunto de iconos SVG, <a href=\"https://material-ui.com/components/material-icons/\">Material Icons</a>. Esto me venía muy bien para <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a>, porque permite crear categorías para gastos y asignar un icono a éstas categorías.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Hay algunos <strong>problemas</strong>, no muy importantes en mi opinión, quizá el que me resulta más molesto es el primero:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://jestjs.io/docs/en/snapshot-testing\">Jest Snapshots</a> + <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a>: Los <a href=\"https://jestjs.io/docs/en/snapshot-testing\">Jest Snapshots</a> guardan también las classes CSS utilizadas por <a href=\"https://material-ui.com\" target=\"_blank\" rel=\"noopener\">Material UI</a>, pero el orden de estas clases podría no ser determinístico, por lo que el resultado de una prueba podría ser satisfactorio en tu portátil, pero podría fallar en cualquier otro sitio, como en la máquina donde se ejecuta el servidor de integración continua (<a href=\"https://en.wikipedia.org/wiki/Continuous_integration\">CI</a>). Están trabajando en solucionar <a href=\"https://github.com/mui-org/material-ui/issues/14357\">este problema, más información en Github</a>.</p>\n</li>\n<li>\n<p>Rendimiento: Hay algunos <a href=\"https://github.com/mui-org/material-ui/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+is%3Aopen+performance\">problemas de rendimiento en Github</a>. A lo largo de los últimos meses, mientras he utilizado esta librería, puedo decir que el equipo de desarrollo está trabajando duro en mejorar esta librería y supongo que los solucionarán pronto.</p>\n</li>\n<li>\n<p>Las librerías de componentes de interfaz de usuario son complejas y hacen muchas cosas, por ello la mayoría son bastante pesadas. <a href=\"https://bundlephobia.com/result?p=@material-ui/core@4.5.2\">El tamaño de Material UI reducido son 304.2kB</a>. Puedes encontrar <a href=\"https://material-ui.com/guides/minimizing-bundle-size\">recomendaciones para reducir el tamaño de tu aplicación al utilizar Material UI en su documentación</a>.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_librerías_de_gráficas\">Librerías de gráficas</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Muchas de las librerías que he encontrado son muy potentes y completas, pero también ocupan bastante, entre otras cosas porque dependen en otras librerías como <a href=\"https://d3js.org/\">D3</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Inicialmente elegí <a href=\"https://formidable.com/open-source/victory\">Victory</a>, pero me dí cuenta de que sólamente necesitaba gráficos para mostrar porcentajes y series temporales. Otro hecho relevante es que <a href=\"https://formidable.com/open-source/victory\">Victory</a> tiene un <a href=\"https://bundlephobia.com/result?p=victory@33.1.2\">tamaño de 468KB</a> y yo no estaba utilizando la mayor parte de ese código.</p>\n</div>\n<div class=\"paragraph\">\n<p>Después de una búsqueda rápida en Internet, encontré otras alternativas mucho más ligeras y más que suficientes para mis necesidades:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a>: <a href=\"https://bundlephobia.com/result?p=frappe-charts@1.3.0\">63KB</a>.</p>\n</li>\n<li>\n<p><a href=\"https://gionkunz.github.io/chartist-js\">Chartist</a>: <a href=\"https://bundlephobia.com/result?p=chartist@0.11.4\">39KB</a>.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Probé las dos y me encantaron las dos, finalmente elegí <a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a> porque su esquema de colores se ajusta mejor al tema de <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Ambas librerías traen más tipos de gráficos que los de ejes de coordenadas XY o gráfico de barras. Echa un vistazo a sus sitios web si quieres saber un poco más.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_conclusión\">Conclusión</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Intentaré llegar a una conclusión algo mejor que <em>\"Depende\"</em>, <em>\"Tu caso de uso te dirá\"</em>, etc. Dicho esto, depende de lo que necesites :p.</p>\n</div>\n<div class=\"paragraph\">\n<p>Ya en serio, voy a listar las conclusiones en la forma <em>\"No utilices … si …\"</em>.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_no_utilices_cra_si\">No utilices CRA si</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Si tienes que modificar el <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers\" target=\"_blank\" rel=\"noopener\">Service Worker</a> para realizar <a href=\"https://developers.google.com/web/updates/2015/12/background-sync\">Background sync</a> o para <a href=\"https://developer.mozilla.org/en/docs/Web/API/notification\">mostrar notificaciones web</a>.</p>\n</li>\n<li>\n<p>Si tienes que utilizar <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" target=\"_blank\" rel=\"noopener\">Web Workers</a>.</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_no_utilices_firestore_si\">No utilices Firestore si</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Si esperas que tu aplicación sea utilizada por muchos usuarios y no tienes idea de la cantidad de lecturas y escrituras que necesitas por usuario, te podrías llevar un sorpresa en la factura que te pase Google. <a href=\"https://firebase.google.com/docs/firestore\" target=\"_blank\" rel=\"noopener\">Firestore</a> escala perfectamente, pero tu presupuesto quizá no.</p>\n</li>\n<li>\n<p>Si el tamaño de tu aplicación web es algo crítico. Recuerda que el tamaño de tu aplicación, si se trata de una <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a>, no es tan importante, porque los archivos normalmente estará cacheados para que la aplicación pueda abrirse offline.</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_no_elijas_la_mejor_librería_de_gráficos\">No elijas la mejor librería de gráficos</h3>\n<div class=\"paragraph\">\n<p>Antes de nada, analiza qué tipos de gráficos necesitas. En muchos casos, es más que suficiente con gráficos XY, de tarta o de barras. Puedes fácilmente reducir el tamaño de tu aplicación utilizando librerías como <a href=\"https://frappe.io/charts\" target=\"_blank\" rel=\"noopener\">Frappe charts</a> or <a href=\"https://gionkunz.github.io/chartist-js\">Chartist</a></p>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Tip</div>\n</td>\n<td class=\"content\">\nSimplemente asegúrate de que tus requisitos son compatibles con las limitaciones o problemas de los que acabo de hablar. Si no estás segura o seguro, las <a href=\"#_tecnologías_escogidas_para_crear_budget_tracker\">Tecnologías escogidas para crear <a href=\"https://btapp.netlify.com\" target=\"_blank\" rel=\"noopener\">Budget Tracker</a></a> debería ser suficiente para cualquier <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a>.\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_y_ahora_qué\">¿Y ahora qué?</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Mi próxima apuesta para el lado <a href=\"https://en.wikipedia.org/wiki/Front_and_back_ends\">frontend</a> es {Svelte}/{Sapper}. Es un proyecto prometedor que ha cambiado el paradigma de framework en tiempo de ejecución a framework en tiempo de compilación. Hasta ahora, los resultados en proyectos pequeños son impresionantes, sobre todo en lo relacionado con el tamaño de la aplicación generada y con lo fácil e intuitivo que resulta el desarrollo con {Svelte}.</p>\n</div>\n<div class=\"paragraph\">\n<p>He creado una sencilla <a href=\"https://developers.google.com/web/progressive-web-apps/\" target=\"_blank\" rel=\"noopener\">PWA</a> para <a href=\"https://currency-loss.netlify.com\">calcular el dinero que pierdes</a> cuando vas a una casa de cambio: <a href=\"https://currency-loss.netlify.com\">currency-loss.netlify.com</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Terminé esta aplicación en pocas horas gracias a {Svelte}.</p>\n</div>\n</div>\n</div>","slug":"pwa-lessons-learned-cra"},{"sectids":"","toc-placement":"auto","notitle":"","stylesheet":"","webfonts":"","prewrap":"","attribute-undefined":"drop-line","attribute-missing":"skip","iconfont-remote":"","caution-caption":"Caution","important-caption":"Important","note-caption":"Note","tip-caption":"Tip","warning-caption":"Warning","example-caption":"Example","figure-caption":"Figure","table-caption":"Table","toc-title":"Table of Contents","section-refsig":"Section","part-refsig":"Part","chapter-refsig":"Chapter","appendix-refsig":"Appendix","appendix-caption":"Appendix","untitled-label":"Untitled","version-label":"Version","last-update-label":"Last updated","docfile":"this-is-sapper.adoc","docdir":"","docfilesuffix":".adoc","docname":"this-is-sapper","embedded":"","asciidoctor":"","asciidoctor-version":"2.0.10","safe-mode-name":"secure","safe-mode-secure":"","safe-mode-level":20,"max-include-depth":64,"user-home":".","backend":"html5","max-attribute-value-size":4096,"linkcss":"","doctype":"article","htmlsyntax":"html","backend-html5-doctype-article":"","doctype-article":"","backend-html5":"","outfilesuffix":".html","filetype":"html","filetype-html":"","basebackend-html-doctype-article":"","basebackend-html":"","basebackend":"html","stylesdir":".","iconsdir":"./images/icons","localdate":"2020-04-26","localyear":"2020","localtime":"18:11:36 +0200","localdatetime":"2020-04-26 18:11:36 +0200","docdate":"2020-04-19","docyear":"2020","doctime":"20:46:56 +0200","docdatetime":"2020-04-19 20:46:56 +0200","doctitle":"This is Sapper!","date":"2020-04-19","lang":"en","description":"This blog has been migrated from Nikola to Sapper. Following the reasons why, some thoughts and performance results","toc":"","keywords":["Sapper","Svelte","JAMStack"],"nikola":"https://getnikola.com[Nikola,window='_blank']","rst":"https://en.wikipedia.org/wiki/ReStructuredText[reStructuredText,window='_blank']","md":"https://en.wikipedia.org/wiki/Markdown[Markdown,window='_blank']","asciidoc":"https://asciidoctor.org/[Asciidoctor,window='_blank']","python":"https://python.org[Python,window='_blank']","lighthouse":"https://developers.google.com/web/tools/lighthouse[Lighthouse audits,window='_blank']","js":"https://en.wikipedia.org/wiki/JavaScript[JavaScript,window='_blank']","html":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">Table of Contents</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_why_leaving_nikola\">Why leaving Nikola</a></li>\n<li><a href=\"#_why_sapper\">Why Sapper</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_dx_developer_experience\">DX: Developer experience</a></li>\n<li><a href=\"#_ux_final_result_of_blogs_in_sapper\">UX: Final result of blogs in Sapper</a></li>\n</ul>\n</li>\n<li><a href=\"#_asciidoctor\">Asciidoctor</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_rollup_plugin_asciidoc_to_the_rescue\">rollup-plugin-asciidoc to the rescue</a></li>\n<li><a href=\"#_rollup_plugin_glob_to_the_rescue\">rollup-plugin-glob to the rescue</a></li>\n</ul>\n</li>\n<li><a href=\"#_syntax_highlighting\">Syntax highlighting</a></li>\n<li><a href=\"#_result\">Result</a></li>\n</ul>\n</div>\n<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>I&#8217;ve migrated my blog infrastructure from <a href=\"https://getnikola.com\" target=\"_blank\" rel=\"noopener\">Nikola</a> + <a href=\"https://en.wikipedia.org/wiki/ReStructuredText\" target=\"_blank\" rel=\"noopener\">reStructuredText</a> to <a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a> + <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a>.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_why_leaving_nikola\">Why leaving <a href=\"https://getnikola.com\" target=\"_blank\" rel=\"noopener\">Nikola</a></h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>This blog was powered by <a href=\"https://getnikola.com\" target=\"_blank\" rel=\"noopener\">Nikola</a> since 2014, when <a href=\"https://jamstack.org\" target=\"_blank\" rel=\"noopener\">JAMStack</a> term didn&#8217;t even exist. It really did the job, it has out-of-the-box features that I needed:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Simple multi-lang support.</p>\n</li>\n<li>\n<p><a href=\"https://en.wikipedia.org/wiki/ReStructuredText\" target=\"_blank\" rel=\"noopener\">reStructuredText</a> which I prefer over <a href=\"https://en.wikipedia.org/wiki/Markdown\" target=\"_blank\" rel=\"noopener\">Markdown</a>.</p>\n</li>\n<li>\n<p>It was developed in <a href=\"https://python.org\" target=\"_blank\" rel=\"noopener\">Python</a>, a programming language that I know and I enjoy.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>I faced some <strong>issues</strong> which annoyed me for quite some time:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>My config file got bloated.</p>\n</li>\n<li>\n<p>It was not easy to modify or create templates, neither to find templates I liked.</p>\n</li>\n<li>\n<p>Site performance was not awesome, my last <a href=\"https://developers.google.com/web/tools/lighthouse\" target=\"_blank\" rel=\"noopener\">Lighthouse audits</a> were around 80, depending on the section. Except SEO section, which was 96.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_why_sapper\">Why Sapper</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_dx_developer_experience\">DX: Developer experience</h3>\n<div class=\"paragraph\">\n<p>I already used <a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a> for creating some tiny <a href=\"https://web.dev/progressive-web-apps\" target=\"_blank\" rel=\"noopener\">PWA</a>s <sup class=\"footnote\">[<a id=\"_footnoteref_1\" class=\"footnote\" href=\"#_footnotedef_1\" title=\"View footnote.\">1</a>]</sup>, here 2 examples I developed to learn <a href=\"https://svelte.dev\" target=\"_blank\" rel=\"noopener\">Svelte</a> and <a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a>:</p>\n</div>\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\"><a href=\"https://currency-loss.netlify.app\" target=\"_blank\" rel=\"noopener\">Currency Exchage Loss Calculator</a></dt>\n<dd>\n<p>It is a helpful application for travellers visiting currency exchange houses. Based on the rate they offer and the money you want ot change it calculates the amount of money that you are losing in that transaction.</p>\n</dd>\n<dt class=\"hdlist1\"><a href=\"https://covid-stats-pwa.netlify.app\" target=\"_blank\" rel=\"noopener\">COVID-19 Stats</a></dt>\n<dd>\n<p>It shows COVID-19 statistics by country and date.</p>\n</dd>\n</dl>\n</div>\n<div class=\"paragraph\">\n<p>While creating those <a href=\"https://web.dev/progressive-web-apps\" target=\"_blank\" rel=\"noopener\">PWA</a>s, developing experience with <a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a>/https://svelte.dev[Svelte,window='_blank'] was quite impressive.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_ux_final_result_of_blogs_in_sapper\">UX: Final result of blogs in Sapper</h3>\n<div class=\"paragraph\">\n<p>Lately I&#8217;ve stumbled upon with some blogs using <a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a> like the own <a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a> blog, <a href=\"https://www.codingwithjesse.com/blog/statically-generating-a-blog-with-svelte-sapper/\" target=\"_blank\" rel=\"noopener\">Coding with Jessie</a> or <a href=\"https://www.swyx.io/writing/svelte-static/\" target=\"_blank\" rel=\"noopener\">swyx.io</a>. Check those blogs by yourself, IMHO user experience is pretty good in all of them.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Note</div>\n</td>\n<td class=\"content\">\n<a href=\"https://sapper.svelte.dev/\" target=\"_blank\" rel=\"noopener\">Sapper</a> is inspired in <a href=\"https://nextjs.org/\">Next.js</a>, here you can find <a href=\"https://sapper.svelte.dev/docs#Comparison_with_Next_js\">a comparison with this better known JAMStack framework</a>.\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_asciidoctor\"><a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a></h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>I don&#8217;t have a strong opinion about using <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> or <a href=\"https://en.wikipedia.org/wiki/ReStructuredText\" target=\"_blank\" rel=\"noopener\">reStructuredText</a>, I am comfortable with both of them, but there is more support for <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> in other programming languages, like <a href=\"https://en.wikipedia.org/wiki/JavaScript\" target=\"_blank\" rel=\"noopener\">JavaScript</a>. So basically I switched to <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> because I didn&#8217;t find a <a href=\"https://en.wikipedia.org/wiki/JavaScript\" target=\"_blank\" rel=\"noopener\">JavaScript</a> library able to properly convert <a href=\"https://en.wikipedia.org/wiki/ReStructuredText\" target=\"_blank\" rel=\"noopener\">reStructuredText</a> to <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML\" target=\"_blank\" rel=\"noopener\">HTML</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>The main issue I found not using <a href=\"https://en.wikipedia.org/wiki/Markdown\" target=\"_blank\" rel=\"noopener\">Markdown</a> was the lack of <a href=\"https://rollupjs.org\" target=\"_blank\" rel=\"noopener\">Rollup</a> plugins to convert <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> to <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML\" target=\"_blank\" rel=\"noopener\">HTML</a>, so I just created one, <a href=\"https://github.com/carlosvin/rollup-plugin-asciidoc\" target=\"_blank\" rel=\"noopener\">rollup-plugin-asciidoc</a>. Implementation was quite simple, the plugin is just using <a href=\"https://asciidoctor.org/docs/asciidoctor.js/\" target=\"_blank\" rel=\"noopener\">Asciidoctor.js</a> <a href=\"https://en.wikipedia.org/wiki/JavaScript\" target=\"_blank\" rel=\"noopener\">JavaScript</a> library to convert the text input to html.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_rollup_plugin_asciidoc_to_the_rescue\"><a href=\"https://github.com/carlosvin/rollup-plugin-asciidoc\" target=\"_blank\" rel=\"noopener\">rollup-plugin-asciidoc</a> to the rescue</h3>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Tip</div>\n</td>\n<td class=\"content\">\nWith <a href=\"https://github.com/carlosvin/rollup-plugin-asciidoc\" target=\"_blank\" rel=\"noopener\">rollup-plugin-asciidoc</a> we can import <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> files in our blog and <a href=\"https://rollupjs.org\" target=\"_blank\" rel=\"noopener\">Rollup</a> will convert them to <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML\" target=\"_blank\" rel=\"noopener\">HTML</a>.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_example\">Example</h4>\n<div class=\"listingblock\">\n<div class=\"title\">a-blog-post.adoc</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-adoc\" data-lang=\"adoc\"><span class=\"hljs-section\">= Post title</span>\n<span class=\"hljs-meta\">:date:</span> 2019-11-11\n\nSuch a post!</code></pre>\n</div>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">With <a href=\"https://github.com/carlosvin/rollup-plugin-asciidoc\" target=\"_blank\" rel=\"noopener\">rollup-plugin-asciidoc</a> we can import <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> files one by one.</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-javascript\" data-lang=\"javascript\"><span class=\"hljs-keyword\">import</span> doc <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'./a-blog-post.adoc'</span>;\n\n<span class=\"hljs-built_in\">console</span>.log(doc);</code></pre>\n</div>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">Output</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-javascript\" data-lang=\"javascript\">{\n  <span class=\"hljs-attr\">meta</span>: {\n    <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">\"Post title\"</span>,\n    <span class=\"hljs-attr\">date</span>: <span class=\"hljs-string\">\"2019-11-11\"</span>\n  },\n  <span class=\"hljs-attr\">html</span>: <span class=\"hljs-string\">\"&lt;p&gt;Such a post!&lt;/p&gt;\"</span>\n}</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Importing files one by one is not really convenient for a blog where we have many files which we don&#8217;t want to import manually.</p>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_rollup_plugin_glob_to_the_rescue\"><a href=\"https://www.npmjs.com/package/rollup-plugin-glob\" target=\"_blank\" rel=\"noopener\">rollup-plugin-glob</a> to the rescue</h3>\n<div class=\"paragraph\">\n<p>With <a href=\"https://www.npmjs.com/package/rollup-plugin-glob\" target=\"_blank\" rel=\"noopener\">rollup-plugin-glob</a> we can import all the files in a directory by extension, so now we have our index of posts automatically converted to <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML\" target=\"_blank\" rel=\"noopener\">HTML</a>.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-javascript\" data-lang=\"javascript\"><span class=\"hljs-keyword\">import</span> allAdoc <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'../posts/**/*.adoc'</span>;\n\nallAdoc.forEach(<span class=\"hljs-function\"><span class=\"hljs-params\">post</span> =&gt;</span> <span class=\"hljs-keyword\">this</span>._add(post));</code></pre>\n</div>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">Output: List of posts already converted to HTML</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-javascript\" data-lang=\"javascript\">{ <span class=\"hljs-attr\">meta</span>: { <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">\"Post title\"</span>, <span class=\"hljs-attr\">date</span>: <span class=\"hljs-string\">\"2019-11-11\"</span> },\n  <span class=\"hljs-attr\">html</span>: <span class=\"hljs-string\">\"&lt;p&gt;Post 1.&lt;/p&gt;\"</span>\n}\n{ <span class=\"hljs-attr\">meta</span>: { <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">\"Post title\"</span>, <span class=\"hljs-attr\">date</span>: <span class=\"hljs-string\">\"2020-02-22\"</span> },\n  <span class=\"hljs-attr\">html</span>: <span class=\"hljs-string\">\"&lt;h2&gt;Title post&lt;/h2&gt;&lt;p&gt;This is a sample post...&lt;/p&gt;\"</span>\n}\n<span class=\"hljs-comment\">// ...</span></code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_syntax_highlighting\">Syntax highlighting</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>My blog is mainly about Software Engineering, so I have a strong requirement, code highlighting.</p>\n</div>\n<div class=\"paragraph\">\n<p>At the begging I started using <a href=\"https://highlightjs.org/usage/\" target=\"_blank\" rel=\"noopener\">highlightjs library from a CDN</a> for source code highlighting. We use imported library to parse the source code and for styling the result we need to import also a CSS file.</p>\n</div>\n<div class=\"paragraph\">\n<p>Later I realized that we can do the parsing work when we compile <a href=\"https://asciidoctor.org/\" target=\"_blank\" rel=\"noopener\">Asciidoctor</a> to <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML\" target=\"_blank\" rel=\"noopener\">HTML</a> in <a href=\"https://github.com/carlosvin/rollup-plugin-asciidoc\" target=\"_blank\" rel=\"noopener\">rollup-plugin-asciidoc</a> implementation, so we don&#8217;t have to download the <a href=\"https://en.wikipedia.org/wiki/JavaScript\" target=\"_blank\" rel=\"noopener\">JavaScript</a> file.</p>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Tip</div>\n</td>\n<td class=\"content\">\nDoing code highlighting transformation during the site building phase we are improving application performance and reducing bundle size.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Code highlighting transformation during site build step bring 2 great benefits:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Reducing bundle size: we don&#8217;t need the 27KB of <a href=\"https://highlightjs.org/usage/\">highlightjs javascript library</a>.</p>\n</li>\n<li>\n<p>Improving performance: source code parsing is done only once while site is built.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_result\">Result</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>I still have some <a href=\"https://github.com/carlosvin/carlosvin.github.io/issues\" target=\"_blank\" rel=\"noopener\">work to do</a>, but so far I have a blog with following features:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Automated generation of <a href=\"/sitemap.xml\">Sitemap</a> and <a href=\"/rss\">RSS feed</a>.</p>\n</li>\n<li>\n<p>Multi-language support (I still have to translate some texts).</p>\n</li>\n<li>\n<p>Syntax highlighting.</p>\n</li>\n<li>\n<p>100 score in <a href=\"https://developers.google.com/web/tools/lighthouse\" target=\"_blank\" rel=\"noopener\">Lighthouse audits</a>.</p>\n</li>\n</ul>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/lighthouse-results.webp\" alt=\"lighthouse score\" width=\"95%\">\n</div>\n</div>\n</div>\n</div>\n<div id=\"footnotes\">\n<hr>\n<div class=\"footnote\" id=\"_footnotedef_1\">\n<a href=\"#_footnoteref_1\">1</a>. Progressive Web Application\n</div>\n</div>","rollup":"https://rollupjs.org[Rollup,window='_blank']","pwa":"https://web.dev/progressive-web-apps[PWA,window='_blank']","sapper":"https://sapper.svelte.dev/[Sapper,window='_blank']","svelte":"https://svelte.dev[Svelte,window='_blank']","jamstack":"https://jamstack.org[JAMStack,window='_blank']","asciidoctorjs":"https://asciidoctor.org/docs/asciidoctor.js/[Asciidoctor.js,window=_blank]","rollup-plugin-asciidoc":"https://github.com/carlosvin/rollup-plugin-asciidoc[rollup-plugin-asciidoc,window=_blank]","rollup-plugin-glob":"https://www.npmjs.com/package/rollup-plugin-glob[rollup-plugin-glob,window=_blank]","authorcount":0,"title":"This is Sapper!","summary":"This blog has been migrated from Nikola to Sapper. Following the reasons why, some thoughts and performance results","slug":"this-is-sapper"}]}