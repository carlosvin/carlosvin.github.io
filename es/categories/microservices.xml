<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Carlos says "bla bla" (Publicaciones sobre Microservices)</title><link>https://carlosvin.github.io/</link><description></description><atom:link href="https://carlosvin.github.io/es/categories/microservices.xml" rel="self" type="application/rss+xml"></atom:link><language>es</language><lastBuildDate>Sun, 28 May 2017 16:10:43 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Contenedores Docker multi-dominio</title><link>https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/</link><dc:creator>Carlos Martín Sánchez</dc:creator><description>&lt;div&gt;&lt;div class="contents topic" id="contenido"&gt;
&lt;p class="topic-title first"&gt;Contenido&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#caso-de-uso" id="id1"&gt;Caso de Uso&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#como-configurar-un-proxy-inverso-multi-dominio" id="id2"&gt;Cómo configurar un Proxy Inverso Multi-Dominio&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#estructura-del-proyecto-de-ejemplo" id="id3"&gt;Estructura del proyecto de ejemplo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#configuracion-de-la-arquitectura-docker-compose" id="id4"&gt;Configuración de la arquitectura (docker-compose)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#configuracion-de-la-imagen-de-la-aplicacion" id="id5"&gt;Configuración de la imágen de la aplicación&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#anadiendo-los-nombres-de-dominio-a-tu-configuracion" id="id6"&gt;Añadiendo los nombres de dominio a tu configuración&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#todo-listo" id="id7"&gt;¡Todo listo!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="caso-de-uso"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id1"&gt;Caso de Uso&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Tenemos varias aplicaciones servidoras a la vez en un mismo entorno de desarrollo, cada una encapsulada en un contenedor, llamémosles de ahora en adelante "Contenedor A" y "Contenedor B".&lt;/p&gt;
&lt;p&gt;Utilizando docker estas aplicaciones tienen la misma dirección IP en nuestra máquina, una forma de distinguirlas es cambiando el puerto que exponen.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;a class="reference external image-reference" href="https://carlosvin.github.io/galleries/docker-multidomain/ip.png"&gt;&lt;img alt="/galleries/docker-multidomain/ip.thumbnail.png" src="https://carlosvin.github.io/galleries/docker-multidomain/ip.thumbnail.png"&gt;&lt;/a&gt;
&lt;p class="caption"&gt;Aplicaciones exponiendo la misma dirección IP utilizando diferentes puertos para diferenciar las aplicaciones&lt;/p&gt;
&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Si queremos llamar a la "aplicación A" haremos algo así: GET &lt;a class="reference external" href="http://10.20.30.40:8080/colors/red"&gt;http://10.20.30.40:8080/colors/red&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Si queremos llamar a la "aplicación B" haremos algo así: GET &lt;a class="reference external" href="http://10.20.30.40:8081/fruits/tomato"&gt;http://10.20.30.40:8081/fruits/tomato&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Pero esto es un poco confuso, ¿8080 sigfica que accedemos a las "aplicación A" y 8081 significa "aplicación B"?&lt;/p&gt;
&lt;p&gt;Sería mucho más sencillo de recordar algo así:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Si queremos llamar a la "aplicación A" haremos algo así: GET &lt;a class="reference external" href="http://a.domain.com/colors/red"&gt;http://a.domain.com/colors/red&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Si queremos llamar a la "aplicación B" haremos algo así: GET &lt;a class="reference external" href="http://b.domain.com/fruits/tomato"&gt;http://b.domain.com/fruits/tomato&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="figure"&gt;
&lt;a class="reference external image-reference" href="https://carlosvin.github.io/galleries/docker-multidomain/domain.png"&gt;&lt;img alt="/galleries/docker-multidomain/domain.thumbnail.png" src="https://carlosvin.github.io/galleries/docker-multidomain/domain.thumbnail.png"&gt;&lt;/a&gt;
&lt;p class="caption"&gt;Diferenciando aplicaciones por nombre de dominio&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Obtener este valor semántico extra es más sencillo de lo que parece.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="como-configurar-un-proxy-inverso-multi-dominio"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id2"&gt;Cómo configurar un Proxy Inverso Multi-Dominio&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Dije que era fácil porque no vamos a tener que hacer casi nada, ya que otro contenedor hará casi todo el trabajo por nosotros. Vamos a utilizar &lt;a class="reference external" href="https://github.com/jwilder/nginx-proxy"&gt;nginx-proxy&lt;/a&gt;, que generará automáticamente las configuraciones necesarias para &lt;a class="reference external" href="https://www.nginx.com"&gt;NGINX&lt;/a&gt;.&lt;/p&gt;
&lt;div class="admonition note"&gt;
&lt;p class="first admonition-title"&gt;Nota&lt;/p&gt;
&lt;p class="last"&gt;Puedes descargar el ejemplo completo desde: &lt;a class="reference external" href="https://github.com/carlosvin/docker-reverse-proxy-multi-domain"&gt;https://github.com/carlosvin/docker-reverse-proxy-multi-domain&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Así que al final no tendremos 2 contenedores, sino también tendremos un tercero que hará las veces de proxy.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;a class="reference external image-reference" href="https://carlosvin.github.io/galleries/docker-multidomain/proxy.png"&gt;&lt;img alt="/galleries/docker-multidomain/proxy.thumbnail.png" src="https://carlosvin.github.io/galleries/docker-multidomain/proxy.thumbnail.png"&gt;&lt;/a&gt;
&lt;p class="caption"&gt;Los 2 contenedores y el proxy&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="estructura-del-proyecto-de-ejemplo"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id3"&gt;Estructura del proyecto de ejemplo&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;docker-compose.yaml (Archivo con la configuración descrita en la imágen previa)&lt;/li&gt;
&lt;li&gt;a (Directorio para la aplicación A)&lt;ul&gt;
&lt;li&gt;Dockerfile (Archivo con la configuración del contenedor A)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;b (Directorio para la aplicación B)&lt;ul&gt;
&lt;li&gt;Dockerfile (Archivo con la configuración del contenedor B)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain"&gt;Ver proyecto&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="configuracion-de-la-arquitectura-docker-compose"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id4"&gt;Configuración de la arquitectura (docker-compose)&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;La parte más importante es la configuración de las relaciones entre los contenedores.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain/docker-compose.yaml.html"&gt;docker-reverse-proxy-multi-domain/docker-compose.yaml&lt;/a&gt;  &lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain/docker-compose.yaml"&gt;(Código fuente)&lt;/a&gt;&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-1"&gt; 1&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-2"&gt; 2&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-3"&gt; 3&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-4"&gt; 4&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-5"&gt; 5&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-6"&gt; 6&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-7"&gt; 7&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-8"&gt; 8&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-9"&gt; 9&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-10"&gt;10&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-11"&gt;11&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-12"&gt;12&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-13"&gt;13&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-14"&gt;14&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-15"&gt;15&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-16"&gt;16&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-17"&gt;17&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-18"&gt;18&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-19"&gt;19&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-20"&gt;20&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-21"&gt;21&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_73c734a488bf452bbf28800787158c80-22"&gt;22&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code yaml"&gt;&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-1"&gt;&lt;/a&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;a&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-2"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;build&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;a&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-3"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;environment&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-4"&gt;&lt;/a&gt;    &lt;span class="l l-Scalar l-Scalar-Plain"&gt;VIRTUAL_HOST&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;a.domain.com&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-5"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;restart&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-7"&gt;&lt;/a&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;b&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-8"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;build&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;b&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-9"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;environment&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-10"&gt;&lt;/a&gt;    &lt;span class="l l-Scalar l-Scalar-Plain"&gt;VIRTUAL_HOST&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;b.domain.com&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-11"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;restart&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-13"&gt;&lt;/a&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx-proxy&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-14"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;image&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;jwilder/nginx-proxy&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-15"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ports&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-16"&gt;&lt;/a&gt;    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"80:80"&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-17"&gt;&lt;/a&gt;    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"443:443"&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-18"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;volumes&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-19"&gt;&lt;/a&gt;    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/run/docker.sock:/tmp/docker.sock:ro&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-20"&gt;&lt;/a&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-21"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;restart&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
&lt;a name="rest_code_73c734a488bf452bbf28800787158c80-22"&gt;&lt;/a&gt;  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;privileged&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;ul class="simple"&gt;
&lt;li&gt;En la línea 4 y 10 es donde configuramos el nombre de dominio que queremos utilizar para cada aplicación.&lt;/li&gt;
&lt;li&gt;A partir de la línea 13 configuramos el proxy (esta es la parte de copiar y pegar).&lt;/li&gt;
&lt;li&gt;En la línea 2 y 8 estamos indicando a docker-compose que tiene que construir las imágenes dentro del directorio indicado. Por ejemplo, en la línea 2, estamos indicando que docker-compose tiene que construir la imágen docker utilizando ./a/Dockerfile.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="configuracion-de-la-imagen-de-la-aplicacion"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id5"&gt;Configuración de la imágen de la aplicación&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A continuación vamos a comentar la configuración de la imágen del contenedor para la aplicación A.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain/a/Dockerfile.html"&gt;docker-reverse-proxy-multi-domain/a/Dockerfile&lt;/a&gt;  &lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain/a/Dockerfile"&gt;(Código fuente)&lt;/a&gt;&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_cfadde7db4994711acbfa28f3f53e9b4-1"&gt;1&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_cfadde7db4994711acbfa28f3f53e9b4-2"&gt;2&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code docker"&gt;&lt;a name="rest_code_cfadde7db4994711acbfa28f3f53e9b4-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; httpd:2.4&lt;/span&gt;
&lt;a name="rest_code_cfadde7db4994711acbfa28f3f53e9b4-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;"&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;A&amp;lt;/h1&amp;gt;App A works!&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;"&lt;/span&gt; &amp;gt; /usr/local/apache2/htdocs/index.html
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Línea 1: Importamos una imágen con un servidor apache.&lt;/p&gt;
&lt;p&gt;Línea 2: Servimos un archivo que muestra "Host A" como página por defecto.&lt;/p&gt;
&lt;p&gt;La configuración para la aplicación B, es prácticamente la misma:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain/b/Dockerfile.html"&gt;docker-reverse-proxy-multi-domain/b/Dockerfile&lt;/a&gt;  &lt;a class="reference external" href="https://carlosvin.github.io/listings/docker-reverse-proxy-multi-domain/b/Dockerfile"&gt;(Código fuente)&lt;/a&gt;&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_46824213a3b047c68ff20b014ded9cc8-1"&gt;1&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_46824213a3b047c68ff20b014ded9cc8-2"&gt;2&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code docker"&gt;&lt;a name="rest_code_46824213a3b047c68ff20b014ded9cc8-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; httpd:2.4&lt;/span&gt;
&lt;a name="rest_code_46824213a3b047c68ff20b014ded9cc8-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;"&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;B&amp;lt;/h1&amp;gt;App B works!&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;"&lt;/span&gt; &amp;gt; /usr/local/apache2/htdocs/index.html
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="anadiendo-los-nombres-de-dominio-a-tu-configuracion"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id6"&gt;Añadiendo los nombres de dominio a tu configuración&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;En Linux simplemente tenemos mapear la dirección local a los nombres de dominio que hayas elegido, en nuestro ejemplo es a.domain.com y b.domain.com.&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-1"&gt;1&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-2"&gt;2&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-3"&gt;3&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-4"&gt;4&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-5"&gt;5&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code bash"&gt;&lt;a name="rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#/etc/hosts&lt;/span&gt;
&lt;a name="rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-2"&gt;&lt;/a&gt;&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1             localhost.localdomain localhost
&lt;a name="rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-3"&gt;&lt;/a&gt;::1                 localhost6.localdomain6 localhost6
&lt;a name="rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-4"&gt;&lt;/a&gt;&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1   a.domain.com
&lt;a name="rest_code_ed3376c7ee5a4a0c8b0aefefba836d74-5"&gt;&lt;/a&gt;&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1   b.domain.com
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Simplemente he añadido las líneas 4 y 5.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="todo-listo"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#id7"&gt;¡Todo listo!&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Ya solo nos queda probar el ejemplo.&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_411f4ccedfc1403ab364074dba7d9066-1"&gt;1&lt;/a&gt;
&lt;a href="https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/#rest_code_411f4ccedfc1403ab364074dba7d9066-2"&gt;2&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code bash"&gt;&lt;a name="rest_code_411f4ccedfc1403ab364074dba7d9066-1"&gt;&lt;/a&gt;docker-compose build
&lt;a name="rest_code_411f4ccedfc1403ab364074dba7d9066-2"&gt;&lt;/a&gt;docker-compose up
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Ya están las tres contenedores arrancados.&lt;/p&gt;
&lt;p&gt;Ahora podemos abrir nuestro navegador y escribir a.domain.com y nos mostrará el texto &lt;em&gt;App A works!&lt;/em&gt;. Si escribimos b.domain.com entonces veremos &lt;em&gt;App B works!&lt;/em&gt;.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;a class="reference external image-reference" href="https://carlosvin.github.io/galleries/docker-multidomain/a.screenshot.png"&gt;&lt;img alt="/galleries/docker-multidomain/a.screenshot.thumbnail.png" src="https://carlosvin.github.io/galleries/docker-multidomain/a.screenshot.thumbnail.png"&gt;&lt;/a&gt;
&lt;p class="caption"&gt;a.domain.com en el navegador&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure"&gt;
&lt;a class="reference external image-reference" href="https://carlosvin.github.io/galleries/docker-multidomain/b.screenshot.png"&gt;&lt;img alt="/galleries/docker-multidomain/b.screenshot.thumbnail.png" src="https://carlosvin.github.io/galleries/docker-multidomain/b.screenshot.thumbnail.png"&gt;&lt;/a&gt;
&lt;p class="caption"&gt;b.domain.com en el navegador&lt;/p&gt;
&lt;/div&gt;
&lt;div class="admonition note"&gt;
&lt;p class="first admonition-title"&gt;Nota&lt;/p&gt;
&lt;p class="last"&gt;En la mayoría de distribuciones Linux necesitarás privilegios para ejecutar los comandos docker (sudo).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>Docker</category><category>Microservices</category><guid>https://carlosvin.github.io/es/posts/reverse-proxy-multidomain-docker/</guid><pubDate>Thu, 24 Nov 2016 20:00:00 GMT</pubDate></item></channel></rss>