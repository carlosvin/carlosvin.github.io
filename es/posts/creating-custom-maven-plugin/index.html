<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Example to understand Maven plugins concepts and how to create a custom Maven plugin from scratch">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Example how to create custom Maven Plugin | Carlos says "bla bla"</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../rss.xml">
<link rel="canonical" href="https://carlosvin.github.io/es/posts/creating-custom-maven-plugin/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-1328360-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-1328360-10');
</script><meta name="author" content="Carlos Martín Sánchez">
<link rel="prev" href="../choosing-modern-cpp-stack/" title="Elegir tecnologías para mi nuevo proyeco C++" type="text/html">
<link rel="next" href="../creating-custom-maven-plugin-default/" title="Custom Maven Plugin: Override default build lifecycle" type="text/html">
<meta property="og:site_name" content='Carlos says "bla bla"'>
<meta property="og:title" content="Example how to create custom Maven Plugin">
<meta property="og:url" content="https://carlosvin.github.io/es/posts/creating-custom-maven-plugin/">
<meta property="og:description" content="Example to understand Maven plugins concepts and how to create a custom Maven plugin from scratch">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-03-11T19:00:00+01:00">
<meta property="article:tag" content="Build Systems">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Maven">
<meta property="article:tag" content="Maven Plugins">
<meta property="article:tag" content="maven-site-plugin">
<link rel="alternate" hreflang="en" href="../../../posts/creating-custom-maven-plugin/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://carlosvin.github.io/es/">

            <span id="blog-title">Carlos says "bla bla"</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archivos</a>
                </li>
<li class="nav-item">
<a href="../../categories/index.html" class="nav-link">Categorías</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS</a>

                
            </li>
</ul>
<form method="get" action="http://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<input type="hidden" name="sitesearch" value="https://carlosvin.github.io/">
</form>


            <ul class="navbar-nav navbar-right">
<li>
            </li>
<li class="nav-item"><a href="https://carlosvin.github.io/" rel="alternate" hreflang="en" class="nav-link">English</a></li>

                
                    
    
    <li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Código fuente</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Example how to create custom Maven Plugin</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Carlos Martín Sánchez
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2018-03-11T19:00:00+01:00" itemprop="datePublished" title="11/3/18 19:00">11/3/18 19:00</time></a>
            </p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/creating-custom-maven-plugin.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Código fuente</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>Maven has lots of plugins to assist you in project construction, testing, packaging and deployment. For example if you want to compile C++ code instead of Java, you can use <a class="reference external" href="http://www.mojohaus.org/maven-native/native-maven-plugin/">native-maven-plugin</a> . But what if you need something more specific? Then you can create a custom Maven plugin.</p>
<p>I will explain how to create a simple custom maven plugin to generate static blog site from Markdown files. I know we can already do that with <a class="reference external" href="https://maven.apache.org/plugins/maven-site-plugin/examples/creating-content.html">maven-site-plugin</a> since version 3.3, I will just use it for learning purposes.</p>
<p>You can find whole source code example at <a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin">https://github.com/carlosvin/blog-maven-plugin</a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#maven-plugin-concepts" id="id2">Maven plugin concepts</a></li>
<li>
<a class="reference internal" href="#create-your-custom-plugin-site-lifecycle" id="id3">Create your custom plugin (Site Lifecycle)</a><ul>
<li><a class="reference internal" href="#project-structure" id="id4">Project structure</a></li>
<li><a class="reference internal" href="#dependency-injection" id="id5">Dependency Injection</a></li>
<li>
<a class="reference internal" href="#write-a-custom-mojo" id="id6">Write a custom Mojo</a><ul>
<li><a class="reference internal" href="#implement-mojo-interface" id="id7">1. Implement Mojo interface</a></li>
<li><a class="reference internal" href="#configure-mojo-with-java-5-annotations" id="id8">2. Configure Mojo with Java 5 annotations</a></li>
<li><a class="reference internal" href="#implement-execute-method" id="id9">3. Implement <em>execute</em> method</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#unit-tests" id="id10">Unit tests</a></li>
<li>
<a class="reference internal" href="#integration-tests" id="id11">Integration tests</a><ul>
<li><a class="reference internal" href="#how-does-invoker-plugin-work" id="id12">How does Invoker Plugin work?</a></li>
<li><a class="reference internal" href="#configure-invoker-plugin" id="id13">Configure Invoker Plugin</a></li>
<li>
<a class="reference internal" href="#create-an-integration-test-project" id="id14">Create an Integration Test Project</a><ul>
<li><a class="reference internal" href="#pom-xml-arrange" id="id15">pom.xml (Arrange)</a></li>
<li><a class="reference internal" href="#invoker-properties-act" id="id16">invoker.properties (Act)</a></li>
<li><a class="reference internal" href="#verify-groovy-assert" id="id17">verify.groovy (Assert)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<!-- TEASER_END -->
<div class="section" id="maven-plugin-concepts">
<h2><a class="toc-backref" href="#id2">Maven plugin concepts</a></h2>
<dl class="docutils">
<dt><a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a></dt>
<dd>An executable goal in Maven, e.g: <tt class="docutils literal">mvn <span class="pre">your-plugin:your-mojo</span></tt> will execute a maven goal <tt class="docutils literal"><span class="pre">your-mojo</span></tt> declared as part of <tt class="docutils literal"><span class="pre">your-plugin</span></tt>.</dd>
<dt>Goal</dt>
<dd>It is equivalent to <a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a> execution</dd>
<dt>Lifecycle</dt>
<dd>
<p class="first">It is a well-defined sequence of phases. Each phase consists of a sequence of goals.
Let's see an example of lifecycle, e.g: <tt class="docutils literal">FooLifecycle</tt> has <tt class="docutils literal">clean</tt>, <tt class="docutils literal">prepare</tt> and <tt class="docutils literal">assemble</tt> phases. Each of those phases has one of more goals. <strong>FooLifecycle</strong>:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>clean</dt>
<dd><ul class="first last">
<li>
<strong>rmSources</strong>: a goal to remove source files</li>
<li>
<strong>rmBuild</strong>: a goal to remove files in cache directory</li>
</ul></dd>
</dl></li>
<li><dl class="first docutils">
<dt>prepare</dt>
<dd><ul class="first last">
<li>
<strong>installDependencies</strong>: a goal to download dependencies for the project</li>
</ul></dd>
</dl></li>
<li><dl class="first docutils">
<dt>assemble</dt>
<dd><ul class="first last">
<li>
<strong>build</strong>: a goal to compile source files</li>
</ul></dd>
</dl></li>
</ul>
<p class="last">To define a custom lifecycle as previous we will use <tt class="docutils literal"><span class="pre">src/main/resources/META-INF/plexus/components.xml</span></tt>, we will speak about that file in following sections.
Normally is enough to override <a class="reference external" href="https://maven.apache.org/ref/3.5.3/maven-core/lifecycles.html">predefined lifecycles</a>, in this example, we will override site lifecycle.</p>
</dd>
</dl>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">You can find an introduction to Maven lifecycles at <a class="reference external" href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html</a></p>
</div>
</div>
<div class="section" id="create-your-custom-plugin-site-lifecycle">
<h2><a class="toc-backref" href="#id3">Create your custom plugin (Site Lifecycle)</a></h2>
<p>The plugin we are about to explain will <a class="reference external" href="https://maven.apache.org/ref/3.5.3/maven-core/lifecycles.html#site_Lifecycle">override site lifecycle</a>, which has only 2 default phases, so when we run <tt class="docutils literal">mvn site</tt> using our new custom plugin it will execute the goals we are about to create.</p>
<p>Our plugin will work with <tt class="docutils literal">md</tt> file bindings: It will build the project and deploy it using <a class="reference external" href="http://maven.apache.org/plugins/maven-deploy-plugin/">maven deployment plugin</a>.</p>
<div class="section" id="project-structure">
<h3><a class="toc-backref" href="#id4">Project structure</a></h3>
<dl class="docutils">
<dt><tt class="docutils literal">src/main/java</tt></dt>
<dd>Where Java source code is</dd>
<dt><tt class="docutils literal"><span class="pre">src/main/resources/META-INF/plexus/components.xml</span></tt></dt>
<dd>file to create/override maven lifecycles and artifact types. Here we can specify which goals will be executed when for an artifact type, for example, we can say that for an artifact of type <tt class="docutils literal">whatever</tt> when we run <tt class="docutils literal">mvn foo</tt> it will verify the files, run tests, run linter, compile and zip al generated files.</dd>
<dt><tt class="docutils literal">src/test/java</tt></dt>
<dd>Unit tests folder</dd>
<dt><tt class="docutils literal">src/it</tt></dt>
<dd>Folder with all integration tests. Those integration tests are running actual projects and checking that outputs are as expected.</dd>
<dt><tt class="docutils literal">pom.xml</tt></dt>
<dd>File to with Maven project description <a class="reference external" href="https://maven.apache.org/guides/introduction/introduction-to-the-pom.html">(Project Object Model)</a>
</dd>
</dl>
</div>
<div class="section" id="dependency-injection">
<h3><a class="toc-backref" href="#id5">Dependency Injection</a></h3>
<p>Maven has finally chosen <a class="reference external" href="https://maven.apache.org/maven-jsr330.html">JSR-330</a> as <a class="reference external" href="http://javax-inject.github.io/javax-inject/">dependency injection standard</a> (previously it was Plexus Annotations API).</p>
<p>To use dependency injection with Maven we have to:</p>
<ol class="arabic simple">
<li>Add <tt class="docutils literal">javax.inject</tt> dependency to <tt class="docutils literal">pom.xml</tt> so we can use <tt class="docutils literal">@Inject</tt>, <tt class="docutils literal">@Named</tt>, and <tt class="docutils literal">@Singleton</tt> annotations in plugin implementation Java code.</li>
</ol>
<pre class="code xml"><a name="rest_code_76ddd2f42b794c7f8842a9918ee9a546-1"></a><span class="nt">&lt;dependency&gt;</span>
<a name="rest_code_76ddd2f42b794c7f8842a9918ee9a546-2"></a>    <span class="nt">&lt;groupId&gt;</span>javax.inject<span class="nt">&lt;/groupId&gt;</span>
<a name="rest_code_76ddd2f42b794c7f8842a9918ee9a546-3"></a>    <span class="nt">&lt;artifactId&gt;</span>javax.inject<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_76ddd2f42b794c7f8842a9918ee9a546-4"></a>    <span class="nt">&lt;version&gt;</span>1<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_76ddd2f42b794c7f8842a9918ee9a546-5"></a><span class="nt">&lt;/dependency&gt;</span>
</pre>
<ol class="arabic simple" start="2">
<li>Set up the sisu-maven-plugin to index the JSR-330 components you want made available to Maven.</li>
</ol>
<pre class="code xml"><a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-1"></a><span class="nt">&lt;plugin&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-2"></a>    <span class="nt">&lt;groupId&gt;</span>org.eclipse.sisu<span class="nt">&lt;/groupId&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-3"></a>    <span class="nt">&lt;artifactId&gt;</span>sisu-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-4"></a>    <span class="nt">&lt;version&gt;</span>0.3.3<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-5"></a>    <span class="nt">&lt;executions&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-6"></a>        <span class="nt">&lt;execution&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-7"></a>            <span class="nt">&lt;id&gt;</span>generate-index<span class="nt">&lt;/id&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-8"></a>            <span class="nt">&lt;goals&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-9"></a>                <span class="nt">&lt;goal&gt;</span>main-index<span class="nt">&lt;/goal&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-10"></a>            <span class="nt">&lt;/goals&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-11"></a>        <span class="nt">&lt;/execution&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-12"></a>    <span class="nt">&lt;/executions&gt;</span>
<a name="rest_code_5b970bed6f7946f6a9ce78de5c34b065-13"></a><span class="nt">&lt;/plugin&gt;</span>
</pre>
<ol class="arabic simple" start="3">
<li>Add annotations to your Mojo, e.g:</li>
</ol>
<pre class="code java"><a name="rest_code_1f798494fc5e45c5ae126c201fd75849-1"></a><span class="c1">// This annotation is not a dependency injection one, we will explain later what it is for</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-2"></a><span class="nd">@Mojo</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"build"</span><span class="o">,</span> <span class="n">defaultPhase</span> <span class="o">=</span> <span class="n">LifecyclePhase</span><span class="o">.</span><span class="na">COMPILE</span><span class="o">)</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-3"></a><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuildMojo</span> <span class="kd">extends</span> <span class="n">AbstractMojo</span> <span class="o">{</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-4"></a>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-5"></a>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">FileSetManager</span> <span class="n">fileSetManager</span><span class="o">;</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-6"></a>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">MdToHtml</span> <span class="n">mdToHtml</span><span class="o">;</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-7"></a>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-8"></a>    <span class="c1">// It will inject an instance of FileSetManager and MdToHtml</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-9"></a>    <span class="nd">@Inject</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-10"></a>    <span class="kd">public</span> <span class="nf">BuildMojo</span><span class="o">(</span><span class="n">FileSetManager</span> <span class="n">fileSetManager</span><span class="o">,</span> <span class="n">MdToHtml</span> <span class="n">mdToHtml</span><span class="o">)</span> <span class="o">{</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-11"></a>        <span class="k">this</span><span class="o">.</span><span class="na">fileSetManager</span> <span class="o">=</span> <span class="n">fileSetManager</span><span class="o">;</span>
<a name="rest_code_1f798494fc5e45c5ae126c201fd75849-12"></a>        <span class="k">this</span><span class="o">.</span><span class="na">mdToHtml</span> <span class="o">=</span> <span class="n">mdToHtml</span><span class="o">;</span>
</pre>
</div>
<div class="section" id="write-a-custom-mojo">
<h3>Write a custom <a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a>
</h3>
<p>It is straightforward to implement a <a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a> class, we have to:</p>
<div class="section" id="implement-mojo-interface">
<h4><a class="toc-backref" href="#id7">1. Implement Mojo interface</a></h4>
<p>Your <a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a> class has to implement <tt class="docutils literal">org.apache.maven.plugin.Mojo</tt>, although it is more convenient to extend <tt class="docutils literal">org.apache.maven.plugin.AbstractMojo</tt>, an abstract class to provide most of the infrastructure required to implement a Mojo except for execute method. That interface and class are described at <a class="reference external" href="https://maven.apache.org/developers/mojo-api-specification.html">Mojo API</a>.</p>
<pre class="code java"><a name="rest_code_f9187199a07645c488b7d74e36ee07e4-1"></a><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuildMojo</span> <span class="kd">extends</span> <span class="n">AbstractMojo</span> <span class="o">{</span>
</pre>
</div>
<div class="section" id="configure-mojo-with-java-5-annotations">
<h4><a class="toc-backref" href="#id8">2. Configure Mojo with Java 5 annotations</a></h4>
<p>Annotate <a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a> class with <tt class="docutils literal">@Mojo</tt> and input parameters with <tt class="docutils literal">@Parameter</tt>. Those annotations belong to another set of annotations to configure Mojos, <a class="reference external" href="https://maven.apache.org/plugin-tools/maven-plugin-plugin/examples/using-annotations.html">Plugin Tools Java5 Annotations</a>.</p>
<pre class="code java"><a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-1"></a><span class="cm">/**</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-2"></a><span class="cm">* Generate HTML files from Markdown files</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-3"></a><span class="cm">*/</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-4"></a><span class="nd">@Mojo</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"build"</span><span class="o">,</span> <span class="n">defaultPhase</span> <span class="o">=</span> <span class="n">LifecyclePhase</span><span class="o">.</span><span class="na">COMPILE</span><span class="o">)</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-5"></a><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuildMojo</span> <span class="kd">extends</span> <span class="n">AbstractMojo</span> <span class="o">{</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-6"></a>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-7"></a>    <span class="cm">/**</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-8"></a><span class="cm">    * Output directory path where HTML files are generated</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-9"></a><span class="cm">    */</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-10"></a>    <span class="nd">@Parameter</span><span class="o">(</span><span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"${project.reporting.outputDirectory}"</span><span class="o">,</span> <span class="n">property</span> <span class="o">=</span> <span class="s">"siteOutputDirectory"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-11"></a>    <span class="kd">private</span> <span class="n">File</span> <span class="n">outputDirectory</span><span class="o">;</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-12"></a>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-13"></a>    <span class="cm">/**</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-14"></a><span class="cm">    * A specific &lt;code&gt;fileSet&lt;/code&gt; rule to select files and directories.</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-15"></a><span class="cm">    * Fileset spec: https://maven.apache.org/shared/file-management/fileset.html</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-16"></a><span class="cm">    */</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-17"></a>    <span class="nd">@Parameter</span>
<a name="rest_code_f4a7aa16244843ddbc9c685d028afe4c-18"></a>    <span class="kd">private</span> <span class="n">FileSet</span> <span class="n">inputFiles</span><span class="o">;</span>
</pre>
<dl class="docutils">
<dt><tt class="docutils literal">@Mojo</tt></dt>
<dd>Configures Mojo name and default lifecycle phase. To execute the Mojo in example we will use <tt class="docutils literal">mvn site:build</tt>: <em>site</em> is the plugin name and <em>build</em> is <tt class="docutils literal">name</tt> parameter.</dd>
<dt><tt class="docutils literal">@Parameter</tt></dt>
<dd>
<p class="first">We use it to pass configuration parameters to Mojo. <tt class="docutils literal">@Parameter</tt> annotation accepts extra arguments</p>
<ul class="simple">
<li>defaultValue: You can use properties placeholder or any String. If the parameter type is not a String, then Maven will try to cast it, e.g:</li>
</ul>
<pre class="code java"><a name="rest_code_f02867cd38a447b0bd694bb7e636e180-1"></a><span class="c1">// If intParameter is not set in pom file, then "2" will be converted to 2 and assigned to intParameter.</span>
<a name="rest_code_f02867cd38a447b0bd694bb7e636e180-2"></a><span class="nd">@Parameter</span><span class="o">(</span><span class="n">defaultValue</span><span class="o">=</span><span class="s">"2"</span><span class="o">)</span>
<a name="rest_code_f02867cd38a447b0bd694bb7e636e180-3"></a><span class="n">Integer</span> <span class="n">intParameter</span><span class="o">;</span>
</pre>
<ul class="simple">
<li>property: It allows configuration of the Mojo parameter from the command line by referencing a system property that the user sets via the -D option.</li>
</ul>
<div class="last"><pre class="code bash"><a name="rest_code_0d4a2e0d8c0d4922aa41c58403e79333-1"></a><span class="c1"># To assign "/var/www/html" value to  outputDirectory:</span>
<a name="rest_code_0d4a2e0d8c0d4922aa41c58403e79333-2"></a>
<a name="rest_code_0d4a2e0d8c0d4922aa41c58403e79333-3"></a>mvn site:build -DsiteOutputDirectory<span class="o">=</span>/var/www/html
</pre></div>
</dd>
</dl>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">More info in <a class="reference external" href="https://maven.apache.org/guides/plugin/guide-java-plugin-development.html#Parameters">Maven Plugin development guide in Parametera section</a>.</p>
</div>
</div>
<div class="section" id="implement-execute-method">
<h4><a class="toc-backref" href="#id9">3. Implement <em>execute</em> method</a></h4>
<p>As I have explained before at <a class="reference internal" href="#implement-mojo-interface">1. Implement Mojo interface</a>, our <a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a> class extends <tt class="docutils literal">org.apache.maven.plugin.AbstractMojo</tt> which has one unimplemented method from <tt class="docutils literal">org.apache.maven.plugin.Mojo</tt> interface. In that method we are going to implement the Maven goal logic.</p>
<p><a class="reference external" href="http://maven.apache.org/plugin-developers/index.html">Mojo</a> class instance is called from <a class="reference external" href="http://maven.apache.org">Maven</a> execution lifecycle by invoking <tt class="docutils literal">execute()</tt> method. Before calling <tt class="docutils literal">execute()</tt>, Maven has performed some other tasks related with the Mojo:</p>
<ol class="arabic simple">
<li>Maven instantiates Mojo and injects dependencies (<a class="reference internal" href="#dependency-injection">Dependency Injection</a>).</li>
</ol>
<pre class="code java"><a name="rest_code_d42fbdc3e30748bcb4215ed2c7c7056a-1"></a><span class="n">Mojo</span> <span class="n">mojo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BuildMojo</span><span class="o">(</span><span class="n">fileSetManager</span><span class="o">,</span> <span class="n">mdToHtml</span><span class="o">);</span>
</pre>
<ol class="arabic simple" start="2">
<li>Maven configures the Mojo by assigning values to parameters.</li>
<li>Maven calls execute method: <tt class="docutils literal"><span class="pre">mojo.execute();</span></tt>.</li>
</ol>
<p>I will simplify <tt class="docutils literal">execute</tt> method implementation, the <a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin">sample project in github</a> is more complicated and not good for learning.</p>
<pre class="code java"><a name="rest_code_210b5017883245b09dc5c52c751a21a1-1"></a><span class="c1">// If there is any error during execution, it should throw MojoExecutionException</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-2"></a><span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">MojoExecutionException</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-3"></a>    <span class="k">if</span> <span class="o">(</span><span class="n">inputFiles</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-4"></a>        <span class="n">setDefaultInput</span><span class="o">();</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-5"></a>    <span class="o">}</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-6"></a>    <span class="n">inputDirPath</span> <span class="o">=</span> <span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">inputFiles</span><span class="o">.</span><span class="na">getDirectory</span><span class="o">());</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-7"></a>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-8"></a>    <span class="c1">// A way to get all selected files from FileSet</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-9"></a>    <span class="c1">// https://maven.apache.org/shared/file-management/fileset.html</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-10"></a>    <span class="n">String</span><span class="o">[]</span> <span class="n">includedFiles</span> <span class="o">=</span> <span class="n">fileSetManager</span><span class="o">.</span><span class="na">getIncludedFiles</span><span class="o">(</span><span class="n">inputFiles</span><span class="o">);</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-11"></a>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-12"></a>    <span class="n">outputDirPath</span> <span class="o">=</span> <span class="n">outputDirectory</span><span class="o">.</span><span class="na">toPath</span><span class="o">();</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-13"></a>    <span class="k">if</span> <span class="o">(</span><span class="n">includedFiles</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">includedFiles</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-14"></a>        <span class="c1">// AbstractMojo supplies logger functionality</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-15"></a>        <span class="n">getLog</span><span class="o">().</span><span class="na">warn</span><span class="o">(</span><span class="s">"SKIP: There are no input files. "</span> <span class="o">+</span> <span class="n">getInputFilesToString</span><span class="o">());</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-16"></a>    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-17"></a>        <span class="c1">// If output directory doesn't exist, it will be created</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-18"></a>        <span class="k">if</span> <span class="o">(!</span><span class="n">outputDirectory</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-19"></a>            <span class="n">outputDirectory</span><span class="o">.</span><span class="na">mkdirs</span><span class="o">();</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-20"></a>        <span class="o">}</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-21"></a>        <span class="k">try</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-22"></a>            <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">f</span> <span class="o">:</span> <span class="n">includedFiles</span><span class="o">)</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-23"></a>                <span class="c1">// it converts each file Markdown to HTML</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-24"></a>                <span class="n">convertToHtml</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">f</span><span class="o">),</span> <span class="n">outputDirectory</span><span class="o">);</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-25"></a>            <span class="o">}</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-26"></a>        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-27"></a>            <span class="c1">// Convert thrown exception to MojoExecutionException</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-28"></a>            <span class="k">throw</span> <span class="k">new</span> <span class="n">MojoExecutionException</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getLocalizedMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-29"></a>        <span class="o">}</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-30"></a>    <span class="o">}</span>
<a name="rest_code_210b5017883245b09dc5c52c751a21a1-31"></a><span class="o">}</span>
</pre>
</div>
</div>
</div>
<div class="section" id="unit-tests">
<h2><a class="toc-backref" href="#id10">Unit tests</a></h2>
<p>In the example we use <a class="reference external" href="https://junit.org/junit4/">JUnit 4</a>, but you can use any other testing framework.</p>
<p>Firtsly, you have to add the unit test library dependency to <tt class="docutils literal">pom.xml</tt>.</p>
<pre class="code xml"><a name="rest_code_4f7536c1d59f4e33ad111f7397449d3f-1"></a><span class="nt">&lt;dependency&gt;</span>
<a name="rest_code_4f7536c1d59f4e33ad111f7397449d3f-2"></a>    <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
<a name="rest_code_4f7536c1d59f4e33ad111f7397449d3f-3"></a>    <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_4f7536c1d59f4e33ad111f7397449d3f-4"></a>    <span class="nt">&lt;version&gt;</span>4.11<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_4f7536c1d59f4e33ad111f7397449d3f-5"></a>    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<a name="rest_code_4f7536c1d59f4e33ad111f7397449d3f-6"></a><span class="nt">&lt;/dependency&gt;</span>
</pre>
<p>Then you just have to write your unit tests under <tt class="docutils literal">src/test/java</tt> folder, for example: <a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin/blob/master/src/test/java/com/maven/plugins/blog/PathsTest.java">src/test/java/com/maven/plugins/blog/PathsTest.java</a>.</p>
<p>To run the unit tests you just need to execute <tt class="docutils literal">mvn test</tt>.</p>
</div>
<div class="section" id="integration-tests">
<h2><a class="toc-backref" href="#id11">Integration tests</a></h2>
<p>The 2 most popular ways to perform integration tests on custom maven plugins are using <a class="reference external" href="https://maven.apache.org/surefire/maven-failsafe-plugin">maven-failsafe-plugin</a> or <a class="reference external" href="https://maven.apache.org/plugins/maven-invoker-plugin">maven-invoker-plugin</a>.</p>
<p>I've chosen <a class="reference external" href="https://maven.apache.org/plugins/maven-invoker-plugin">maven-invoker-plugin</a> because for me it is more straightforward. There is <a class="reference external" href="https://stackoverflow.com/questions/40010745/maven-invoker-plugin-vs-maven-failsafe-plugin-which-to-use-for-integration-test">an answer at stackoverflow where they explain thoroughly the differences between them</a></p>
<div class="section" id="how-does-invoker-plugin-work">
<h3><a class="toc-backref" href="#id12">How does Invoker Plugin work?</a></h3>
<p>We create projects to use our custom plugin under <tt class="docutils literal">src/it</tt> folder, so our plugin will be applied to test projects. After that, a validation script will be executed so we can check if our plugin outputs are as expected. For example, if our plugin is supposed to generate a file named <tt class="docutils literal">foo.file</tt>, verification plugin will check if that file exists, if it doesn't, integration test will fail.</p>
</div>
<div class="section" id="configure-invoker-plugin">
<h3><a class="toc-backref" href="#id13">Configure Invoker Plugin</a></h3>
<pre class="code xml"><a name="rest_code_bbf0226340d4433382da81407b32d32c-1"></a><span class="nt">&lt;plugin&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-2"></a>    <span class="nt">&lt;artifactId&gt;</span>maven-invoker-plugin<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-3"></a>    <span class="nt">&lt;version&gt;</span>3.0.1<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-4"></a>    <span class="nt">&lt;configuration&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-5"></a>        <span class="nt">&lt;postBuildHookScript&gt;</span>verify<span class="nt">&lt;/postBuildHookScript&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-6"></a>        <span class="nt">&lt;showVersion&gt;</span>true<span class="nt">&lt;/showVersion&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-7"></a>        <span class="nt">&lt;streamLogs&gt;</span>true<span class="nt">&lt;/streamLogs&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-8"></a>        <span class="nt">&lt;noLog&gt;</span>false<span class="nt">&lt;/noLog&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-9"></a>        <span class="nt">&lt;showErrors&gt;</span>true<span class="nt">&lt;/showErrors&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-10"></a>    <span class="nt">&lt;/configuration&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-11"></a>    <span class="nt">&lt;executions&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-12"></a>        <span class="nt">&lt;execution&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-13"></a>            <span class="nt">&lt;id&gt;</span>integration-test<span class="nt">&lt;/id&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-14"></a>            <span class="nt">&lt;goals&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-15"></a>                <span class="nt">&lt;goal&gt;</span>install<span class="nt">&lt;/goal&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-16"></a>                <span class="nt">&lt;goal&gt;</span>run<span class="nt">&lt;/goal&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-17"></a>            <span class="nt">&lt;/goals&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-18"></a>        <span class="nt">&lt;/execution&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-19"></a>    <span class="nt">&lt;/executions&gt;</span>
<a name="rest_code_bbf0226340d4433382da81407b32d32c-20"></a><span class="nt">&lt;/plugin&gt;</span>
</pre>
<p>In <strong>executions</strong> section we execute following goals:</p>
<ol class="arabic simple">
<li>
<tt class="docutils literal">invoker:install</tt> will be executed during the phase pre-integration-test and will install the main project artifact into target/local-repo.</li>
<li>
<tt class="docutils literal">invoker:run</tt> will be executed during the integration-test phase and it will execute all defined integration tests under <tt class="docutils literal">src/it</tt> folder.</li>
</ol>
<p>In <strong>configuration</strong> section:</p>
<p><tt class="docutils literal"><span class="pre">&lt;postBuildHookScript&gt;verify&lt;/postBuildHookScript&gt;</span></tt> configures invoker plugin to execute validation script after integration test project execution. This script may be written with either BeanShell or Groovy (verify.groovy or verify.bsh).</p>
<p>We have used other properties to show errors, show maven log and save it to a file.</p>
<p>You can check all <tt class="docutils literal">invoker:run</tt> configuration properties at <a class="reference external" href="https://maven.apache.org/plugins/maven-invoker-plugin/run-mojo.html">https://maven.apache.org/plugins/maven-invoker-plugin/run-mojo.html</a>.</p>
</div>
<div class="section" id="create-an-integration-test-project">
<h3><a class="toc-backref" href="#id14">Create an Integration Test Project</a></h3>
<p>It is a project we use to execute custom plugin goals, so we can validate if it produces the expected output.</p>
<p>There are 3 important files that matche with <a class="reference external" href="http://wiki.c2.com/?ArrangeActAssert">AAA</a> phases ("Arrange-Act-Assert"):</p>
<ul class="simple">
<li>
<a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin/blob/master/src/it/md-html/pom.xml">src/it/md-html/pom.xml [Arrange]</a> which has the project using our custom plugin.</li>
<li>
<a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin/blob/master/src/it/md-html/invoker.properties">src/it/md-html/invoker.properties [Act]</a> will define how test project will be executed.</li>
<li>
<a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin/blob/master/src/it/md-html/verify.groovy">src/it/md-html/verify.groovy [Assert]</a> is the script to check that plugin execution generated expected results.</li>
</ul>
<div class="section" id="pom-xml-arrange">
<h4><a class="toc-backref" href="#id15">pom.xml (Arrange)</a></h4>
<pre class="code xml"><a name="rest_code_7911df3b05f84583b18b99259515b6df-1"></a><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-2"></a><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-3"></a><span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-4"></a>    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-5"></a>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-6"></a>    <span class="nt">&lt;groupId&gt;</span>com.maven.plugins.it<span class="nt">&lt;/groupId&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-7"></a>    <span class="nt">&lt;artifactId&gt;</span>simple-it<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-8"></a>    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-9"></a>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-10"></a>    <span class="nt">&lt;build&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-11"></a>        <span class="nt">&lt;plugins&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-12"></a>            <span class="nt">&lt;plugin&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-13"></a>                <span class="nt">&lt;groupId&gt;</span>@project.groupId@<span class="nt">&lt;/groupId&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-14"></a>                <span class="nt">&lt;artifactId&gt;</span>@project.artifactId@<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-15"></a>                <span class="nt">&lt;version&gt;</span>@project.version@<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-16"></a>            <span class="nt">&lt;/plugin&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-17"></a>        <span class="nt">&lt;/plugins&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-18"></a>    <span class="nt">&lt;/build&gt;</span>
<a name="rest_code_7911df3b05f84583b18b99259515b6df-19"></a><span class="nt">&lt;/project&gt;</span>
</pre>
<p>It is a very simple pom file where we use placeholders to reference to our plugin under test. When invoker plugin executes following pom file, firstly will replace those placeholders to reference to the latest version sof our custom plugin which was recently installed in the local repository:</p>
<pre class="code xml"><a name="rest_code_3fddd3add5624a54908d3e109fdb62ce-1"></a><span class="nt">&lt;plugin&gt;</span>
<a name="rest_code_3fddd3add5624a54908d3e109fdb62ce-2"></a>    <span class="nt">&lt;groupId&gt;</span>com.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
<a name="rest_code_3fddd3add5624a54908d3e109fdb62ce-3"></a>        <span class="nt">&lt;artifactId&gt;</span>blog<span class="nt">&lt;/artifactId&gt;</span>
<a name="rest_code_3fddd3add5624a54908d3e109fdb62ce-4"></a>        <span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<a name="rest_code_3fddd3add5624a54908d3e109fdb62ce-5"></a><span class="nt">&lt;/plugin&gt;</span>
</pre>
<p>In that way invoker plugin ensures it is testing the latest version of current project.</p>
</div>
<div class="section" id="invoker-properties-act">
<h4><a class="toc-backref" href="#id16">invoker.properties (Act)</a></h4>
<pre class="code properties"><a name="rest_code_aace58bcbf7d4651886740a5d59a3a04-1"></a><span class="na">invoker.goals</span> <span class="o">=</span> <span class="s">blog:build</span>
<a name="rest_code_aace58bcbf7d4651886740a5d59a3a04-2"></a><span class="na">invoker.name</span> <span class="o">=</span> <span class="s">Test build MD</span>
</pre>
<p>It will execute <tt class="docutils literal">mvn blog:build</tt>, a goal defined in our custom plugin under example or what is the same, it will execute <a class="reference external" href="https://github.com/carlosvin/blog-maven-plugin/blob/master/src/main/java/com/maven/plugins/blog/BuildMojo.java">BuildMojo</a> described in section "<a class="reference internal" href="#write-a-custom-mojo">Write a custom Mojo</a>".</p>
</div>
<div class="section" id="verify-groovy-assert">
<h4><a class="toc-backref" href="#id17">verify.groovy (Assert)</a></h4>
<p>Verification script, it is checking if <tt class="docutils literal">target/site/README.html</tt> file was generated by the plugin.</p>
<pre class="code groovy"><a name="rest_code_4e0dd15080f849b7b30124f799feb217-1"></a><span class="n">File</span> <span class="n">generated</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span> <span class="n">basedir</span><span class="o">,</span> <span class="s2">"target/site/README.html"</span> <span class="o">);</span>
<a name="rest_code_4e0dd15080f849b7b30124f799feb217-2"></a>
<a name="rest_code_4e0dd15080f849b7b30124f799feb217-3"></a><span class="k">assert</span> <span class="n">generated</span><span class="o">.</span><span class="na">isFile</span><span class="o">()</span>
</pre>
</div>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/build-systems/" rel="tag">Build Systems</a></li>
            <li><a class="tag p-category" href="../../categories/java/" rel="tag">Java</a></li>
            <li><a class="tag p-category" href="../../categories/maven/" rel="tag">Maven</a></li>
            <li><a class="tag p-category" href="../../categories/maven-plugins/" rel="tag">Maven Plugins</a></li>
            <li><a class="tag p-category" href="../../categories/maven-site-plugin/" rel="tag">maven-site-plugin</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../choosing-modern-cpp-stack/" rel="prev" title="Elegir tecnologías para mi nuevo proyeco C++">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../creating-custom-maven-plugin-default/" rel="next" title="Custom Maven Plugin: Override default build lifecycle">Siguiente publicación</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comentarios</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="carlosvin",
            disqus_url="https://carlosvin.github.io/es/posts/creating-custom-maven-plugin/",
        disqus_title="Example how to create custom Maven Plugin",
        disqus_identifier="cache/posts/creating-custom-maven-plugin.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="carlosvin";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer"><div class="page-footer">
        <div class="page-footer-wrapper">
            <a href="https://www.linkedin.com/in/carlosvin" style="margin-right: 3%;">Carlos Martín Sánchez</a>
            <a href="https://twitter.com/intent/user?screen_name=carlosvin" class="twitter-follow-button">
                @carlosvin
            </a>
            <div class="copyright">
   <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
   <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
</div>
            <div class="poweredby">Powered by <a href="http://getnikola.com" rel="nofollow">Nikola</a>
</div>
        </div>
    </div>
    
            
        </footer>
</div>
</div>


        <script src="../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Start of StatCounter Code for Default Guide --><script type="text/javascript">
var sc_project=9708205;
var sc_invisible=1;
var sc_security="4998d447";
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script><noscript><div class="statcounter"><a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="http://c.statcounter.com/9708205/0/4998d447/1/" alt="web analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->


</body>
</html>
