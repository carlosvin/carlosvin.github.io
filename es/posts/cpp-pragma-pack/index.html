<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Comprendiendo cómo funciona la directiva C++ pragma pack y cómo afecta a la alineación de la memoria">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Alineación de una Estructura C++ en Memoria | Carlos says "bla bla"</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../rss.xml">
<link rel="canonical" href="https://carlosvin.github.io/es/posts/cpp-pragma-pack/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="google-site-verification" content="XzkYCjSblA4sHLJDa1Higd_O6P8hudmo6YJRDp5dDDc">
<meta name="msvalidate.01" content="F072D88C59F679193037D42408AD5CE9">
<meta name="yandex-verification" content="c969e485a9e92311">
<meta name="author" content="Carlos Martín Sánchez">
<link rel="prev" href="../git-proxy-config/" title="Configuración de proxy para Git" type="text/html">
<link rel="next" href="../debug-libtool-lib/" title="Depurar librería generada con libtool" type="text/html">
<meta property="og:site_name" content='Carlos says "bla bla"'>
<meta property="og:title" content="Alineación de una Estructura C++ en Memoria">
<meta property="og:url" content="https://carlosvin.github.io/es/posts/cpp-pragma-pack/">
<meta property="og:description" content="Comprendiendo cómo funciona la directiva C++ pragma pack y cómo afecta a la alineación de la memoria">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2012-11-26T12:00:00+01:00">
<meta property="article:tag" content="C++">
<link rel="alternate" hreflang="en" href="../../../posts/cpp-pragma-pack/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Mostrar navegación</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://carlosvin.github.io/es/">

                <span id="blog-title">Carlos says "bla bla"</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archivos</a>
                </li>
<li>
<a href="../../categories/index.html">Categorías</a>
                </li>
<li>
<a href="../../rss.xml">RSS</a>

                
            </li>
</ul>
<form method="get" action="http://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://carlosvin.github.io/">
</form>


            <ul class="nav navbar-nav navbar-right">
<li>
            </li>
<li><a href="https://carlosvin.github.io/" rel="alternate" hreflang="en">English</a></li>

                
                    
    <li>
    <a href="index.rst" id="sourcelink">Código fuente</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Alineación de una Estructura C++ en Memoria</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Carlos Martín Sánchez
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2012-11-26T12:00:00+01:00" itemprop="datePublished" title="2012-11-26">2012-11-26</time></a></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/cpp-pragma-pack.en.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Código fuente</a></p>

        </div>
        
        <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">También disponible en:</h3>
                <p><a href="../../../posts/cpp-pragma-pack/" rel="alternate" hreflang="en">English</a></p>
        </div>

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>Un struct de C++ es un elemento que permite agrupar elementos de tipos distintos con alguna relación entre ellos. Esto permite manipular todos los elementos en bloque mediante una única referencia. Podemos considerarlo como una clase con visibilidad publica por defecto para sus atributos y funciones.</p>
<p>Si alguna vez nos interesa trabajar a un nivel más bajo, nos puede resultar útil entender cómo se mapea una estructura en memoria y cómo controlar este mapeo.</p>
<div class="contents topic" id="tabla-de-contenidos">
<p class="topic-title first">Tabla de Contenidos</p>
<ul class="simple">
<li><a class="reference internal" href="#estructura-de-ejemplo" id="id1">Estructura de ejemplo</a></li>
<li><a class="reference internal" href="#la-directiva-pragma-pack-en-struct-c" id="id2">La directiva #pragma pack en struct C++</a></li>
<li><a class="reference internal" href="#rendimiento" id="id3">Rendimiento</a></li>
</ul>
</div>
<!-- TEASER_END -->
<div class="section" id="estructura-de-ejemplo">
<h2><a class="toc-backref" href="#id1">Estructura de ejemplo</a></h2>
<p>Esta estructura estará compuesta por dos campos, un entero (4 bytes) y un booleano (un byte). En C++ queda de la siguiente forma:</p>
<pre class="code c++"><a name="rest_code_980201bd40ed49e782192bd25075f4d0-1"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_980201bd40ed49e782192bd25075f4d0-2"></a><span class="p">{</span>
<a name="rest_code_980201bd40ed49e782192bd25075f4d0-3"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_980201bd40ed49e782192bd25075f4d0-4"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_980201bd40ed49e782192bd25075f4d0-5"></a><span class="p">};</span>
</pre>
<p>Si hacemos un <code>sizeof</code> de la una instancia de la estructura deberíamos obtener un tamaño de 5 bytes. Y la memoria quedaría de la siguiente forma:</p>
<div class="figure" style="width: 50%">
<img alt="/galleries/c-mem-struct/5b.png" src="../../../galleries/c-mem-struct/5b.png" style="width: 30%;"><p class="caption">Estructura de 5 bytes que realmente ocupa 5 bytes en memoria.</p>
</div>
<p>Pero no es tan sencillo, a continuación veremos que no nos podemos olvidar de la alineación de la memoria que hace el compilador en ese sistema y veremos cómo controlarlo para no encontrarnos con tamaños inesperados, ya que esto depende del compilador del sistema.</p>
<p>Por ejemplo, si en mi máquina hago un <code>sizeof</code> de la estructura, obtengo un tamaño de 8 bytes. Lo que está sucediendo es que el compilador reserva más memoria al final de la estructura para que cuadre en bloques de 2n bytes. La memoria queda de la siguiente forma:</p>
<div class="figure" style="width: 50%">
<img alt="/galleries/c-mem-struct/8b.png" src="../../../galleries/c-mem-struct/8b.png" style="width: 30%;"><p class="caption">Estructura de 5 bytes que realmente ocupa 8 bytes en memoria. Para ser más precisos, debería haber dibujado la memoria no usada a continuación del atributo flag.</p>
</div>
<p>Vamos a ver un fragmento de código que imprime el tamaño de la estructura y el de cada uno de sus atributos y verificar, en este caso 4 + 1 no es 5.</p>
<pre class="code c++"><a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-1"></a><span class="cp">#include</span>  <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-2"></a>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-3"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-4"></a>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-5"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-6"></a><span class="p">{</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-7"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-8"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-9"></a><span class="p">};</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-10"></a>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-11"></a><span class="k">static</span> <span class="kt">void</span> <span class="nf">print</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">sz</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_flag</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_timeout</span><span class="p">)</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-12"></a><span class="p">{</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-13"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">flag: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-14"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">+"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-15"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">timeout: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-16"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">="</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-17"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">+</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-18"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="s">"sizeof struct:  "</span> <span class="o">&lt;&lt;</span> <span class="n">sz</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-19"></a><span class="p">}</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-20"></a>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-21"></a><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-22"></a><span class="p">{</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-23"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStruct"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-24"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-25"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" -- "</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-26"></a>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-27"></a>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<a name="rest_code_55bc6020cf7c4f8bbe64ebab9789023e-28"></a><span class="p">}</span>
</pre>
<p><a class="reference external" href="http://coliru.stacked-crooked.com/a/c7deb3df49bebd40">Ejecutando el código sin la directiva pragma</a>, tenemos que nuestra estructura ocupa 8 bytes en lugar de 5 bytes.</p>
<pre class="code bash"><a name="rest_code_baa33d25ee924774974f3cc29f3cad10-1"></a>SampleStruct
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-2"></a>flag: <span class="m">1</span> Bytes
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-3"></a>+
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-4"></a>timeout: <span class="m">4</span> <span class="nv">Bytes</span>
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-5"></a><span class="o">=</span>
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-6"></a><span class="m">5</span> Bytes
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-7"></a>sizeof struct:  <span class="m">8</span> Bytes
<a name="rest_code_baa33d25ee924774974f3cc29f3cad10-8"></a>--
</pre>
<div class="admonition tip">
<p class="first admonition-title">Consejo</p>
<p class="last">Si queremos conocer el tamaño exacto de las estructuras que vamos a utilizar, tenemos que especificar al compilador la forma de alinear la estructura en memoria, para ello utilizaremos la directiva <code>#pragma pack(n)</code>.</p>
</div>
</div>
<div class="section" id="la-directiva-pragma-pack-en-struct-c">
<h2><a class="toc-backref" href="#id2">La directiva #pragma pack en struct C++</a></h2>
<p>Se trata de una directiva del preprocesador que indica al compilador cómo debe realizar la alineación de la memoria. Vamos a ver como se comporta con un ejemplo:</p>
<pre class="code c++"><a name="rest_code_6ea44a978eff43928813f0f1440ad591-1"></a><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-2"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-3"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-4"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-5"></a><span class="k">static</span> <span class="kt">void</span> <span class="nf">print</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">sz</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_flag</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_timeout</span><span class="p">)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-6"></a><span class="p">{</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-7"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" flag: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-8"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" +"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-9"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" timeout: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">&lt;&lt;</span> <span class="s">"Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-10"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" ="</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-11"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">+</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">"Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-12"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" sizeof struct:  "</span> <span class="o">&lt;&lt;</span> <span class="n">sz</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-13"></a><span class="p">}</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-14"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-15"></a><span class="cp">#pragma pack (1)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-16"></a><span class="k">struct</span> <span class="n">SampleStructPack1</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-17"></a><span class="p">{</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-18"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-19"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-20"></a><span class="p">};</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-21"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-22"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-23"></a><span class="cp">#pragma pack (2)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-24"></a><span class="k">struct</span> <span class="n">SampleStructPack2</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-25"></a><span class="p">{</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-26"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-27"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-28"></a><span class="p">};</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-29"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-30"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-31"></a><span class="cp">#pragma pack (4)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-32"></a><span class="k">struct</span> <span class="n">SampleStructPack4</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-33"></a><span class="p">{</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-34"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-35"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-36"></a><span class="p">};</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-37"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-38"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-39"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-40"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-41"></a><span class="p">{</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-42"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-43"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-44"></a><span class="p">};</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-45"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-46"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-47"></a><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-48"></a><span class="p">{</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-49"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-50"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack1"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-51"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack1</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack1</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack1</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-52"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" -- "</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-53"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-54"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack2"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-55"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack2</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack2</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack2</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-56"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-57"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack4"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-58"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack4</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack4</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack4</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-59"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-60"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStruct"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-61"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-62"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" -- "</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-63"></a>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-64"></a>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<a name="rest_code_6ea44a978eff43928813f0f1440ad591-65"></a><span class="p">}</span>
</pre>
<p><a class="reference external" href="http://coliru.stacked-crooked.com/a/7c18ee6585e57366">Ejecutando el código con las directivas pragma</a>, tenemos distintos resultados dependiendo del valor de pragma.</p>
<pre class="code bash"><a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-1"></a>SampleStructPack1
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-2"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-3"></a> +
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-4"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-5"></a> <span class="o">=</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-6"></a> 5Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-7"></a> sizeof struct:  <span class="m">5</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-8"></a> --
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-9"></a>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-10"></a>SampleStructPack2
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-11"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-12"></a> +
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-13"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-14"></a> <span class="o">=</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-15"></a> 5Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-16"></a> sizeof struct:  <span class="m">6</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-17"></a>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-18"></a>SampleStructPack4
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-19"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-20"></a> +
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-21"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-22"></a> <span class="o">=</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-23"></a> 5Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-24"></a> sizeof struct:  <span class="m">8</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-25"></a>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-26"></a>SampleStruct
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-27"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-28"></a> +
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-29"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-30"></a> <span class="o">=</span>
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-31"></a> 5Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-32"></a> sizeof struct:  <span class="m">8</span> Bytes
<a name="rest_code_b6f1d1778b33456fab5bdd9800886bed-33"></a> --
</pre>
<p>Veamos caso por caso:</p>
<dl class="docutils">
<dt>SampleStructPack1 <code>#pragma pack (1)</code>
</dt>
<dd>Reserva bloques de memoria de un byte, nuestra estructura se ha ajustado perfectamente; en este caso sí que <code>4 + 1 = 5</code>.</dd>
<dt>SampleStructPack2 <code>#pragma pack (2)</code>
</dt>
<dd>Ahora el mínimo tamaño del bloque de memoria es de 2 bytes. Para el entero, hay un ajuste exacto porque necesita 2 bloques que 2 bytes para alojar sus 4 bytes.
Para el caso del booleano, necesita un bloque de 1 byte, pero como mínimo tiene que asignar un bloque de 2 bytes, por eso en total reserva 6 bytes, <code>4 + 2 = 6</code>.</dd>
<dt>SampleStructPack4 <code>#pragma pack (4)</code>
</dt>
<dd>Es el mismo caso que el anterior, aunque  en el caso del booleano, hay un mayor "desperdicio" de memoria. Necesita 1 byte, pero reserva 4 bytes que es tamaño mínimo de bloque de memoria que puede asignar el compilador.</dd>
<dt>SampleStruct (alineación por defecto del compilador)</dt>
<dd>Como vemos se comporta exactamente igual que <code>#pragma pack (4)</code>, podemos deducir que la alineación por defecto del compilador que estamos utilizando es de 4 bytes.</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Importante</p>
<p>¿Por qué no utilizamos siempre la alineación de memoria más ajustada (<code>#pragma pack (1)</code>) para aprovechar mejor la memoria?</p>
<div class="admonition warning last">
<p class="first admonition-title">Advertencia</p>
<p class="last">Porque perderemos rendimiento.</p>
</div>
</div>
</div>
<div class="section" id="rendimiento">
<h2><a class="toc-backref" href="#id3">Rendimiento</a></h2>
<p>Vamos a hacer una prueba simple de rendimiento, en la que se va a reservar el mismo número de elementos en arrays para cada tipo de estructura.</p>
<p>Este es el resultado:</p>
<pre class="code bash"><a name="rest_code_18ac92ce4c00471d97a88062b254a833-1"></a>SampleStructPack1: <span class="m">500000000000000000</span> bytes allocated in <span class="m">94311</span> nanoseconds
<a name="rest_code_18ac92ce4c00471d97a88062b254a833-2"></a>SampleStructPack2: <span class="m">600000000000000000</span> bytes allocated in <span class="m">1777</span> nanoseconds
<a name="rest_code_18ac92ce4c00471d97a88062b254a833-3"></a>SampleStructPack4: <span class="m">800000000000000000</span> bytes allocated in <span class="m">1519</span> nanoseconds
</pre>
<p>Como vemos cuanto más ajustada es la alineación de memoria, más tiempo se tarda en reservar y liberar. Puedes <a class="reference external" href="http://coliru.stacked-crooked.com/a/954ad542659c7591">ejecutar la prueba de rendimiento en este enlace</a>.</p>
<p>A continuación pego el código de la prueba de rendimiento.</p>
<pre class="code c++"><a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-1"></a><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-2"></a><span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp"></span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-3"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-4"></a><span class="cp">#pragma pack (1)</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-5"></a><span class="k">struct</span> <span class="n">SampleStructPack1</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-6"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-7"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-8"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-9"></a><span class="p">};</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-10"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-11"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-12"></a><span class="cp">#pragma pack (2)</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-13"></a><span class="k">struct</span> <span class="n">SampleStructPack2</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-14"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-15"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-16"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-17"></a><span class="p">};</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-18"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-19"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-20"></a><span class="cp">#pragma pack (4)</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-21"></a><span class="k">struct</span> <span class="n">SampleStructPack4</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-22"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-23"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-24"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-25"></a><span class="p">};</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-26"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-27"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-28"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-29"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-30"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-31"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-32"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-33"></a><span class="p">};</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-34"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-35"></a><span class="k">static</span> <span class="k">const</span> <span class="kt">long</span> <span class="n">MAX_ELEMENTS</span> <span class="o">=</span> <span class="mi">100000000000000000</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-36"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-37"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-38"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-39"></a><span class="kt">void</span> <span class="nf">allocate1</span><span class="p">()</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-40"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-41"></a>    <span class="n">SampleStructPack1</span> <span class="n">elements</span> <span class="p">[</span><span class="n">MAX_ELEMENTS</span><span class="p">];</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-42"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack1: "</span> <span class="o">&lt;&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" bytes allocated"</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-43"></a><span class="p">}</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-44"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-45"></a><span class="kt">void</span> <span class="nf">allocate2</span><span class="p">()</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-46"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-47"></a>    <span class="n">SampleStructPack2</span> <span class="n">elements</span> <span class="p">[</span><span class="n">MAX_ELEMENTS</span><span class="p">];</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-48"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack2: "</span> <span class="o">&lt;&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" bytes allocated"</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-49"></a><span class="p">}</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-50"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-51"></a><span class="kt">void</span> <span class="nf">allocate4</span><span class="p">()</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-52"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-53"></a>    <span class="n">SampleStructPack4</span> <span class="n">elements</span> <span class="p">[</span><span class="n">MAX_ELEMENTS</span><span class="p">];</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-54"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack4: "</span> <span class="o">&lt;&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" bytes allocated"</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-55"></a><span class="p">}</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-56"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-57"></a><span class="kt">void</span> <span class="nf">chrono1</span><span class="p">()</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-58"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-59"></a>    <span class="k">auto</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-60"></a>    <span class="n">allocate1</span><span class="p">();</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-61"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" in "</span> <span class="o">&lt;&lt;</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" nanoseconds"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-62"></a><span class="p">}</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-63"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-64"></a><span class="kt">void</span> <span class="nf">chrono2</span><span class="p">()</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-65"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-66"></a>    <span class="k">auto</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-67"></a>    <span class="n">allocate2</span><span class="p">();</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-68"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" in "</span> <span class="o">&lt;&lt;</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" nanoseconds"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-69"></a><span class="p">}</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-70"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-71"></a><span class="kt">void</span> <span class="nf">chrono4</span><span class="p">()</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-72"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-73"></a>    <span class="k">auto</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-74"></a>    <span class="n">allocate4</span><span class="p">();</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-75"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" in "</span> <span class="o">&lt;&lt;</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" nanoseconds"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-76"></a><span class="p">}</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-77"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-78"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-79"></a><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-80"></a><span class="p">{</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-81"></a>    <span class="n">chrono1</span><span class="p">();</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-82"></a>    <span class="n">chrono2</span><span class="p">();</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-83"></a>    <span class="n">chrono4</span><span class="p">();</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-84"></a>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-85"></a>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<a name="rest_code_723fa0ec6148497e8ed4fb8c801558bc-86"></a><span class="p">}</span>
</pre>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/c%2B%2B/" rel="tag">C++</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../git-proxy-config/" rel="prev" title="Configuración de proxy para Git">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../debug-libtool-lib/" rel="next" title="Depurar librería generada con libtool">Siguiente publicación</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comentarios</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="carlosvin",
            disqus_url="https://carlosvin.github.io/es/posts/cpp-pragma-pack/",
        disqus_title="Alineaci\u00f3n de una Estructura C++ en Memoria",
        disqus_identifier="cache/posts/cpp-pragma-pack.en.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="carlosvin";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer"><div style="display=flex-inline; vertical-align=middle">
        <a href="https://www.linkedin.com/in/carlosvin" style="margin-right: 3%;">Carlos Martín Sánchez</a>
        <a href="https://twitter.com/carlosvin" class="twitter-follow-button" style="float: right;" data-show-count="false">Follow @carlosvin</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
    <br>
    Contents © 2018 - 
    
   <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
   <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a> - 
    Powered by <a href="http://getnikola.com" rel="nofollow">Nikola</a>
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><script src="../../../assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1328360-9', 'carlosvin.github.io');
  ga('send', 'pageview');

</script><!-- Start of StatCounter Code for Default Guide --><script type="text/javascript">
var sc_project=9708205;
var sc_invisible=1;
var sc_security="4998d447";
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script><noscript><div class="statcounter"><a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="http://c.statcounter.com/9708205/0/4998d447/1/" alt="web analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->


</body>
</html>
