<!DOCTYPE html>
<html lang="en">

<head>
  
  
  
  <title>Isolated Integration Tests with pytest-scenarios</title>

  
  
  
  <meta name="description" content="Use pytest-scenarios to create isolated integration test data that cleans itself up automatically.">
  
  <meta name="keywords" content="python,testing,pytest,mongodb,integration-testing">
  
  <meta name="robots" content="index, follow">


  <!-- Meta tags and OpenGraph metadata for SEO, social sharing, and browser configuration -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Carlos Martin Sanchez">
  
  <link rel="alternate" type="application/rss+xml" title="RSS"
    href="https://carlosvin.github.io/rss.xml">
  

  




<meta property="og:title" content="Isolated Integration Tests with pytest-scenarios">
<meta property="og:description" content="Use pytest-scenarios to create isolated integration test data that cleans itself up automatically.">




<link rel="canonical" href="https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;">
<meta property="og:url" content="https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;">


<meta property="og:type" content="article">


<meta property="og:site_name" content="My software engineering journey">


<meta property="og:locale" content="en_US">



<meta property="article:published_time" content="2026-01-03T00:00:00Z">





<meta property="article:tag" content="python">

<meta property="article:tag" content="testing">

<meta property="article:tag" content="pytest">

<meta property="article:tag" content="mongodb">

<meta property="article:tag" content="integration-testing">






<meta property="og:image" content="&#x2F;img&#x2F;android-chrome-192x192.png">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Isolated Integration Tests with pytest-scenarios">
<meta name="twitter:description" content="Use pytest-scenarios to create isolated integration test data that cleans itself up automatically.">

<meta name="twitter:image" content="&#x2F;img&#x2F;android-chrome-192x192.png">


  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#website",
      "url": "https:&#x2F;&#x2F;carlosvin.github.io",
      "name": "My software engineering journey",
      "description": "Documenting a personal journey through software engineering, AI, and programming. This blog features deep dives, practical guides, and recent learnings for both seasoned and aspiring developers.",
      "publisher": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#person"
      },
      "potentialAction": [
        {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https:&#x2F;&#x2F;carlosvin.github.io/search?q={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        }
      ]
    },
    {
      "@type": "Person",
      "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#person",
      "name": "Carlos Martin Sanchez",
      "url": "https:&#x2F;&#x2F;carlosvin.github.io",
      "sameAs": [
        
      ]
    },
    
    {
      "@type": "BlogPosting",
      "@id": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;/#article",
      "isPartOf": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#website"
      },
      "author": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#person"
      },
      "headline": "Isolated Integration Tests with pytest-scenarios",
      "description": "Use pytest-scenarios to create isolated integration test data that cleans itself up automatically.",
      "datePublished": "2026-01-03T00:00:00Z",
      "dateModified": "2026-01-03T00:00:00Z",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;"
      },
      "url": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;",
      "image": "&#x2F;img&#x2F;android-chrome-192x192.png",
      "publisher": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#person"
      },
      "articleSection": "Blog",
      "keywords": [
        "python",
        "testing",
        "pytest",
        "mongodb",
        "integration-testing"
        
      ],
      "inLanguage": "en",
      "wordCount": 376,
      "copyrightYear": 2026,
      "copyrightHolder": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#person"
      }
    },
    {
      "@type": "WebPage",
      "@id": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;",
      "url": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;",
      "name": "Isolated Integration Tests with pytest-scenarios",
      "isPartOf": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io/#website"
      },
      "about": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;/#article"
      },
      "description": "Use pytest-scenarios to create isolated integration test data that cleans itself up automatically.",
      "breadcrumb": {
        "@id": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;/#breadcrumb"
      },
      "inLanguage": "en",
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": ["https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;"]
        }
      ]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;/#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https:&#x2F;&#x2F;carlosvin.github.io"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Isolated Integration Tests with pytest-scenarios",
          "item": "https:&#x2F;&#x2F;carlosvin.github.io&#x2F;pytest-scenarios-isolated-integration-tests&#x2F;"
        }
        ]
    }
    
  ]
}
</script>

  <!-- Links to files -->
  <link rel="stylesheet" href="https://carlosvin.github.io/css/base.css" rel=preconnect>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.lime.min.css" rel=preconnect>

  <!-- Favicons -->
  <link rel="icon" href="https://carlosvin.github.io/img/favicon.ico" sizes="any">
  <link rel="icon" href="https://carlosvin.github.io/img/favicon-32x32.png" sizes="32x32" type="image/png">
  <link rel="icon" href="https://carlosvin.github.io/img/android-chrome-192x192.png" sizes="192x192" type="image/png">
  <link rel="apple-touch-icon" href="https://carlosvin.github.io/img/apple-touch-icon.png">

  <link rel="manifest" href="https://carlosvin.github.io/manifest.json"> <!-- Scripts -->
  <script type="speculationrules">
    {
    "prerender": [
        {
        "where": {
            "selector_matches": "a"
        }
        }
    ]
    }
  </script>
  <script type="text/javascript">
    (function (c, l, a, r, i, t, y) {
      c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
      t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
      y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
    })(window, document, "clarity", "script", "58k0hy1db4");
  </script>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="b33a381d-0843-4a11-b306-74c285c39206"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"
    integrity="sha512-0QarUp4p9r5IqUgSRyP89BHga45OpEd7VR8lbRkJkf48p/EhcU742fWUpKpoDyu9N6XYAEq/vz6m6z1OolnsDw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" defer async></script>
  <script src="https://cdn.jsdelivr.net/npm/theme-change@2.5.0/index.js"></script>
</head>

<body class="container">
  <header>
    <nav>
  <ul>
    <li>
      <details class="dropdown">
        <summary role="button" class="outline"><img src="https://carlosvin.github.io/img/android-chrome-192x192.png"
            alt="Menu" style="height:2rem;vertical-align:middle;border-radius:8px;"></summary>
        <ul>
          
          <li><a href="https://carlosvin.github.io/about">About</a></li>
          
          <li><a href="https://carlosvin.github.io/tags">Tags</a></li>
          <li>
            <label>
              Dark
              <input type="checkbox" data-toggle-theme="dark,light" role="switch">
            </label>
          </li>
        </ul>
      </details>
    </li>
    <li>
      <a href="https://carlosvin.github.io">My software engineering journey</a>
    </li>
  </ul>
  <ul>
    <li>
      <input id="search" type="search" placeholder="Search the posts" aria-label="Search">
    </li>
  </ul>

</nav>
    <div class="search-container">
      <div class="search-results">
        <div class="search-results__items"></div>
      </div>
    </div>
  </header>

  <main>
    
<article class="post">
  <header>
    <hgroup>
      <h1>Isolated Integration Tests with pytest-scenarios</h1>
      <p>
        

<time datetime="2026-01-03">
    January 03, 2026
</time>
‚Ä¢ <time datetime="PT2M">2 min read</time> ‚Ä¢ <data
    value="376">376 words</data>
      </p>
      


<span class="tags">
    
    
    <small>
        <a href='https://carlosvin.github.io/tags/python/' title="All the posts in python"
            role="button" class="secondary outline">
            python
            
        </a>
    </small>
    
    
    <small>
        <a href='https://carlosvin.github.io/tags/testing/' title="All the posts in testing"
            role="button" class="secondary outline">
            testing
            
        </a>
    </small>
    
    
    <small>
        <a href='https://carlosvin.github.io/tags/pytest/' title="All the posts in pytest"
            role="button" class="secondary outline">
            pytest
            
        </a>
    </small>
    
    
    <small>
        <a href='https://carlosvin.github.io/tags/mongodb/' title="All the posts in mongodb"
            role="button" class="secondary outline">
            mongodb
            
        </a>
    </small>
    
    
    <small>
        <a href='https://carlosvin.github.io/tags/integration-testing/' title="All the posts in integration-testing"
            role="button" class="secondary outline">
            integration-testing
            
        </a>
    </small>
    
</span>

    </hgroup>
  </header>

  
<aside class="sidebar">
  <details class="dropdown">
    <summary role="button" class="secondary">üìë Contents</summary>
    <ul>
      
      <li>
        <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#the-problem">The Problem</a>
        
      </li>
      
      <li>
        <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#the-solution-declarative-test-scenarios">The Solution: Declarative Test Scenarios</a>
        
      </li>
      
      <li>
        <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#key-concepts">Key Concepts</a>
        
        <ul>
          
          <li>
            <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#templates-define-defaults">Templates Define Defaults</a>
          </li>
          
          <li>
            <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#automatic-cleanup">Automatic Cleanup</a>
          </li>
          
          <li>
            <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#real-database-testing">Real Database Testing</a>
          </li>
          
        </ul>
        
      </li>
      
      <li>
        <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#try-it-yourself">Try It Yourself</a>
        
        <ul>
          
          <li>
            <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#quick-start">Quick Start</a>
          </li>
          
        </ul>
        
      </li>
      
      <li>
        <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#installation">Installation</a>
        
      </li>
      
      <li>
        <a href="https://carlosvin.github.io/pytest-scenarios-isolated-integration-tests/#learn-more">Learn More</a>
        
      </li>
      
    </ul>
  </details>
</aside>


  <section class="post-content">
    <p>Integration tests are essential for catching bugs that unit tests miss‚Äîbut they come with a notorious problem: <strong>shared state</strong>. When tests share a database, they become flaky, order-dependent, and painful to debug.</p>
<p>What if each test could start with a clean slate, with exactly the data it needs, without manual cleanup or complex fixtures?</p>
<p>That's what <a href="https://github.com/carlosvin/pytest-scenarios"><code>pytest-scenarios</code></a> does.</p>
<h2 id="the-problem">The Problem</h2>
<p>Consider testing an e-commerce checkout system. You need to verify that:</p>
<ul>
<li>Active customers can complete orders</li>
<li>Suspended customers are rejected</li>
<li>Out-of-stock items fail gracefully</li>
</ul>
<p>Each scenario requires different data. With traditional approaches, you either share fixtures (tests interfere), manually clean up (boilerplate hell), or use transaction rollbacks (complex and misses commit-time bugs).</p>
<h2 id="the-solution-declarative-test-scenarios">The Solution: Declarative Test Scenarios</h2>
<p>With <code>pytest-scenarios</code>, you declare <em>what state you need</em>, and the plugin handles the rest:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_checkout_rejects_suspended_customer</span><span>(</span><span style="color:#bf616a;">scenario_builder</span><span>, </span><span style="color:#bf616a;">db</span><span>):
</span><span>    </span><span style="color:#65737e;"># Arrange: Declare the scenario
</span><span>    scenario_builder.</span><span style="color:#bf616a;">create</span><span>({
</span><span>        &quot;</span><span style="color:#a3be8c;">customers</span><span>&quot;: [{&quot;</span><span style="color:#a3be8c;">customer_id</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">user_1</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">status</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">suspended</span><span>&quot;}],
</span><span>        &quot;</span><span style="color:#a3be8c;">products</span><span>&quot;: [{&quot;</span><span style="color:#a3be8c;">product_id</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">item_1</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">in_stock</span><span>&quot;: </span><span style="color:#d08770;">True</span><span>}],
</span><span>        &quot;</span><span style="color:#a3be8c;">orders</span><span>&quot;: [{&quot;</span><span style="color:#a3be8c;">id</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">order_1</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">customer_id</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">user_1</span><span>&quot;, </span><span style="color:#d08770;">...</span><span>}],
</span><span>    })
</span><span>
</span><span>    </span><span style="color:#65737e;"># Act: Run your business logic
</span><span>    checkout = </span><span style="color:#bf616a;">Checkout</span><span>(db)
</span><span>    result = checkout.</span><span style="color:#bf616a;">process</span><span>(</span><span style="color:#bf616a;">order_id</span><span>=&quot;</span><span style="color:#a3be8c;">order_1</span><span>&quot;)
</span><span>
</span><span>    </span><span style="color:#65737e;"># Assert: Verify the outcome
</span><span>    </span><span style="color:#b48ead;">assert </span><span>result.success is </span><span style="color:#d08770;">False
</span><span>    </span><span style="color:#b48ead;">assert </span><span>&quot;</span><span style="color:#a3be8c;">not active</span><span>&quot; in result.error
</span></code></pre>
<p>No manual cleanup. No fixture dependencies. Each test is completely isolated.</p>
<h2 id="key-concepts">Key Concepts</h2>
<h3 id="templates-define-defaults">Templates Define Defaults</h3>
<p>Define templates with sensible defaults‚Äîtests only override what matters:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># tests/templates/customers.py
</span><span style="color:#bf616a;">TEMPLATE </span><span>= {
</span><span>    &quot;</span><span style="color:#a3be8c;">name</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">John Doe</span><span>&quot;,
</span><span>    &quot;</span><span style="color:#a3be8c;">email</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">john.doe@example.test</span><span>&quot;,
</span><span>    &quot;</span><span style="color:#a3be8c;">status</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">active</span><span>&quot;,
</span><span>}
</span></code></pre>
<h3 id="automatic-cleanup">Automatic Cleanup</h3>
<p>The plugin clears all managed collections <em>before each test</em>. Even if a test fails, the next test starts fresh.</p>
<h3 id="real-database-testing">Real Database Testing</h3>
<p>Tests run against a real MongoDB instance, catching issues that mocks would miss: query errors, index problems, schema mismatches.</p>
<h2 id="try-it-yourself">Try It Yourself</h2>
<p>I've created a complete runnable example that demonstrates <code>pytest-scenarios</code> with a simple e-commerce checkout system.</p>
<p>üëâ <strong><a href="https://github.com/carlosvin/pytest-scenarios/tree/main/examples">View the example on GitHub</a></strong></p>
<p>The example includes:</p>
<ul>
<li>A <a href="https://github.com/carlosvin/pytest-scenarios/blob/main/examples/src/checkout.py"><code>Checkout</code> class</a> with real business logic</li>
<li><a href="https://github.com/carlosvin/pytest-scenarios/blob/main/examples/tests/integration/test_checkout.py">Integration tests</a> covering happy paths and edge cases</li>
<li><a href="https://github.com/carlosvin/pytest-scenarios/tree/main/examples/tests/templates">Templates</a> for customers, products, and orders</li>
</ul>
<h3 id="quick-start">Quick Start</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">git</span><span> clone https://github.com/carlosvin/pytest-scenarios.git
</span><span style="color:#96b5b4;">cd</span><span> pytest-scenarios/examples
</span></code></pre>
<p>Then follow the instructions in the <a href="https://github.com/carlosvin/pytest-scenarios/blob/main/examples/README.md">example README</a> to run the tests.</p>
<h2 id="installation">Installation</h2>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">pip</span><span> install pytest-scenarios
</span><span style="color:#65737e;"># or
</span><span style="color:#bf616a;">uv</span><span> add pytest-scenarios
</span></code></pre>
<p>Configure in <code>pyproject.toml</code>:</p>
<pre data-lang="toml" style="background-color:#2b303b;color:#c0c5ce;" class="language-toml "><code class="language-toml" data-lang="toml"><span>[tool.pytest.ini_options]
</span><span style="color:#bf616a;">db-url </span><span>= &quot;</span><span style="color:#a3be8c;">mongodb://127.0.0.1:27017</span><span>&quot;
</span><span style="color:#bf616a;">db-name </span><span>= &quot;</span><span style="color:#a3be8c;">my_test_db</span><span>&quot;
</span><span style="color:#bf616a;">templates-path </span><span>= &quot;</span><span style="color:#a3be8c;">tests/templates</span><span>&quot;
</span></code></pre>
<h2 id="learn-more">Learn More</h2>
<ul>
<li>üì¶ <a href="https://pypi.org/project/pytest-scenarios/">PyPI Package</a></li>
<li>üìÅ <a href="https://github.com/carlosvin/pytest-scenarios">GitHub Repository</a></li>
<li>üìñ <a href="https://github.com/carlosvin/pytest-scenarios/tree/main/examples">Example Project &amp; README</a></li>
</ul>
<hr />
<p>Stop fighting flaky integration tests. Let <code>pytest-scenarios</code> handle the isolation while you focus on what matters: testing your business logic.</p>

  </section>

  <footer>
    <script src="https://utteranc.es/client.js" repo="carlosvin/carlosvin.github.io" issue-term="title"
      theme="github-light" crossorigin="anonymous" async defer>
      </script>
  </footer>
</article>

  </main>

  <footer>
    <nav>
      <small>&copy; 2026 Carlos Martin Sanchez | Powered by <a
          href="https://www.getzola.org/">Zola</a>
      </small>
      <span style="display: flex; gap: 1rem; align-items: flex-end;">
  <a href="https://github.com/carlosvin" target="_blank" rel="noopener">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/github.svg" alt="GitHub" width="32"
      height="32" />
  </a>
  <a href="https://linkedin.com/in/carlosvin" target="_blank" rel="noopener">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg" alt="LinkedIn" width="32"
      height="32" />
  </a>
  <a href="https://carlosvin.github.io/atom.xml">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/rss.svg" alt="RSS" width="32" height="32">
  </a>
</span>
    </nav>
  </footer>

  <script src="https://carlosvin.github.io/js/search.js"></script>
</body>

</html>