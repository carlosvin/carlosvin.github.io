<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=sapper name=generator> <meta content=a22af7614c96254d name=yandex-verification> <link href=/icons/icon-192x192.png rel=apple-touch-icon> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.2033279305.css rel=stylesheet><link href=client/[...slug].745fcdad.css rel=stylesheet><link href=client/client.32276ee8.css rel=stylesheet><link href=client/Details.d43397fb.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Construir un proyecto C++ con Gradle</title><link href=/rss rel=alternate type=application/rss+xml title='Subscribe to Carlos says "bla bla"'><script type=application/ld+json>{
            "@context": "https://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "Webpage",
              "@id": "https://google.com/article"
            },
            "headline": "Construir un proyecto C++ con Gradle",
            "alternativeHeadline": "undefined",
            "image": "icons/icon-192x192.png",
            "datePublished": "2014-09-25",
            "dateModified": "2014-09-25",
            "keywords": "Gradle,C++,Build Software,Build System,Dependency Management",
            "author": {
              "@type": "Person",
              "name": "Carlos Martin Sanchez"
            },
            "publisher": "Carlos Martin Sanchez"
        }</script><meta content=2014-09-25 name=date scheme=YYYY-MM-DD><meta content="Cómo construir un proyecto típico C++ utilizando Gradle" name=description><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css rel=preload as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css rel=stylesheet></noscript><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-1v6ow72><button class=svelte-1v6ow72>≡</button> <ul class="svelte-1v6ow72 closed"><li class=svelte-1y8uoef><a href=. class=svelte-1y8uoef>Carlos says "bla bla"</a></li> <li class=svelte-1y8uoef><a href=categories class=svelte-1y8uoef>Categories</a></li> <li class=svelte-1y8uoef><a href=about class=svelte-1y8uoef>About</a></ul> <div class="h svelte-1w8skyw"><a href=/rss rel=noopener target=_blank class="icon svelte-1lu397 rss" title='Subscribe to Carlos says "bla bla"'></a> <a href=https://github.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 github" title="Find me at github"></a> <a href=https://twitter.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 twitter" title="Find me at twitter"></a> <a href=https://stackoverflow.com/story/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 stackoverflow" title="Find me at stackoverflow"></a></div></nav> <main class=svelte-bvcji9> <header class=svelte-1svctju><h1 class=svelte-1svctju>Construir un proyecto C++ con Gradle <span class="svelte-1svctju share"><a href="https://twitter.com/intent/tweet?url=https://carlosvin.github.io/posts/gradle-cpp/es&text=Construir un proyecto C++ con Gradle: Cómo construir un proyecto típico C++ utilizando Gradle&hashtags=Gradle,C++,Build Software,Build System,Dependency Management" rel=noopener target=_blank class="icon svelte-1lu397 twitter" title='Share "Construir un proyecto C++ con Gradle"'></a></span></h1> <p class="svelte-1svctju summary">Cómo construir un proyecto típico C++ utilizando Gradle</p> <div class="subtitle svelte-16mbbpz"><span class=date>25/09/2014</span> <span class=svelte-16xp99e><a href=categories/gradle class=svelte-1gu8b1d title=Gradle><span class="hover svelte-1x4e0dt">Gradle</span></a><a href=categories/c class=svelte-1gu8b1d title=C++><span class="hover svelte-1x4e0dt">C++</span></a><a href=categories/build-software class=svelte-1gu8b1d title="Build Software"><span class="hover svelte-1x4e0dt">Build Software</span></a><a href=categories/build-system class=svelte-1gu8b1d title="Build System"><span class="hover svelte-1x4e0dt">Build System</span></a><a href=categories/dependency-management class=svelte-1gu8b1d title="Dependency Management"><span class="hover svelte-1x4e0dt">Dependency Management</span></a></span></div></header> <div class="content svelte-1gb6nlh"><div class=toc id=toc> <div id=toctitle>Table of Contents</div> <ul class=sectlevel1> <li><a href=#_introducción>Introducción</a></li> <li><a href=#_un_caso_práctico>Un caso práctico</a> <ul class=sectlevel2> <li><a href=#_estructura_del_proyecto>Estructura del proyecto</a></li> <li><a href=#_la_aplicación_c>La Aplicación C++</a></li> <li><a href=#_construyendo_con_gradle>Construyendo con Gradle</a></li> <li><a href=#_pruébalo_tú_mism>Pruébalo tú mism@</a></li> </ul> </li> <li><a href=#_conclusiones>Conclusiones</a></li> </ul> </div> <div class=sect1> <h2 id=_introducción>Introducción</h2> <div class=sectionbody> <div class=paragraph> <p>La construcción, gestión de dependencias y distribución de mis proyectos es algo que cada vez me preocupa más, me gustaría encontrar una herramienta que unificara este proceso y fuese independiente del lenguaje, lo más parecido con lo que he trabajado ha sido <a href=https://www.scons.org rel=noopener target=_blank>SCons</a>, <a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html#Autotools-Introduction rel=noopener target=_blank>Autotools</a>, <a href=https://ant.apache.org rel=noopener target=_blank>Ant</a>, <a href=https://maven.apache.org rel=noopener target=_blank>Maven</a> y últimamente <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>.</p> </div> <div class=paragraph> <p>Llevo un tiempo haciendo algunas cosas con <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>, pero siempre centrado en proyectos <a href=https://www.java.com rel=noopener target=_blank>Java</a> <span class=line-through>utilizándolo como reemplazo a <a href=https://maven.apache.org rel=noopener target=_blank>Maven</a>, porque que es más sencillo de usar y más rápido</span>. Actualizacion 2020: <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> sigue siendo más rápido que <a href=https://maven.apache.org rel=noopener target=_blank>Maven</a>, pero al final sigo utilizando <a href=https://maven.apache.org rel=noopener target=_blank>Maven</a> para proyectos profesionales por la estabilidad de su API y sus ciclos de vida más restrictivos. También lo he utilizado en projectos <a href=https://developer.android.com/studio/build rel=noopener target=_blank>Android</a> y he sufrido <a href=https://developer.android.com/sdk/installing/studio-build.html rel=noopener target=_blank>Android Studio + Gradle</a> en sus fases tempranas, actualmente está todo mucho más documentado y funciona muy bien.</p> </div> <div class=paragraph> <p>Antes de nada hay que decir que la construcción de proyectos C/C++ y Objective-C con <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> se encuentra en fase de <a href=https://docs.gradle.org/current/userguide/feature_lifecycle.html#sec:incubating_state rel=noopener target=_blank>incubación</a>, aunque ya permite realizar algunas tareas avanzadas como:</p> </div> <div class=ulist> <ul> <li> <p>Generación de múltiples artefactos dentro del mismo proyecto, esto es varias librerías o ejecutables.</p> </li> <li> <p>Gestionar las dependencias entre estos artefactos (sin versiones).</p> </li> <li> <p>Generar distintos "sabores" de aplicaciones, por ejemplo: podremos generar una aplicación "Community" y otra con más características habilitadas llamada "Enterprise".</p> </li> <li> <p>Permite generar binarios para distintas plataformas, esto depende de las cadenas de herramientas (<a href=https://en.wikipedia.org/wiki/Toolchain rel=noopener target=_blank>Toolchain</a>) que tengamos instaladas en la máquina de compilación.</p> </li> </ul> </div> <div class=paragraph> <p>Como decía todavía tiene limitaciones, aunque están trabajando en ello <a href=https://blog.gradle.org/state-and-future-of-the-gradle-software-model#a-way-forward>si consiguen lo que tienen planeado</a>, <span class=line-through>y si lo consiguen, dejaré <a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html#Autotools-Introduction rel=noopener target=_blank>Autotools</a> (me arrepentiré de haber dicho esto)</span>. Actualización 2000: Realmente, unos años más tarde, no estoy utilizando <a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html#Autotools-Introduction rel=noopener target=_blank>Autotools</a> ni tampoco <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>, estoy usando <a href=https://mesonbuild.com/ >Meson</a> y considerando <a href=https://docs.bazel.build/versions/master/tutorial/cpp.html>Bazel</a>.</p> </div> </div> </div> <div class=sect1> <h2 id=_un_caso_práctico>Un caso práctico</h2> <div class=sectionbody> <div class=paragraph> <p>Básicamente he sacado todo el ejemplo de <a href=https://docs.gradle.org/current/userguide/native_software.html>la guia de construcción de software native de Gradle</a> y lo he adaptado a un caso en el que hay varias plataformas y quiero generar dos versiones distintas de mi software "Community" y "Enterprise".</p> </div> <div class=paragraph> <p>La aplicación es un ejecutable y una librería dinámica. El ejecutable hace uso de esta librería. Ya está, solo quiero mostrar lo que nos permite hacer <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>.</p> </div> <div class=paragraph> <p>También nos permitirá generar una versión para distribuir (producción) y otra para depurar (desarrollo).</p> </div> <div class=paragraph> <p>Todo el código se encuentra en <a href=https://github.com/carlosvin/cpp_gradle class=bare>https://github.com/carlosvin/cpp_gradle</a>.</p> </div> <div class=sect2> <h3 id=_estructura_del_proyecto>Estructura del proyecto</h3> <div class=paragraph> <p>Podemos crear la estructura que queramos, pero resulta más fácil seguir la que recomienda <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>, para no tener que especificar donde está el código fuente. Ésta es la estructura del proyecto:</p> </div> <div class=dlist> <dl> <dt class=hdlist1>gradle-cpp</dt> <dd> <p>Directorio raíz.</p> <div class=dlist> <dl> <dt class=hdlist1>build.gradle</dt> <dd> <p>Fichero donde se configura el proyecto <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>, el equivalente al build.xml de <a href=https://ant.apache.org rel=noopener target=_blank>Ant</a>, al <a href=https://www.gnu.org/software/make/manual/html_node/Makefiles.html: rel=noopener target=_blank>Makefile</a> de C/C++ o al pom.xml de <a href=https://maven.apache.org rel=noopener target=_blank>Maven</a>.</p> </dd> <dt class=hdlist1>src</dt> <dd> <p>Carpeta donde va todo el código fuente</p> <div class=dlist> <dl> <dt class=hdlist1>hello</dt> <dd> <p>Carpeta que contiene el módulo que va a ser la librería hello.</p> </dd> </dl> </div> </dd> <dt class=hdlist1>cpp</dt> <dd> <p>Carpeta donde van los fuentes C++.</p> <div class=dlist> <dl> <dt class=hdlist1>Hello.cpp</dt> <dd> <p> Implementación de la clase Hello.</p> </dd> </dl> </div> </dd> <dt class=hdlist1>headers</dt> <dd> <p>Carpeta donde van los ficheros de cabeceras. Hello.h:::: Declaración de la Clase Hello.</p> <div class=dlist> <dl> <dt class=hdlist1>Msg.h</dt> <dd> <p>Declaración de constantes.</p> </dd> </dl> </div> </dd> </dl> </div> </dd> <dt class=hdlist1>main</dt> <dd> <p>Carpeta que contiene el módulo que será el ejecutable que utilice la librería hello.</p> <div class=dlist> <dl> <dt class=hdlist1>cpp</dt> <dd> <p>Carpeta donde van los fuentes C++.</p> <div class=dlist> <dl> <dt class=hdlist1>main.cpp</dt> <dd> <p>Código fuente con la función main.</p> </dd> </dl> </div> </dd> <dt class=hdlist1>build</dt> <dd> <p>Carpeta que crea Gradle automáticamente donde deja todos los resultados sus ejecuciones, en ella encontraremos informes de resultados de pruebas, binarios compilados, paquetes para distribuir, etc.</p> </dd> </dl> </div> </dd> </dl> </div> </div> <div class=sect2> <h3 id=_la_aplicación_c>La Aplicación C++</h3> <div class=paragraph> <p>Va a consistir en un ejecutable que hará uso de la funcionalidad de la librería ’hello’.</p> </div> <div class=listingblock> <div class=title>main.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Hello.h"</span></span>
<span class=hljs-function><span class=hljs-keyword>int</span> <span class=hljs-title>main</span><span class=hljs-params>(<span class=hljs-keyword>int</span> argc, <span class=hljs-keyword>char</span> ** argv)</span>
</span>{
    <span class=hljs-function>Hello <span class=hljs-title>hello</span> <span class=hljs-params>(<span class=hljs-string>"Pepito"</span>)</span></span>;
    hello.sayHello(<span class=hljs-number>10</span>);
    <span class=hljs-keyword>return</span> <span class=hljs-number>0</span>;
}</code></pre> </div> </div> <div class=paragraph> <p>Esta librería permite saludar `n`<sup class=footnote>[<a href=#_footnotedef_1 class=footnote title="View footnote." id=_footnoteref_1>1</a>]</sup> veces a una persona especificada en su constructor.</p> </div> <div class=listingblock> <div class=title>Hello.h</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>Hello</span>
{</span>
    <span class=hljs-keyword>private</span>:
        <span class=hljs-keyword>const</span> <span class=hljs-keyword>char</span> * who;
    <span class=hljs-keyword>public</span>:
        Hello(<span class=hljs-keyword>const</span> <span class=hljs-keyword>char</span> * who);
        <span class=hljs-function><span class=hljs-keyword>void</span> <span class=hljs-title>sayHello</span><span class=hljs-params>(<span class=hljs-keyword>unsigned</span> n = <span class=hljs-number>1</span>)</span></span>;
};</code></pre> </div> </div> </div> <div class=sect2> <h3 id=_construyendo_con_gradle>Construyendo con Gradle</h3> <div class=sect3> <h4 id=_caso_básico>Caso básico</h4> <div class=paragraph> <p>Lo único que necesitamos para construir nuestra aplicación con <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> es: tener <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a><sup class=footnote>[<a href=#_footnotedef_2 class=footnote title="View footnote." id=_footnoteref_2>2</a>]</sup> y el fichero <code>build.gradle</code>.</p> </div> <div class=listingblock> <div class=title>build.gradle</div> <div class=content> <pre class=highlight><code class=language-groovy data-lang=groovy>apply <span class=hljs-string>plugin:</span> <span class=hljs-string>'cpp'</span>

model {
  components {
    hello(NativeLibrarySpec) {}
    main(NativeExecutableSpec) {
      binaries.all {
        lib <span class=hljs-string>library:</span> <span class=hljs-string>"hello"</span>
      }
    }
  }
}</code></pre> </div> </div> <div class=paragraph> <p>Con este fichero tan simple, conseguiremos compilar e instalar nuestra aplicación, en modo Debug para la plataforma donde estamos ejecutando <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>, en mi caso es Linux X64.</p> </div> <div class=paragraph> <p>Si ejecutamos desde la raíz de nuestro proyecto <code>gradle task</code>, podremos ver todas las tareas que podemos hacer.</p> </div> <div class=paragraph> <p>En nuestro caso, solo queremos nuestra aplicación compilada y lista para funcionar, así que ejecutaremos: <code>gradle installMainExecutable</code>.</p> </div> <div class=paragraph> <p>Una vez que ha terminado, podemos ejecutar el programa llamando al script `build/install/mainExecutable/main`<sup class=footnote>[<a href=#_footnotedef_3 class=footnote title="View footnote." id=_footnoteref_3>3</a>]</sup>.</p> </div> <div class=listingblock> <div class=title>Output</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>$ build/install/mainExecutable/main
1.  Hello Mr. Pepito (Community)
2.  Hello Mr. Pepito (Community)
3.  Hello Mr. Pepito (Community)
4.  Hello Mr. Pepito (Community)
5.  Hello Mr. Pepito (Community)
6.  Hello Mr. Pepito (Community)
7.  Hello Mr. Pepito (Community)
8.  Hello Mr. Pepito (Community)
9.  Hello Mr. Pepito (Community)
10. Hello Mr. Pepito (Community)</code></pre> </div> </div> </div> <div class=sect3> <h4 id=_distintos_sabores>Distintos “Sabores”</h4> <div class=paragraph> <p>Con unas pocas líneas más, podemos generar distintas versiones de la misma aplicación, en nuestro ejemplo vamos a generar una versión “Community” y otra “Enterprise”.</p> </div> <div class=listingblock> <div class=title>build.gradle</div> <div class=content> <pre class=highlight><code class=language-groovy data-lang=groovy>apply <span class=hljs-string>plugin:</span> <span class=hljs-string>'cpp'</span>

model {
  flavors {
      community
      enterprise
  }

  components {
    hello(NativeLibrarySpec) {
      binaries.all {
        <span class=hljs-keyword>if</span> (flavor == flavors.enterprise) {
          cppCompiler.define <span class=hljs-string>"ENTERPRISE"</span>
        }
      }
    }
    main(NativeExecutableSpec) {
      binaries.all {
        lib <span class=hljs-string>library:</span> <span class=hljs-string>"hello"</span>
        }
    }
  }
}</code></pre> </div> </div> <div class=paragraph> <p>Además tenemos que preparar nuestra aplicación para utilizar estos parámetros de compilación.</p> </div> <div class=listingblock> <div class=title>Msg.h</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>ifdef</span> ENTERPRISE</span>
<span class=hljs-keyword>static</span> <span class=hljs-keyword>const</span> <span class=hljs-keyword>char</span> * EDITION = <span class=hljs-string>"Enterprise"</span>;

<span class=hljs-meta>#<span class=hljs-meta-keyword>else</span></span>
<span class=hljs-keyword>static</span> <span class=hljs-keyword>const</span> <span class=hljs-keyword>char</span> * EDITION = <span class=hljs-string>"Community"</span>;

<span class=hljs-meta>#<span class=hljs-meta-keyword>endif</span></span></code></pre> </div> </div> <div class=paragraph> <p>De esta forma se utiliza una cadena u otra en función del “sabor” con que compilemos.</p> </div> <div class=paragraph> <p>Si ahora ejecutamos <code>gradle clean task</code> en la raíz de nuestro proyecto, veremos que tenemos más tareas disponibles, antes teníamos <code>installMainExecutable</code> y ahora ha sido reemplazada por <code>installCommunityMainExecutable</code> y <code>installEnterpriseMainExecutable</code>.</p> </div> <div class=paragraph> <p>Si ejecutamos estas dos tareas, tendremos nuestra aplicación instalada en los dos sabores.</p> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash><span class=hljs-variable>$gradle</span> installEnterpriseMainExecutable installCommunityMainExecutable

:compileEnterpriseHelloSharedLibraryHelloCpp
:linkEnterpriseHelloSharedLibrary
:enterpriseHelloSharedLibrary
:compileEnterpriseMainExecutableMainCpp
:linkEnterpriseMainExecutable
:enterpriseMainExecutable
:installEnterpriseMainExecutable
:compileCommunityHelloSharedLibraryHelloCpp
:linkCommunityHelloSharedLibrary
:communityHelloSharedLibrary
:compileCommunityMainExecutableMainCpp
:linkCommunityMainExecutable
:communityMainExecutable
:installCommunityMainExecutable

BUILD SUCCESSFUL
Total time: 9.414 secs</code></pre> </div> </div> <div class=paragraph> <p>Ahora podemos ejecutar nuestra aplicación en los dos sabores:</p> </div> <div class=listingblock> <div class=title>Community</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>$ build/install/mainExecutable/community/main
1.      Hello Mr. Pepito        (Community)
2.      Hello Mr. Pepito        (Community)
3.      Hello Mr. Pepito        (Community)
4.      Hello Mr. Pepito        (Community)
5.      Hello Mr. Pepito        (Community)
6.      Hello Mr. Pepito        (Community)
7.      Hello Mr. Pepito        (Community)
8.      Hello Mr. Pepito        (Community)
9.      Hello Mr. Pepito        (Community)
10.     Hello Mr. Pepito        (Community)</code></pre> </div> </div> <div class=listingblock> <div class=title>Enterprise</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>$ build/install/mainExecutable/enterprise/main
1.      Hello Mr. Pepito        (Enterprise)
2.      Hello Mr. Pepito        (Enterprise)
3.      Hello Mr. Pepito        (Enterprise)
4.      Hello Mr. Pepito        (Enterprise)
5.      Hello Mr. Pepito        (Enterprise)
6.      Hello Mr. Pepito        (Enterprise)
7.      Hello Mr. Pepito        (Enterprise)
8.      Hello Mr. Pepito        (Enterprise)
9.      Hello Mr. Pepito        (Enterprise)
10.     Hello Mr. Pepito        (Enterprise)</code></pre> </div> </div> </div> <div class=sect3> <h4 id=_release_o_debug>Release o Debug</h4> <div class=paragraph> <p>Por defecto <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> compila nuestra aplicación en modo Debug, pero podemos añadir el modo Release para que active algunas optimizaciones<sup class=footnote>[<a href=#_footnotedef_4 class=footnote title="View footnote." id=_footnoteref_4>4</a>]</sup>.</p> </div> <div class=listingblock> <div class=title>build.gradle</div> <div class=content> <pre class=highlight><code class=language-groovy data-lang=groovy>apply <span class=hljs-string>plugin:</span> <span class=hljs-string>'cpp'</span>
model {
    buildTypes {
        debug
        release
    }

<span class=hljs-comment>// ... the rest of file below doesn't change</span>
}</code></pre> </div> </div> <div class=paragraph> <p>Si ahora ejecutamos <code>gradle clean task</code> veremos que tenemos más tareas, se habrán desdoblado las que teníamos, por ejemplo <code>installCommunityMainExecutable</code> se habrá desdoblado en <code>installDebugCommunityMainExecutable</code> y <code>installReleaseCommunityMainExecutable</code>.</p> </div> </div> <div class=sect3> <h4 id=_multi_plataforma>Multi-plataforma</h4> <div class=paragraph> <p>También tenemos las posibilidad de utilizar las características de compilación cruzada que nos ofrecen los compiladores y generar componentes nativos para otras plataformas. El proceso es el mismo, simplemente tenemos que dar te alta las plataformas que vamos a soportar.</p> </div> <div class=paragraph> <p>Esto solo funcionará si en nuestro sistema tenemos instalada la cadena de herramientas (<a href=https://en.wikipedia.org/wiki/Toolchain rel=noopener target=_blank>Toolchain</a>) necesaria, es decir, si en un sistema de 64 bits queremos compilar para 32 bits, tendremos que tener instaladas las librerías necesarias para 32 bits.</p> </div> <div class=listingblock> <div class=title>build.gradle</div> <div class=content> <pre class=highlight><code class=language-groovy data-lang=groovy>apply <span class=hljs-string>plugin:</span> <span class=hljs-string>'cpp'</span>

model {
  buildTypes {
    debug
    release
  }

  platforms {
    x86 {
      architecture <span class=hljs-string>"x86"</span>
    }
    x64 {
      architecture <span class=hljs-string>"x86_64"</span>
    }
    itanium {
      architecture <span class=hljs-string>"ia-64"</span>
    }
  }

  flavors {
    community
    enterprise
  }

  components {
    hello(NativeLibrarySpec) {
      binaries.all {
        <span class=hljs-keyword>if</span> (flavor == flavors.enterprise) {
          cppCompiler.define <span class=hljs-string>"ENTERPRISE"</span>
        }
      }
    }
    main(NativeExecutableSpec) {
      binaries.all {
        lib <span class=hljs-string>library:</span> <span class=hljs-string>"hello"</span>
      }
    }
  }
}</code></pre> </div> </div> <div class=paragraph> <p>Ejecutando <code>gradle clean task</code> podremos ver las distintas opciones de construción que tenemos, en nuestro caso veremos que podemos construir distintas versiones de nuestra aplicación en distintos sabores, para distintas plataformas en Debug o Release.</p> </div> </div> </div> <div class=sect2> <h3 id=_pruébalo_tú_mism>Pruébalo tú mism@</h3> <div class=paragraph> <p>El proyecto se encuentra en <a href=https://github.com/carlosvin/cpp_gradle class=bare>https://github.com/carlosvin/cpp_gradle</a>.</p> </div> <div class=paragraph> <p>Para poder probar necesitas:</p> </div> <div class=ulist> <ul> <li> <p>Tener instalado <a href=https://www.java.com rel=noopener target=_blank>Java</a> a partir de la versión 6.</p> </li> <li> <p>Tener algún compilador instalado (por ejemplo <a href=https://gcc.gnu.org/ rel=noopener target=_blank>GCC</a>)</p> </li> </ul> </div> <div class=paragraph> <p>Solo tienes que seguir los siguientes pasos:</p> </div> <div class="arabic olist"> <ol class=arabic> <li> <p><code>git clone <a href=mailto:git@github.com>git@github.com</a>:carlosvin/cpp_gradle.git</code></p> </li> <li> <p><code>cd cpp_gradle</code></p> </li> <li> <p><code>./gradlew task</code> o <code>./gradlew.bat task</code> si estás en Windows. De esta forma verás todas las tareas que te ofrece <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> para este proyecto. La primera vez tardará un poco porque se descarga una versión de <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a>.</p> </li> <li> <p>Si estás en una máquina de 64 bits, por ejemplo utiliza este comando para compilar e instalar la aplicación <code>./gradlew installX64ReleaseEnterpriseMainExecutable</code>.</p> </li> <li> <p>Ejecuta la aplicación que acabas de construir <code>build/install/mainExecutable/x64ReleaseEnterprise/main</code></p> </li> </ol> </div> </div> </div> </div> <div class=sect1> <h2 id=_conclusiones>Conclusiones</h2> <div class=sectionbody> <div class=paragraph> <p>Con una configuración mínima, tenemos muchas posibilidades de construcción de aplicaciones nativas multi-plataforma.</p> </div> <div class=paragraph> <p>Tiene un futuro prometedor, veremos como termina.</p> </div> <div class=paragraph> <p>Podemos utilizar otras características de <a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> y aplicarlas a nuestros proyectos C++, como análisis estáticos de código, generación de informes (pruebas, cobertura, calidad, etc.), fácil incorporación a sistemas de integración continua.</p> </div> <div class=paragraph> <p><a href=https://www.gradle.org rel=noopener target=_blank>Gradle</a> para C++ es una característica que actualmente está en desarrollo, por lo que no hay que olvidar que:</p> </div> <div class=ulist> <ul> <li> <p>No debemos utilizar en entornos reales de desarrollo, puede acarrear muchos dolores de cabeza.</p> </li> <li> <p>La forma de definir el fichero build.gradle para esta característica puede cambiar.</p> </li> </ul> </div> <div class=paragraph> <p>Todo el ejemplo se encuentra en <a href=https://github.com/carlosvin/cpp_gradle class=bare>https://github.com/carlosvin/cpp_gradle</a>. Os recomiendo que lo descarguéis y probéis lo sencillo que resulta.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class=icon> <div class=title>Note</div> </td> <td class=content> Si encontráis algún problema en el ejemplo, escribir un comentario, abrir un defecto o corregirlo vosotros mismos en <a href=https://github.com/carlosvin/cpp_gradle class=bare>https://github.com/carlosvin/cpp_gradle</a> </td> </tr> </table> </div> <div class=paragraph> <p>Más información en <a href=https://docs.gradle.org/current/userguide/native_software.html>Getting Started Gradle Native</a>.</p> </div> </div> </div> <div id=footnotes> <hr> <div class=footnote id=_footnotedef_1> <a href=#_footnoteref_1>1</a>. n es un número entero positivo </div> <div class=footnote id=_footnotedef_2> <a href=#_footnoteref_2>2</a>. Realmente no es necesario tener instalado Gradle, si utilizamos el wrapper, pero esto no lo vamos a tratar hoy, <a href=https://docs.gradle.org/current/userguide/gradle_wrapper.html>si queréis más información</a>. </div> <div class=footnote id=_footnotedef_3> <a href=#_footnoteref_3>3</a>. .bat en Windows y sin extensión en Linux </div> <div class=footnote id=_footnotedef_4> <a href=#_footnoteref_4>4</a>. También podemos definir el tipo de optimizaciones que vamos a utilizar. </div> </div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.32276ee8.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.32276ee8.js")}document.head.appendChild(s)</script> <script async defer> (function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-1328360-10', 'auto');
		ga('send', 'pageview'); </script> 