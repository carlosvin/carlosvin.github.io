<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=sapper name=generator> <meta content=a22af7614c96254d name=yandex-verification> <link href=/icons/icon-192x192.png rel=apple-touch-icon> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.1481846680.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Elegir tecnologías para mi nuevo proyeco C++</title><link href=/rss rel=alternate type=application/rss+xml title='Subscribe to Carlos says "bla bla"'><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"Webpage","@id":"https://google.com/article"},"headline":"Elegir tecnologías para mi nuevo proyeco C++","alternativeHeadline":"Las tecnologías que he elegido para mi proyecto C++. My chosen technologies stack for C++ project. It contains an easy to run example defining main project skeleton","description":"Las tecnologías que he elegido para mi proyecto C++. My chosen technologies stack for C++ project. It contains an easy to run example defining main project skeleton","image":"icons/icon-192x192.png","datePublished":"2017-09-24 20:00:00","dateModified":"2017-09-24 20:00:00","keywords":["C++","Unit Testing","Build System","Build Software","Meson","Catch","doctest"],"author":{"@type":"Person","name":"Carlos Martin Sanchez"},"publisher":"Carlos Martin Sanchez"}</script><meta content=2017-09-24 name=date scheme=YYYY-MM-DD><meta content="Las tecnologías que he elegido para mi proyecto C++. My chosen technologies stack for C++ project. It contains an easy to run example defining main project skeleton" name=description><link href=/posts/choosing-modern-cpp-stack/en rel=alternate hreflang=en><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css rel=preload as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css rel=stylesheet></noscript><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-1v6ow72><button class=svelte-1v6ow72>≡</button> <ul class="svelte-1v6ow72 closed"><li class=svelte-1y8uoef><a href=. class=svelte-1y8uoef>Carlos says "bla bla"</a></li> <li class=svelte-1y8uoef><a href=categories class=svelte-1y8uoef>Categories</a></li> <li class=svelte-1y8uoef><a href=about class=svelte-1y8uoef>About</a></ul> <div class="h svelte-1w8skyw"><a href=/rss rel=noopener target=_blank class="icon svelte-1lu397 rss" title='Subscribe to Carlos says "bla bla"'></a> <a href=https://github.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 github" title="Find me at github"></a> <a href=https://twitter.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 twitter" title="Find me at twitter"></a> <a href=https://stackoverflow.com/story/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 stackoverflow" title="Find me at stackoverflow"></a></div></nav> <main class=svelte-bvcji9> <header class=svelte-1svctju><h1 class=svelte-1svctju>Elegir tecnologías para mi nuevo proyeco C++ <span class="svelte-1svctju share"><a href="https://twitter.com/intent/tweet?url=https://carlosvin.github.io/posts/choosing-modern-cpp-stack/es&text=Elegir tecnologías para mi nuevo proyeco C++: Las tecnologías que he elegido para mi proyecto C++. My chosen technologies stack for C++ project. It contains an easy to run example defining main project skeleton&hashtags=C++,Unit Testing,Build System,Build Software,Meson,Catch,doctest" rel=noopener target=_blank class="icon svelte-1lu397 twitter" title='Share "Elegir tecnologías para mi nuevo proyeco C++"'></a></span></h1> <p class="svelte-1svctju summary">Las tecnologías que he elegido para mi proyecto C++. My chosen technologies stack for C++ project. It contains an easy to run example defining main project skeleton</p> <div class="subtitle svelte-16mbbpz"><span class=date>24/09/2017</span> <span class="summary langs">Available in <span class="lang svelte-k3ijyt"><a href=/posts/choosing-modern-cpp-stack/en rel=prefetch>en</a> </span></span> <span class=svelte-16xp99e><a href=/categories/c class=svelte-1gu8b1d title=C++><span class="hover svelte-1x4e0dt">C++</span></a><a href=/categories/unit-testing class=svelte-1gu8b1d title="Unit Testing"><span class="hover svelte-1x4e0dt">Unit Testing</span></a><a href=/categories/build-system class=svelte-1gu8b1d title="Build System"><span class="hover svelte-1x4e0dt">Build System</span></a><a href=/categories/build-software class=svelte-1gu8b1d title="Build Software"><span class="hover svelte-1x4e0dt">Build Software</span></a><a href=/categories/meson class=svelte-1gu8b1d title=Meson><span class="hover svelte-1x4e0dt">Meson</span></a><a href=/categories/catch class=svelte-1gu8b1d title=Catch><span class="hover svelte-1x4e0dt">Catch</span></a><a href=/categories/doctest class=svelte-1gu8b1d title=doctest><span class="hover svelte-1x4e0dt">doctest</span></a></span></div></header> <div class="content svelte-1gb6nlh"><div class=toc id=toc> <div id=toctitle>Table of Contents</div> <ul class=sectlevel1> <li><a href=#_elegir_un_sistema_de_construcción_meson>Elegir un Sistema de Construcción (Meson)</a> <ul class=sectlevel2> <li><a href=#_cmake_vs_meson>CMake vs Meson</a></li> <li><a href=#_otras_comparaciones_entre_sistemas_de_construcción>Otras comparaciones entre sistemas de construcción</a></li> </ul> </li> <li><a href=#_framework_the_pruebas_unitarias>Framework the Pruebas Unitarias</a> <ul class=sectlevel2> <li><a href=#_doctest_una_alternativa_a_catch>doctest: Una alternativa a Catch</a></li> </ul> </li> <li><a href=#_ejemplo>Ejemplo</a> <ul class=sectlevel2> <li><a href=#_artefactos_del_proyecto>Artefactos del Proyecto</a></li> <li><a href=#_estructura_del_proyecto_fork_project>Estructura del Proyecto (Fork project)</a></li> </ul> </li> </ul> </div> <div id=preamble> <div class=sectionbody> <div class=paragraph> <p>Estoy empezando un pequeño proyecto en C++ y antes de nada me han surgido un par de preguntas:</p> </div> <div class="arabic olist"> <ol class=arabic> <li> <p>¿Cómo voy a construirlo?</p> </li> <li> <p>¿Qué framework para pruebas unitarias utilizar?</p> </li> </ol> </div> </div> </div> <div class=sect1> <h2 id=_elegir_un_sistema_de_construcción_meson>Elegir un Sistema de Construcción (<a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>)</h2> <div class=sectionbody> <div class=paragraph> <p>Ya he utilizado antes <a href=https://www.gnu.org/software/make/manual/make.html rel=noopener target=_blank>Make</a>, <a href=https://maven.apache.org/ rel=noopener target=_blank>Maven</a>, <a href=https://scons.org/ rel=noopener target=_blank>Scons</a>, <a href=https://gradle.org/ rel=noopener target=_blank>Gradle</a> y <a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html rel=noopener target=_blank>Autotools</a>, pero tengo algunas razones para probar algo diferente, hay algunas cosas que no me gustan:</p> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html rel=noopener target=_blank>Autotools</a></dt> <dd> <p>No es fácil de configurar y mantener: hay distintos ficheros de configuración y distintos pasos de configuración.</p> </dd> <dt class=hdlist1><a href=https://gradle.org/ rel=noopener target=_blank>Gradle</a></dt> <dd> <p>La construcción de proyectos C++ está todavía en desarrollo, los modelos y APIs están cambiando. No es muy rápido. Puedes ver un ejemplo en este artículo <a href=/posts/gradle-cpp/es>Construir un proyecto Cpp con Gradle</a>.</p> </dd> <dt class=hdlist1><a href=https://www.gnu.org/software/make/manual/make.html rel=noopener target=_blank>Make</a></dt> <dd> <p>A medida que el proyecto crece los archivos de configuración se van complicando y volviendo poco manejables. La sintáxis no me parece clara (esto es una custión de gustos).</p> </dd> <dt class=hdlist1><a href=https://scons.org/ rel=noopener target=_blank>Scons</a></dt> <dd> <p>Es más lento y un poco más difícil de comprender que <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>.</p> </dd> <dt class=hdlist1><a href=https://maven.apache.org/ rel=noopener target=_blank>Maven</a></dt> <dd> <p>Es lento y puedes terminar "<em>Javatizando</em>" la estructura del proyecto.</p> </dd> </dl> </div> <div class="admonitionblock note"> <table> <tr> <td class=icon> <div class=title>Note</div> </td> <td class=content> He nombrado solo las cosas que no gustan, pero estos sistemas de construcción tienen otras grandes virtudes, personalmente me encantan <a href=https://gradle.org/ rel=noopener target=_blank>Gradle</a>, <a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html rel=noopener target=_blank>Autotools</a> y <a href=https://maven.apache.org/ rel=noopener target=_blank>Maven</a> (solo para projectos Java). </td> </tr> </table> </div> <div class=sect2> <h3 id=_cmake_vs_meson><a href=https://cmake.org/ rel=noopener target=_blank>CMake</a> vs <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a></h3> <div class=paragraph> <p>Después de descartar los anteriores, estoy considerando <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> y <a href=https://cmake.org/ rel=noopener target=_blank>CMake</a>. Los dos son bastante rápidos:</p> </div> <div class=paragraph> <p>Aunque <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> está hecho en <a href=https://python.org/ rel=noopener target=_blank>Python</a>, simplemente genera projectos <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a>. La primera vez tenemos que ejecutar <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> para configurar el proyecto, el resto de ejecuciones para compilar o ejecutar pruebas, realmente estaremos ejecutando directamente <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a>.</p> </div> <div class=paragraph> <p><a href=https://cmake.org/ rel=noopener target=_blank>CMake</a> también puede generar proyectos <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a> entre otros formatos, <a href=https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html>mira la documentación "CMake generators"</a>.</p> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://cmake.org/ rel=noopener target=_blank>CMake</a></dt> <dd> <p>Tiene una gran ventaja sobre <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>, es mucho más maduro y es mucho más usado, lo que significa que podrás encontrar muy fácilmente ejemplos, documentación y ayuda en Internet. No importa el tipo de proyecto que estés empezando, lo más seguro es que <a href=https://cmake.org/ rel=noopener target=_blank>CMake</a> sea una buena elección.</p> </dd> <dt class=hdlist1><a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a></dt> <dd> <p>Es un proyecto jóven comparado con <a href=https://cmake.org/ rel=noopener target=_blank>CMake</a>, pero está creciendo rápido y ya ha sido adoptado por algunos proyectos importantes como <a href=https://www.gnome.org/ rel=noopener target=_blank>Gnome</a>, donde han comenzado una iniciativa para <a href=https://wiki.gnome.org/Initiatives/GnomeGoals/MesonPorting>migrar desde Autotools a Meson</a>.</p> </dd> </dl> </div> <div class=paragraph> <p><strong>Finalmente he elegido</strong> <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> porque:</p> </div> <div class=ulist> <ul> <li> <p>La sintáxis es muy clara para mí, cuando leo un archivo <span class=title-ref>meson.build</span> entiendo rápidamente lo ue está pasando durante el proceso de construcción.</p> </li> <li> <p>Es rápido, aunque está escrito en <a href=https://python.org/ rel=noopener target=_blank>Python</a> utiliza <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a> para construir el proyecto. La primera vez tienes que utilizar <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> para configurar el proyecto, pero para construir y probar el proyecto relmente estamos ejecutando <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a>.</p> </li> </ul> </div> <div class=listingblock> <div class=title>Pasos para compilar y ejectuar tests</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>$ meson build . <b class=conum>(1)</b>
$ <span class=hljs-built_in>cd</span> build
$ ninja build   <b class=conum>(2)</b>
$ ninja <span class=hljs-built_in>test</span>    <b class=conum>(3)</b></code></pre> </div> </div> <div class="arabic colist"> <ol> <li> <p>Primera vez, configuración del proyecto</p> </li> <li> <p>Cada vez que construyes el projecto</p> </li> <li> <p>Cada vez que ejecutas tests</p> </li> </ol> </div> </div> <div class=sect2> <h3 id=_otras_comparaciones_entre_sistemas_de_construcción>Otras comparaciones entre sistemas de construcción</h3> <div class=paragraph> <p>He encontrado un par de comparaciones interesantes entre algunos de los sistemas de construcción en C++, aunque puede que no sean del todo imparciales porque han sido realizadas por <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> y <a href=https://scons.org/ rel=noopener target=_blank>Scons</a>.</p> </div> <div class=ulist> <ul> <li> <p><a href=https://bitbucket.org/scons/scons/wiki/SconsVsOtherBuildTools>C++ build systems comparison from Scons</a>.</p> </li> <li> <p><a href=https://mesonbuild.com/Simple-comparison.html>C++ build systems comparison from Meson</a>.</p> </li> </ul> </div> </div> </div> </div> <div class=sect1> <h2 id=_framework_the_pruebas_unitarias>Framework the Pruebas Unitarias</h2> <div class=sectionbody> <div class=paragraph> <p>Anteriorment he utilizado algunas librerías del tipo <a href=https://en.wikipedia.org/wiki/XUnit rel=noopener target=_blank>xUnit</a> como <a href=https://github.com/unittest-cpp/unittest-cpp>UnitTest++</a>, <a href=https://cpputest.github.io/ >CppUTest</a> o <a href=https://github.com/google/googletest>Google Test</a> que encaja perfectamente con <a href=https://github.com/google/googletest/tree/master/googlemock>Google Mock</a>.</p> </div> <div class=paragraph> <p>Si quires una apuesta segura que cumpla tus expectativas, te recomiendo <a href=https://github.com/google/googletest>Google Test</a>.</p> </div> <div class=paragraph> <p>Pero hace algún tiempo encontré un framework de pruebas con algunas características no tan comunes en librerías de pruebas C++ y que resultaba realmente fácil de utilizar, estoy hablando de <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>:</p> </div> <div class=ulist> <ul> <li> <p>Es simplemente un fichero de cabeceras C++ sin dependencias adicionales, por lo que resulta realmente rápido comenzar (wget y utilizar el fichero descargado desde tus pruebas).</p> </li> <li> <p>Puedes utilizar el estilo normal de pruebas unitarias o el estilo <a href=https://en.wikipedia.org/wiki/Behavior-driven_development rel=noopener target=_blank>BDD</a>.</p> </li> </ul> </div> <div class=paragraph> <p>Si quieres saber más sobre <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>, te recomiendo que directamente lo pruebes, el siguiente ejemplo, es cuestión de dos minutos <a href=https://github.com/philsquared/Catch/blob/master/docs/tutorial.md#writing-tests>simple example up and running</a>. Puedes también leer algunos artículos como <a href=https://github.com/philsquared/Catch/blob/master/docs/why-catch.md>Why do we need yet another C test framework?] o https://blog.coldflake.com/posts/Testing-C-with-a-new-Catch/[Testing C++ With A New Catch</a>.</p> </div> <div class=sect2> <h3 id=_doctest_una_alternativa_a_catch><a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a>: Una alternativa a <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a></h3> <div class=paragraph> <p>Hay otro framework de pruebas llamado <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a>, con los mismos principios que <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>, pero promete ser más rápido y ligero (<a href=https://github.com/onqtam/doctest/blob/master/doc/markdown/benchmarks.md>resultados de las comparaciones de rendimiento</a>) que <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>.</p> </div> <div class=paragraph> <p><a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> fue diseñado basándose en los puntos fuertes de <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>, pero hay algunas <a href=https://github.com/onqtam/doctest/blob/master/doc/markdown/faq.md#how-is-doctest-different-from-catch>diferencias</a>.</p> </div> <div class=paragraph> <p>No es fácil decidirse por uno, los dos son muy parecidos, puedes comprobar las diferencias a continuación:</p> </div> <div class=listingblock> <div class=title>Differencias entre la rama usando <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> y la rama usando <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a></div> <div class=content> <pre class=highlight><code class=language-diff data-lang=diff><span class=hljs-meta>@@ -1,12 +1,12 @@</span>
<span class=hljs-deletion>-#define CATCH_CONFIG_MAIN // It tells Catch to provide a main() - only do this in one cpp file</span>
<span class=hljs-addition>+#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</span>

<span class=hljs-deletion>-#include "catch.hpp"</span>
<span class=hljs-addition>+#include "doctest.h"</span>
#include "Uuid.h"
#include &lt;string>

constexpr int MAX_ITERS = 100;

<span class=hljs-deletion>-TEST_CASE("Uuid", "[uuid]")</span>
<span class=hljs-addition>+TEST_CASE("Uuid")</span>
{
for (int i = 0; i &lt; MAX_ITERS; i++)
{
@@ -26,7 +26,7 @@ TEST_CASE("Uuid", "[uuid]")

// BDD style

<span class=hljs-deletion>-SCENARIO("UUID creation", "[Uuid]")</span>
<span class=hljs-addition>+SCENARIO("UUID creation")</span>
{

GIVEN("A random UUID ")</code></pre> </div> </div> <div class=paragraph> <p>Finalmente he elegido <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> simplemente porque es más rápido: <a href=https://github.com/onqtam/doctest/blob/master/doc/markdown/benchmarks.md>resultados de las comparaciones de rendimiento</a>.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class=icon> <div class=title>Note</div> </td> <td class=content> He creado el proyecto de ejemplo utilizando ambos frameworks, puedes encontrarlos en diferentes ramas del repositorio: <a href=https://github.com/carlosvin/uuid-cpp/tree/doctest>rama doctest</a> or <a href=https://github.com/carlosvin/uuid-cpp/tree/catch>rama catch</a>. </td> </tr> </table> </div> </div> </div> </div> <div class=sect1> <h2 id=_ejemplo>Ejemplo</h2> <div class=sectionbody> <div class=paragraph> <p>He creado un ejemplo para ilustrar este artículo: <a href=https://github.com/carlosvin/uuid-cpp class=bare>https://github.com/carlosvin/uuid-cpp</a>.</p> </div> <div class=paragraph> <p>Consiste en una implementación básica de un generador pseudo-aleatorio de <a href=https://en.wikipedia.org/wiki/Universally_unique_identifier rel=noopener target=_blank>UUID</a>, está basado en <a href=https://www.cplusplus.com/reference/random/mt19937 rel=noopener target=_blank>mt19937</a> que no es criptográficamente seguro.</p> </div> <div class=sect2> <h3 id=_artefactos_del_proyecto>Artefactos del Proyecto</h3> <div class=paragraph> <p>Cuando instalemos el proyecto, <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> (<a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a> realmente) generará una serie de artefactos en nuestro sistema.</p> </div> <div class=ulist> <ul> <li> <p>Librería compartida: <code>libuuid</code>.</p> </li> <li> <p>Fichero de cabeceras para que los desarrolladores puedan usar la librería: <code>include/Uuid.h</code>.</p> </li> <li> <p>Fichero ejecutable <code>uuidgen</code> (Generador de <a href=https://en.wikipedia.org/wiki/Universally_unique_identifier rel=noopener target=_blank>UUID</a>).</p> </li> <li> <p>Ejecutable de las pruebas unitarias (no será instalado).</p> </li> </ul> </div> <div class=paragraph> <p>Si ejecutamos <code>ninja install</code> en Linux obtendremos los siguientes ficheros:</p> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>/usr/<span class=hljs-built_in>local</span>/lib/libuuid.so
/usr/<span class=hljs-built_in>local</span>/include/Uuid.h
/usr/<span class=hljs-built_in>local</span>/bin/uuidgen</code></pre> </div> </div> </div> <div class=sect2> <h3 id=_estructura_del_proyecto_fork_project>Estructura del Proyecto (<a href=https://github.com/carlosvin/uuid-cpp>Fork project</a>)</h3> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/meson.build>meson.build</a></dt> <dd> <p>Fichero principal de configuración para construir el proyecto. Lo utilizamos para especificar las propiedades y subdirectorios del proyecto.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python>project(
    <span class=hljs-string>'cpp-meson-example'</span>, <span class=hljs-comment># project name</span>
    <span class=hljs-string>'cpp'</span>, <span class=hljs-comment># C++ project, e.g: for C project</span>
    version : <span class=hljs-string>'1.0.0'</span>,
    license : <span class=hljs-string>'MIT'</span>,
    default_options : [<span class=hljs-string>'cpp_std=c++11'</span>]) <span class=hljs-comment># compile for C++</span>

<span class=hljs-comment># it will be referred from subdir projects</span>
inc = include_directories(<span class=hljs-string>'include'</span>)

<span class=hljs-comment># meson will try to find a meson.build file inside following directories</span>
subdir(<span class=hljs-string>'include'</span>)
subdir(<span class=hljs-string>'src'</span>)
subdir(<span class=hljs-string>'test'</span>)</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/include/ >include</a></dt> <dd> <div class=dlist> <dl> <dt class=hdlist1>meson.build</dt> <dd> <p>Archivo de configuración para construir este directorio, no hay mucho que hacer aquí, simplemente indicamos qué ficheros de cabeceras han de ser instalados</p> </dd> </dl> </div> </dd> </dl> </div> <div class=listingblock> <div class=title>include/meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python><span class=hljs-comment># Select header files to be installed</span>
install_headers(<span class=hljs-string>'Uuid.h'</span>)</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/include/Uuid.h>Uuid.h</a></dt> <dd> <p>Archivos de cabeceras, es el interfaz que expone la librería y que será incluido por los usuarios de la misma.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>include/Uuid.h</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-keyword>namespace</span> ids {

<span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>Uuid</span> {</span>
    <span class=hljs-keyword>private</span>:
    <span class=hljs-comment>// ...</span></code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src>src</a></dt> <dd> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src/meson.build>meson.build (src)</a></dt> <dd> <p>Declara 2 artefactos de salida: La librería <code>libuuid</code> y el ejecutable <code>uuidgen</code>.</p> </dd> </dl> </div> </dd> </dl> </div> <div class=listingblock> <div class=title>src/meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python>libuuid = shared_library(
    <span class=hljs-string>'uuid'</span>, <b class=conum>(1)</b>
    <span class=hljs-string>'Uuid.cpp'</span>, <b class=conum>(2)</b>
    include_directories : inc, <b class=conum>(3)</b>
    install : true) <b class=conum>(4)</b>

uuidgen = executable(
    <span class=hljs-string>'uuidgen'</span>, <b class=conum>(5)</b>
    <span class=hljs-string>'main.cpp'</span>, <b class=conum>(6)</b>
    include_directories : inc, <b class=conum>(7)</b>
    link_with : libuuid, <b class=conum>(8)</b>
    install : true) <b class=conum>(9)</b></code></pre> </div> </div> <div class="arabic colist"> <ol> <li> <p>library name</p> </li> <li> <p>source files to be compile</p> </li> <li> <p>previously declared include directories in root <code>meson.build</code></p> </li> <li> <p><code>libuuid</code> will be part of project installation</p> </li> <li> <p>executable name</p> </li> <li> <p>source files to compile</p> </li> <li> <p>previously declared include directories in root <code>meson.build</code></p> </li> <li> <p>linking executable with shared previously declared shared library <code>libuuid</code></p> </li> <li> <p><code>uuidgen</code> executable be part of project installation</p> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src/main.cpp>main.cpp</a></dt> <dd> <p>Código fuente del ejecutable de la aplicación: <code>uuidgen</code></p> </dd> </dl> </div> </li> </ol> </div> <div class=listingblock> <div class=title>src/main.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Uuid.h"</span></span>
<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>&lt;iostream></span></span>

<span class=hljs-function><span class=hljs-keyword>int</span> <span class=hljs-title>main</span><span class=hljs-params>()</span>
</span>{
    ids::Uuid uuid;
    <span class=hljs-built_in>std</span>::<span class=hljs-built_in>cout</span> &lt;&lt; uuid.to_str() &lt;&lt; <span class=hljs-built_in>std</span>::<span class=hljs-built_in>endl</span>;
    <span class=hljs-keyword>return</span> <span class=hljs-number>0</span>;
}</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src/Uuid.cpp>Uuid.cpp</a></dt> <dd> <p>Implementación de la clase declarada en el fichero de cabeceras <code>Uuid.h</code>.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>src/Uuid.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Uuid.h"</span></span>

Uuid::Uuid()
{ <span class=hljs-comment>// ...</span></code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/test/ >test</a></dt> <dd> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/test/meson.build>meson.build (test)</a></dt> <dd> <p>Archivo de configuración para construir y ejecutar las pruebas unitarias.</p> </dd> </dl> </div> </dd> </dl> </div> <div class=listingblock> <div class=title>test/meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python>testexe = executable(
    <span class=hljs-string>'testexe'</span>, <b class=conum>(1)</b>
    <span class=hljs-string>'uuid_test.cpp'</span>, <b class=conum>(2)</b>
    include_directories : inc, <b class=conum>(3)</b>
    link_with : libuuid) <b class=conum>(4)</b>

test(<span class=hljs-string>'Uuid test'</span>, testexe) <b class=conum>(5)</b>

test(<span class=hljs-string>'Uuid test with args and env'</span>, testexe, args : [<span class=hljs-string>'arg1'</span>, <span class=hljs-string>'arg2'</span>], env : [<span class=hljs-string>'FOO=bar'</span>]) <b class=conum>(6)</b></code></pre> </div> </div> <div class="arabic colist"> <ol> <li> <p>test executable name</p> </li> <li> <p>tests source files to be compiled</p> </li> <li> <p>declared include directories in root <code>meson.build</code></p> </li> <li> <p>link test executable with previously declared shared library <code>libuuid</code></p> </li> <li> <p>test execution</p> </li> <li> <p>we can specify other test execution passing arguments or environment variables</p> <div class=dlist> <dl> <dt class=hdlist1>doctest.h</dt> <dd> <p>Librería <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> en un único fichero de cabeceras. Puedes tratar de automatizar el proceso de instalación de la librería, yo por el momento la he instalado manualmente, ya que es un proceso muy sencillo:</p> </dd> </dl> </div> </li> </ol> </div> <div class=listingblock> <div class=title>Añadir <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> al proyecto</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash><span class=hljs-built_in>cd</span> <span class=hljs-built_in>test</span>
wget https://raw.githubusercontent.com/onqtam/doctest/master/doctest/doctest.h</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/test/uuid_test.cpp>uuid_test.cpp</a></dt> <dd> <p>Implementación de las pruebas unitarias.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>test/uuid_test.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>define</span> DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</span>

<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"doctest.h"</span></span>
<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Uuid.h"</span></span>
<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>&lt;string></span></span>

<span class=hljs-keyword>constexpr</span> <span class=hljs-keyword>int</span> MAX_ITERS = <span class=hljs-number>100</span>;

TEST_CASE(<span class=hljs-string>"Uuid"</span>)
{
    <span class=hljs-keyword>for</span> (<span class=hljs-keyword>int</span> i = <span class=hljs-number>0</span>; i &lt; MAX_ITERS; i++)
    {
        ids::Uuid uuid;
        <span class=hljs-built_in>std</span>::<span class=hljs-built_in>string</span> uuid_str{uuid.to_str()};

        INFO(uuid_str);

        <span class=hljs-comment>// If assertion fails test execution is stopped</span>
        REQUIRE(uuid_str.size() == <span class=hljs-number>36</span>);

        <span class=hljs-comment>// If assertion fails test execution continues</span>
        CHECK(uuid.most > <span class=hljs-number>0</span>);
        CHECK(uuid.least > <span class=hljs-number>0</span>);
    }
}

<span class=hljs-comment>// BDD style</span>

SCENARIO(<span class=hljs-string>"UUID creation"</span>)
{

    GIVEN(<span class=hljs-string>"A random UUID "</span>)
    {

        ids::Uuid uuid;
        <span class=hljs-built_in>std</span>::<span class=hljs-built_in>string</span> uuid_str{uuid.to_str()};

        REQUIRE(uuid_str.size() == <span class=hljs-number>36</span>);

        WHEN(<span class=hljs-string>"get the most and least"</span>)
        {
            THEN(<span class=hljs-string>"should be more than 0"</span>)
            {
                CHECK(uuid.most > <span class=hljs-number>0</span>);
                CHECK(uuid.least > <span class=hljs-number>0</span>);
            }
        }
    }
}</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class=icon> <div class=title>Tip</div> </td> <td class=content> Puedes encontrar las instrucciones para construir y ejecutar el proyecto de ejemplo en: <a href=https://github.com/carlosvin/uuid-cpp#how-to-build-the-example class=bare>https://github.com/carlosvin/uuid-cpp#how-to-build-the-example</a> </td> </tr> </table> </div> </div> </div> </div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.34f5c22a.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.34f5c22a.js")}document.head.appendChild(s)</script> <script async defer> (function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-1328360-10', 'auto');
		ga('send', 'pageview'); </script> 