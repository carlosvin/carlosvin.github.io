<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=sapper name=generator> <meta content=a22af7614c96254d name=yandex-verification> <link href=/icons/icon-192x192.png rel=apple-touch-icon> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.816515953.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Choosing a Modern C++ stack</title><link href=/rss rel=alternate type=application/rss+xml title="Subscribe to Carlos says bla bla"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"Webpage","@id":"https://google.com/article"},"headline":"Choosing a Modern C++ stack","alternativeHeadline":"The reasons why I'd choose following tech stack to create a new C++ project. It contains an easy-to-run example which you will be able to reuse as template to start a new C++ project.","description":"The reasons why I'd choose following tech stack to create a new C++ project. It contains an easy-to-run example which you will be able to reuse as template to start a new C++ project.","image":"icons/icon-192x192.png","datePublished":"2017-09-15","dateModified":"2020-06-13","keywords":["C++","Unit Testing","Build System","Meson","Catch","doctest"],"author":{"@type":"Person","name":"Carlos Martin Sanchez"},"publisher":"Carlos Martin Sanchez"}</script><meta content=2017-09-15 name=date scheme=YYYY-MM-DD><meta content="The reasons why I'd choose following tech stack to create a new C++ project. It contains an easy-to-run example which you will be able to reuse as template to start a new C++ project." name=description><link href=/posts/choosing-modern-cpp-stack/es rel=alternate hreflang=es><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css rel=preload as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css rel=stylesheet></noscript><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-1hjvhrx><li class=svelte-1y8uoef><a href=/ class=svelte-1y8uoef><img alt="Carlos says bla bla" class="svelte-1hjvhrx logo" src=/favicon.png></a></li> <ul class="svelte-1hjvhrx closed"><span class="svelte-1hjvhrx siteName"><li class=svelte-1y8uoef><a href=/ class=svelte-1y8uoef>Carlos says bla bla</a></span> <li class=svelte-1y8uoef><a href=/categories class=svelte-1y8uoef>Categories</a></li> <li class=svelte-1y8uoef><a href=/about class=svelte-1y8uoef>About</a></ul> <div class="h svelte-1w8skyw"><a href=/rss rel=noopener target=_blank class="icon svelte-1lu397 rss" title="Subscribe to Carlos says bla bla"></a> <a href=https://github.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 github" title="Find me at github"></a> <a href=https://twitter.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 twitter" title="Find me at twitter"></a> <a href=https://stackoverflow.com/story/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 stackoverflow" title="Find me at stackoverflow"></a></div> <button class=svelte-1hjvhrx>≡</button></nav> <main class=svelte-bvcji9> <header class=svelte-1svctju><h1 class=svelte-1svctju>Choosing a Modern C++ stack <span class="svelte-1svctju share"><a href="https://twitter.com/intent/tweet?url=https://carlosvin.github.io/posts/choosing-modern-cpp-stack/en&text=Choosing a Modern C++ stack: The reasons why I'd choose following tech stack to create a new C++ project. It contains an easy-to-run example which you will be able to reuse as template to start a new C++ project.&hashtags=C++,Unit Testing,Build System,Meson,Catch,doctest" rel=noopener target=_blank class="icon svelte-1lu397 twitter" title='Share "Choosing a Modern C++ stack"'></a></span></h1> <p class="svelte-1svctju summary">The reasons why I'd choose following tech stack to create a new C++ project. It contains an easy-to-run example which you will be able to reuse as template to start a new C++ project.</p> <div class="subtitle svelte-16mbbpz"><span class=date>15/09/2017</span> <span class="summary langs">Available in <span class="lang svelte-k3ijyt"><a href=/posts/choosing-modern-cpp-stack/es rel=prefetch>es</a> </span></span> <span class=svelte-16xp99e><a href=/categories/c class=svelte-1gu8b1d title=C++><span class="hover svelte-1x4e0dt">C++</span></a><a href=/categories/unit-testing class=svelte-1gu8b1d title="Unit Testing"><span class="hover svelte-1x4e0dt">Unit Testing</span></a><a href=/categories/build-system class=svelte-1gu8b1d title="Build System"><span class="hover svelte-1x4e0dt">Build System</span></a><a href=/categories/meson class=svelte-1gu8b1d title=Meson><span class="hover svelte-1x4e0dt">Meson</span></a><a href=/categories/catch class=svelte-1gu8b1d title=Catch><span class="hover svelte-1x4e0dt">Catch</span></a><a href=/categories/doctest class=svelte-1gu8b1d title=doctest><span class="hover svelte-1x4e0dt">doctest</span></a></span></div></header> <div class="content svelte-1jaj44x"><div class=toc id=toc> <div id=toctitle>Table of Contents</div> <ul class=sectlevel1> <li><a href=#_choosing_build_system_meson>Choosing Build System (Meson)</a> <ul class=sectlevel2> <li><a href=#_cmake_vs_meson>CMake vs Meson</a></li> <li><a href=#_other_build_systems_comparisons>Other build systems comparisons</a></li> </ul> </li> <li><a href=#_unit_testing_framework>Unit Testing Framework</a> <ul class=sectlevel2> <li><a href=#_doctest_a_catch_alternative>doctest: A Catch alternative</a></li> </ul> </li> <li><a href=#_example>Example</a> <ul class=sectlevel2> <li><a href=#_project_output_artifacts>Project output artifacts</a></li> <li><a href=#_project_structure_fork_project>Project structure (Fork project)</a></li> </ul> </li> </ul> </div> <div id=preamble> <div class=sectionbody> <div class=paragraph> <p>I’m starting a new project in C++, but I’ve run into a couple of questions before starting:</p> </div> <div class="arabic olist"> <ol class=arabic> <li> <p>Which build system should I use?</p> </li> <li> <p>Which unit testing framework?</p> </li> </ol> </div> <div class="admonitionblock tip"> <table> <tr> <td class=icon> <div class=title>Tip</div> </td> <td class=content> If you just want project template so you can have a C++ project skeleton ready in seconds, just go to <a href=https://github.com/carlosvin/uuid-cpp class=bare>https://github.com/carlosvin/uuid-cpp</a> and follow the <a href=https://github.com/carlosvin/uuid-cpp/blob/master/README.md target=blank_>instructions in README.md</a>. </td> </tr> </table> </div> </div> </div> <div class=sect1> <h2 id=_choosing_build_system_meson>Choosing Build System (<a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>)</h2> <div class=sectionbody> <div class=paragraph> <p>I have used before <a href=https://www.gnu.org/software/make/manual/make.html rel=noopener target=_blank>Make</a>, <a href=https://maven.apache.org/ rel=noopener target=_blank>Maven</a>, <a href=https://scons.org/ rel=noopener target=_blank>Scons</a>, <a href=https://gradle.org/ rel=noopener target=_blank>Gradle</a> and <a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html rel=noopener target=_blank>Autotools</a>, but I have some reasons to try find something else:</p> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html rel=noopener target=_blank>Autotools</a></dt> <dd> <p>It is not easy to configure and maintain. There are several configuration files and several configuration steps.</p> </dd> <dt class=hdlist1><a href=https://gradle.org/ rel=noopener target=_blank>Gradle</a></dt> <dd> <p>C feature is still incubating. Not very fast. You can check a similar example project at link:/posts/gradle-cpp/[Build C project with Gradle].</p> </dd> <dt class=hdlist1><a href=https://www.gnu.org/software/make/manual/make.html rel=noopener target=_blank>Make</a></dt> <dd> <p>I don’t love the syntax. Files tends to get messy as project grows.</p> </dd> <dt class=hdlist1><a href=https://scons.org/ rel=noopener target=_blank>Scons</a></dt> <dd> <p>It is just slower and not as easy to understand than <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>.</p> </dd> <dt class=hdlist1><a href=https://maven.apache.org/ rel=noopener target=_blank>Maven</a></dt> <dd> <p>It is slow and you might end up "<em>Javatizing</em>" your C++ project structure.</p> </dd> </dl> </div> <div class="admonitionblock note"> <table> <tr> <td class=icon> <div class=title>Note</div> </td> <td class=content> I’ve listed just things I don’t like, those projects have other great features. </td> </tr> </table> </div> <div class=sect2> <h3 id=_cmake_vs_meson><a href=https://cmake.org/ rel=noopener target=_blank>CMake</a> vs <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a></h3> <div class=paragraph> <p>After discarding previous ones, I’m considering <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> or <a href=https://cmake.org/ rel=noopener target=_blank>CMake</a>. Both are fast build systems:</p> </div> <div class=paragraph> <p>Although <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> is written in <a href=https://python.org/ rel=noopener target=_blank>Python</a>, it generates a <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a> build project. First time you configure the project you have to run <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>, but for building or testing you are actually running <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a>.</p> </div> <div class=paragraph> <p><a href=https://cmake.org/ rel=noopener target=_blank>CMake</a> is also able to generate <a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a> files among other formats, <a href=https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html>check CMake generators documentation for more information</a>.</p> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://cmake.org/ rel=noopener target=_blank>CMake</a></dt> <dd> <p>It has a big advantage over <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>, it is mature and widely used in many projects, which means there are many examples and it will fulfill your C++ project building needs.</p> </dd> <dt class=hdlist1><a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a></dt> <dd> <p>It is a young project compared with <a href=https://cmake.org/ rel=noopener target=_blank>CMake</a>, but it is growing quite fast and it has been adopted in other big projects like <a href="">Gnome</a>, they have an initiative to <a href=https://wiki.gnome.org/Initiatives/GnomeGoals/MesonPorting>port from Autotools to Meson</a>.</p> </dd> </dl> </div> <div class=paragraph> <p><strong>Finally I’ve chosen</strong> <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> because syntax is really clear to me, when I read <code>meson.build</code> file I can quickly understand what is happening during build process.</p> </div> <div class=listingblock> <div class=title>Steps to compile and test a project</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>$ meson build .  <b class=conum>(1)</b>
$ <span class=hljs-built_in>cd</span> build
$ ninja build    <b class=conum>(2)</b>
$ ninja <span class=hljs-built_in>test</span>     <b class=conum>(3)</b></code></pre> </div> </div> <div class="arabic colist"> <ol> <li> <p>First time you configure the project</p> </li> <li> <p>Each time you build it</p> </li> <li> <p>Each time you run tests</p> </li> </ol> </div> </div> <div class=sect2> <h3 id=_other_build_systems_comparisons>Other build systems comparisons</h3> <div class=paragraph> <p>I’ve found two interesting comparisons about available C++ build systems, they might be a little be biased because those comparisons come from <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> and <a href=https://scons.org/ rel=noopener target=_blank>Scons</a>.</p> </div> <div class=ulist> <ul> <li> <p><a href=https://bitbucket.org/scons/scons/wiki/SconsVsOtherBuildTools>C++ build systems comparison from Scons</a>.</p> </li> <li> <p><a href=https://mesonbuild.com/Simple-comparison.html>C++ build systems comparison from Meson</a>.</p> </li> </ul> </div> </div> </div> </div> <div class=sect1> <h2 id=_unit_testing_framework>Unit Testing Framework</h2> <div class=sectionbody> <div class=paragraph> <p>I have used some <a href=https://en.wikipedia.org/wiki/XUnit rel=noopener target=_blank>xUnit</a> based libraries like <a href=https://github.com/unittest-cpp/unittest-cpp>UnitTest++</a>, <a href=https://cpputest.github.io/ >CppUTest</a> or <a href=https://github.com/google/googletest>Google Test</a> which match perfectly with <a href=https://github.com/google/googletest/tree/master/googlemock>Google Mock</a>. If you want a safe bet that fulfills almost of your testing needs I highly recommend <a href=https://github.com/google/googletest>Google Test</a>.</p> </div> <div class=paragraph> <p>But time ago I found a testing framework with some interesting features, <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>:</p> </div> <div class=ulist> <ul> <li> <p>It is just a header file with no external dependencies, so very easy to start (wget + include downloaded file).</p> </li> <li> <p>You can use normal unit test style or <a href="">BDD</a>-style</p> </li> </ul> </div> <div class=paragraph> <p>If you want to know more about <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>, I recommend you to give it a try, it is a matter of 2 minutes to have a <a href=https://github.com/philsquared/Catch/blob/master/docs/tutorial.md#writing-tests>simple example up and running</a>. You can also read some interesting articles like <a href=https://github.com/philsquared/Catch/blob/master/docs/why-catch.md>Why do we need yet another C test framework?] or https://blog.coldflake.com/posts/Testing-C-with-a-new-Catch/[Testing C++ With A New Catch</a>.</p> </div> <div class=sect2> <h3 id=_doctest_a_catch_alternative><a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a>: A <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a> alternative</h3> <div class=paragraph> <p>There is another testing framework named <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a>, with same benefits as <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>, but it promises to be faster and lighter (<a href=https://github.com/onqtam/doctest/blob/master/doc/markdown/benchmarks.md>performance results</a>) than <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a>.</p> </div> <div class=paragraph> <p><a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> is modeled after <a href=https://github.com/philsquared/Catch rel=noopener target=_blank>Catch</a> and some parts of the code have been taken directly, but there are <a href=https://github.com/onqtam/doctest/blob/master/doc/markdown/faq.md#how-is-doctest-different-from-catch>differences</a>.</p> </div> <div class=paragraph> <p>It hasn’t been easy to decide, both are really similar, following you can see differences:</p> </div> <div class=listingblock> <div class=title>diff between doctest and catch branches</div> <div class=content> <pre class=highlight><code class=language-diff data-lang=diff><span class=hljs-meta>@@ -1,12 +1,12 @@</span>
<span class=hljs-deletion>-#define CATCH_CONFIG_MAIN // It tells Catch to provide a main() - only do this in one cpp file</span>
<span class=hljs-addition>+#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</span>

<span class=hljs-deletion>-#include "catch.hpp"</span>
<span class=hljs-addition>+#include "doctest.h"</span>
#include "Uuid.h"
#include &lt;string>

constexpr int MAX_ITERS = 100;

<span class=hljs-deletion>-TEST_CASE("Uuid", "[uuid]")</span>
<span class=hljs-addition>+TEST_CASE("Uuid")</span>
{
for (int i = 0; i &lt; MAX_ITERS; i++)
{
@@ -26,7 +26,7 @@ TEST_CASE("Uuid", "[uuid]")

// BDD style

<span class=hljs-deletion>-SCENARIO("UUID creation", "[Uuid]")</span>
<span class=hljs-addition>+SCENARIO("UUID creation")</span>
{

GIVEN("A random UUID ")</code></pre> </div> </div> <div class=paragraph> <p>I’ve finally chosen <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> because it promises to be faster: <a href=https://github.com/onqtam/doctest/blob/master/doc/markdown/benchmarks.md>performance results</a>.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class=icon> <div class=title>Note</div> </td> <td class=content> I’ve created project using both frameworks you can find them in corresponding branches: <a href=https://github.com/carlosvin/uuid-cpp/tree/doctest>doctest branch</a> or <a href=https://github.com/carlosvin/uuid-cpp/tree/catch>catch branch</a>. </td> </tr> </table> </div> </div> </div> </div> <div class=sect1> <h2 id=_example>Example</h2> <div class=sectionbody> <div class=paragraph> <p>I’ve created an example to illustrate this article: <a href=https://github.com/carlosvin/uuid-cpp class=bare>https://github.com/carlosvin/uuid-cpp</a>.</p> </div> <div class=paragraph> <p>It is a basic implementation of UUID pseudo-random generator based on <a href=https://www.cplusplus.com/reference/random/mt19937 rel=noopener target=_blank>mt19937</a> which is not cryptographically secure.</p> </div> <div class=sect2> <h3 id=_project_output_artifacts>Project output artifacts</h3> <div class=paragraph> <p>When we install the project using <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a> (<a href=https://ninja-build.org/ rel=noopener target=_blank>Ninja</a>), we will get some artifacts generated and copied in our system.</p> </div> <div class=ulist> <ul> <li> <p>Shared library: <code>libuuid</code>.</p> </li> <li> <p>Header library for developers who want to use the shared library: <code>include/Uuid.h</code>.</p> </li> <li> <p>Executable <code>uuidgen</code> (<a href="">UUID</a> generator).</p> </li> <li> <p>Test executable (not installed). It tests shared library.</p> </li> </ul> </div> <div class=paragraph> <p>For example, if you execute <code>ninja install</code> on Linux, you will get something like:</p> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash>/usr/<span class=hljs-built_in>local</span>/lib/libuuid.so
/usr/<span class=hljs-built_in>local</span>/include/Uuid.h
/usr/<span class=hljs-built_in>local</span>/bin/uuidgen</code></pre> </div> </div> </div> <div class=sect2> <h3 id=_project_structure_fork_project>Project structure (<a href=https://github.com/carlosvin/uuid-cpp>Fork project</a>)</h3> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/meson.build>meson.build</a></dt> <dd> <p>Root project file configuration. It defines project properties and subdirectories.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python>project(
    <span class=hljs-string>'cpp-meson-example'</span>, <span class=hljs-comment># project name</span>
    <span class=hljs-string>'cpp'</span>, <span class=hljs-comment># C++ project, e.g: for C project</span>
    version : <span class=hljs-string>'1.0.0'</span>,
    license : <span class=hljs-string>'MIT'</span>,
    default_options : [<span class=hljs-string>'cpp_std=c++11'</span>]) <span class=hljs-comment># compile for C++</span>

<span class=hljs-comment># it will be referred from subdir projects</span>
inc = include_directories(<span class=hljs-string>'include'</span>)

<span class=hljs-comment># meson will try to find a meson.build file inside following directories</span>
subdir(<span class=hljs-string>'include'</span>)
subdir(<span class=hljs-string>'src'</span>)
subdir(<span class=hljs-string>'test'</span>)</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/include/ >include</a></dt> <dd> <div class=dlist> <dl> <dt class=hdlist1>meson.build</dt> <dd> <p>Build configuration file for include directory.</p> </dd> </dl> </div> </dd> </dl> </div> <div class=listingblock> <div class=title>include/meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python><span class=hljs-comment># Select header files to be installed</span>
install_headers(<span class=hljs-string>'Uuid.h'</span>)</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/include/Uuid.h>Uuid.h</a></dt> <dd> <p>Header file, it is the library interface definition which will be included from projects using that library</p> </dd> </dl> </div> <div class=listingblock> <div class=title>include/Uuid.h</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-keyword>namespace</span> ids {

<span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>Uuid</span> {</span>
    <span class=hljs-keyword>private</span>:
    <span class=hljs-comment>// ...</span></code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src>src</a></dt> <dd> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src/meson.build>meson.build (src)</a></dt> <dd> <p>It declares 2 output artifacts, library <code>libuuid</code> and executable <code>uuidgen</code>. Executable depends on the libary, it will use the libary to generate <a href=https://en.wikipedia.org/wiki/Universally_unique_identifier rel=noopener target=_blank>UUID</a>.</p> </dd> </dl> </div> </dd> </dl> </div> <div class=listingblock> <div class=title>src/meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python>libuuid = shared_library(
    <span class=hljs-string>'uuid'</span>, <b class=conum>(1)</b>
    <span class=hljs-string>'Uuid.cpp'</span>, <b class=conum>(2)</b>
    include_directories : inc, <b class=conum>(3)</b>
    install : true) <b class=conum>(4)</b>

uuidgen = executable(
    <span class=hljs-string>'uuidgen'</span>, <b class=conum>(5)</b>
    <span class=hljs-string>'main.cpp'</span>, <b class=conum>(6)</b>
    include_directories : inc, <b class=conum>(7)</b>
    link_with : libuuid, <b class=conum>(8)</b>
    install : true) <b class=conum>(9)</b></code></pre> </div> </div> <div class="arabic colist"> <ol> <li> <p>library name</p> </li> <li> <p>source files to be compile</p> </li> <li> <p>previously declared include directories in root <code>meson.build</code></p> </li> <li> <p><code>libuuid</code> will be part of project installation</p> </li> <li> <p>executable name</p> </li> <li> <p>source files to compile</p> </li> <li> <p>previously declared include directories in root <code>meson.build</code></p> </li> <li> <p>linking executable with shared previously declared shared library <code>libuuid</code></p> </li> <li> <p><code>uuidgen</code> executable be part of project installation</p> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src/main.cpp>main.cpp</a></dt> <dd> <p>Entry point for main executable <code>uuidgen</code>.</p> </dd> </dl> </div> </li> </ol> </div> <div class=listingblock> <div class=title>src/main.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Uuid.h"</span></span>
<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>&lt;iostream></span></span>

<span class=hljs-function><span class=hljs-keyword>int</span> <span class=hljs-title>main</span><span class=hljs-params>()</span>
</span>{
    ids::Uuid uuid;
    <span class=hljs-built_in>std</span>::<span class=hljs-built_in>cout</span> &lt;&lt; uuid.to_str() &lt;&lt; <span class=hljs-built_in>std</span>::<span class=hljs-built_in>endl</span>;
    <span class=hljs-keyword>return</span> <span class=hljs-number>0</span>;
}</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/src/Uuid.cpp>Uuid.cpp</a></dt> <dd> <p>Implementation of declared class in header file.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>src/Uuid.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Uuid.h"</span></span>

Uuid::Uuid()
{ <span class=hljs-comment>// ...</span></code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/test/ >test</a></dt> <dd> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/test/meson.build>meson.build (test)</a></dt> <dd> <p>File to configure tests build process.</p> </dd> </dl> </div> </dd> </dl> </div> <div class=listingblock> <div class=title>test/meson.build</div> <div class=content> <pre class=highlight><code class=language-python data-lang=python>testexe = executable(
    <span class=hljs-string>'testexe'</span>, <b class=conum>(1)</b>
    <span class=hljs-string>'uuid_test.cpp'</span>, <b class=conum>(2)</b>
    include_directories : inc, <b class=conum>(3)</b>
    link_with : libuuid) <b class=conum>(4)</b>

test(<span class=hljs-string>'Uuid test'</span>, testexe) <b class=conum>(5)</b>

test(<span class=hljs-string>'Uuid test with args and env'</span>, testexe, args : [<span class=hljs-string>'arg1'</span>, <span class=hljs-string>'arg2'</span>], env : [<span class=hljs-string>'FOO=bar'</span>]) <b class=conum>(6)</b></code></pre> </div> </div> <div class="arabic colist"> <ol> <li> <p>test executable name</p> </li> <li> <p>tests source files to be compiled</p> </li> <li> <p>declared include directories in root <code>meson.build</code></p> </li> <li> <p>link test executable with previously declared shared library <code>libuuid</code></p> </li> <li> <p>test execution</p> </li> <li> <p>we can specify other test execution passing arguments or environment variables</p> <div class=dlist> <dl> <dt class=hdlist1>doctest.h</dt> <dd> <p><a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> library in a single header file. You can try to automate library installation as part of your build process, but I haven not figured out yet a way to do it with <a href=https://mesonbuild.com/ rel=noopener target=_blank>Meson</a>. For now, I have installed it manually:</p> </dd> </dl> </div> </li> </ol> </div> <div class=listingblock> <div class=title>Add <a href=https://github.com/onqtam/doctest rel=noopener target=_blank>doctest</a> to your project</div> <div class=content> <pre class=highlight><code class=language-bash data-lang=bash><span class=hljs-built_in>cd</span> <span class=hljs-built_in>test</span>
wget https://raw.githubusercontent.com/onqtam/doctest/master/doctest/doctest.h</code></pre> </div> </div> <div class=dlist> <dl> <dt class=hdlist1><a href=https://github.com/carlosvin/uuid-cpp/blob/master/test/uuid_test.cpp>uuid_test.cpp</a></dt> <dd> <p>Tests implementation.</p> </dd> </dl> </div> <div class=listingblock> <div class=title>test/uuid_test.cpp</div> <div class=content> <pre class=highlight><code class=language-cpp data-lang=cpp><span class=hljs-meta>#<span class=hljs-meta-keyword>define</span> DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</span>

<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"doctest.h"</span></span>
<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>"Uuid.h"</span></span>
<span class=hljs-meta>#<span class=hljs-meta-keyword>include</span> <span class=hljs-meta-string>&lt;string></span></span>

<span class=hljs-keyword>constexpr</span> <span class=hljs-keyword>int</span> MAX_ITERS = <span class=hljs-number>100</span>;

TEST_CASE(<span class=hljs-string>"Uuid"</span>)
{
    <span class=hljs-keyword>for</span> (<span class=hljs-keyword>int</span> i = <span class=hljs-number>0</span>; i &lt; MAX_ITERS; i++)
    {
        ids::Uuid uuid;
        <span class=hljs-built_in>std</span>::<span class=hljs-built_in>string</span> uuid_str{uuid.to_str()};

        INFO(uuid_str);

        <span class=hljs-comment>// If assertion fails test execution is stopped</span>
        REQUIRE(uuid_str.size() == <span class=hljs-number>36</span>);

        <span class=hljs-comment>// If assertion fails test execution continues</span>
        CHECK(uuid.most > <span class=hljs-number>0</span>);
        CHECK(uuid.least > <span class=hljs-number>0</span>);
    }
}

<span class=hljs-comment>// BDD style</span>

SCENARIO(<span class=hljs-string>"UUID creation"</span>)
{

    GIVEN(<span class=hljs-string>"A random UUID "</span>)
    {

        ids::Uuid uuid;
        <span class=hljs-built_in>std</span>::<span class=hljs-built_in>string</span> uuid_str{uuid.to_str()};

        REQUIRE(uuid_str.size() == <span class=hljs-number>36</span>);

        WHEN(<span class=hljs-string>"get the most and least"</span>)
        {
            THEN(<span class=hljs-string>"should be more than 0"</span>)
            {
                CHECK(uuid.most > <span class=hljs-number>0</span>);
                CHECK(uuid.least > <span class=hljs-number>0</span>);
            }
        }
    }
}</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class=icon> <div class=title>Tip</div> </td> <td class=content> You can find how to build and test the example project at: <a href=https://github.com/carlosvin/uuid-cpp#how-to-build-the-example class=bare>https://github.com/carlosvin/uuid-cpp#how-to-build-the-example</a> </td> </tr> </table> </div> </div> </div> </div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.e896aaec.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.e896aaec.js")}document.head.appendChild(s)</script> <script async defer> (function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-1328360-10', 'auto');
		ga('send', 'pageview'); </script> 