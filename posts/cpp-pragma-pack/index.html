<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Understanding pragma pack preprocessor directive and how it affects to memory alignment">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>C++ Struct memory alignment | Carlos says "bla bla"</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../es/rss.xml">
<link rel="canonical" href="https://carlosvin.github.io/posts/cpp-pragma-pack/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="google-site-verification" content="XzkYCjSblA4sHLJDa1Higd_O6P8hudmo6YJRDp5dDDc">
<meta name="msvalidate.01" content="F072D88C59F679193037D42408AD5CE9">
<meta name="yandex-verification" content="c969e485a9e92311">
<meta name="description" itemprop="description" content="Understanding pragma pack preprocessor directive and how it affects to memory alignment">
<meta name="author" content="Carlos Martín Sánchez">
<link rel="prev" href="../git-proxy-config/" title="Git proxy configuration" type="text/html">
<link rel="next" href="../debug-libtool-lib/" title="Depurar librería generada con libtool" type="text/html">
<meta property="og:site_name" content='Carlos says "bla bla"'>
<meta property="og:title" content="C++ Struct memory alignment">
<meta property="og:url" content="https://carlosvin.github.io/posts/cpp-pragma-pack/">
<meta property="og:description" content="Understanding pragma pack preprocessor directive and how it affects to memory alignment">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2012-11-26T12:00:00+01:00">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="Compilers">
<meta property="article:tag" content="Performance">
<link rel="alternate" hreflang="es" href="../../es/posts/cpp-pragma-pack/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md navbar-dark bg-dark static-top mb-4"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://carlosvin.github.io/">

            <span id="blog-title">Carlos says "bla bla"</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../../categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS</a>

                
            </li>
</ul>
<form method="get" action="http://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<input type="hidden" name="sitesearch" value="https://carlosvin.github.io/">
</form>


            <ul class="navbar-nav navbar-right">
<li>
            </li>
<li class="nav-item"><a href="https://carlosvin.github.io/es/" rel="alternate" hreflang="es" class="nav-link">Español</a></li>

                
                    
    
    <li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">C++ Struct memory alignment</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Carlos Martín Sánchez
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2012-11-26T12:00:00+01:00" itemprop="datePublished" title="2012-11-26">2012-11-26</time></a></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/cpp-pragma-pack.en.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        
        <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">Also available in:</h3>
                <p><a href="../../es/posts/cpp-pragma-pack/" rel="alternate" hreflang="es">Español</a></p>
        </div>

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>A C++ struct is an element that allows grouping attributes with different type so we can manipulate all elements together using same reference. It is like a class with public visibility by default for functions and attributes.</p>
<p>If we want to work in a lower level, closer to machine, it might be useful understand how that data structure is stored in memory and how to control that mapping.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#example-struct" id="id1">Example Struct</a></li>
<li><a class="reference internal" href="#pragma-pack-directive-in-c-struct" id="id2">#pragma pack directive in C++ struct</a></li>
<li><a class="reference internal" href="#performance-test" id="id3">Performance test</a></li>
</ul>
</div>
<!-- TEASER_END -->
<div class="section" id="example-struct">
<h2><a class="toc-backref" href="#id1">Example Struct</a></h2>
<p>It has two attributes: an integer (4 bytes) and a boolean (1 byte).</p>
<pre class="code c++"><a name="rest_code_e869a08529d34a0c9596adf6c3327eb6-1"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_e869a08529d34a0c9596adf6c3327eb6-2"></a><span class="p">{</span>
<a name="rest_code_e869a08529d34a0c9596adf6c3327eb6-3"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_e869a08529d34a0c9596adf6c3327eb6-4"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_e869a08529d34a0c9596adf6c3327eb6-5"></a><span class="p">};</span>
</pre>
<p>If we get the instance size using <code>sizeof</code> we should get 5 bytes size and memory would be like:</p>
<div class="figure" style="width: 50%">
<img alt="/galleries/c-mem-struct/5b.png" src="../../galleries/c-mem-struct/5b.png" style="width: 30%;"><p class="caption">5 bytes struct which uses 5 bytes in memory</p>
</div>
<p><strong>But</strong> is not that simple, following we will see that we can't forget about memory alignment which depends on compiler and system. We will learn how to control compiler alignment policy, so we can avoid getting unexpected allocation memory sizes.</p>
<p>For example, in my local host with <code>sizeof</code> of structure, I get a 8 bytes size. What is happening is that compiler allocates more memory at the end of structure so it fits in 2n bytes blocks. Memory looks like:</p>
<div class="figure" style="width: 50%">
<img alt="/galleries/c-mem-struct/8b.png" src="../../galleries/c-mem-struct/8b.png" style="width: 30%;"><p class="caption">5 bytes structure that actually spends 8 bytes in memory</p>
</div>
<p>Let's see a code snippet that prints structure and attributes size, in this case <strong>4 + 1 is not 5</strong>.</p>
<pre class="code c++"><a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-1"></a><span class="cp">#include</span>  <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-2"></a>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-3"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-4"></a>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-5"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-6"></a><span class="p">{</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-7"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-8"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-9"></a><span class="p">};</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-10"></a>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-11"></a><span class="k">static</span> <span class="kt">void</span> <span class="nf">print</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">sz</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_flag</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_timeout</span><span class="p">)</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-12"></a><span class="p">{</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-13"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">flag: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-14"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">+"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-15"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">timeout: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-16"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">="</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-17"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\t</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">+</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-18"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="s">"sizeof struct:  "</span> <span class="o">&lt;&lt;</span> <span class="n">sz</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-19"></a><span class="p">}</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-20"></a>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-21"></a><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-22"></a><span class="p">{</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-23"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStruct"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-24"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-25"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" -- "</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-26"></a>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-27"></a>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<a name="rest_code_f773d01b3fbc483ebe9cbf10071ec32f-28"></a><span class="p">}</span>
</pre>
<p><a class="reference external" href="http://coliru.stacked-crooked.com/a/7c18ee6585e57366">Executing code with pragma pack directive</a>,  8 bytes en lugar de 5 bytes.</p>
<pre class="code bash"><a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-1"></a>SampleStruct
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-2"></a>flag: <span class="m">1</span> Bytes
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-3"></a>+
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-4"></a>timeout: <span class="m">4</span> <span class="nv">Bytes</span>
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-5"></a><span class="o">=</span>
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-6"></a><span class="m">5</span> Bytes
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-7"></a>sizeof struct:  <span class="m">8</span> Bytes
<a name="rest_code_9cfded29e36b4631b5899bdc4badc7d8-8"></a>--
</pre>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If we want to know the exact structure size we have to specify compiler the way how to align memory, to do so we have <code>#pragma pack(n)</code> directive.</p>
</div>
</div>
<div class="section" id="pragma-pack-directive-in-c-struct">
<h2><a class="toc-backref" href="#id2">#pragma pack directive in C++ struct</a></h2>
<p>It is a preprocessor directive to indicate to compiler how to align data in memory.</p>
<pre class="code c++"><a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-1"></a><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-2"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-3"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-4"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-5"></a><span class="k">static</span> <span class="kt">void</span> <span class="nf">print</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">sz</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_flag</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">sz_timeout</span><span class="p">)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-6"></a><span class="p">{</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-7"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" flag: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-8"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" +"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-9"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" timeout: "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">&lt;&lt;</span> <span class="s">"Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-10"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" ="</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-11"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">sz_timeout</span> <span class="o">+</span> <span class="n">sz_flag</span> <span class="o">&lt;&lt;</span> <span class="s">"Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-12"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" sizeof struct:  "</span> <span class="o">&lt;&lt;</span> <span class="n">sz</span> <span class="o">&lt;&lt;</span> <span class="s">" Bytes"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-13"></a><span class="p">}</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-14"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-15"></a><span class="cp">#pragma pack (1)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-16"></a><span class="k">struct</span> <span class="n">SampleStructPack1</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-17"></a><span class="p">{</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-18"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-19"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-20"></a><span class="p">};</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-21"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-22"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-23"></a><span class="cp">#pragma pack (2)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-24"></a><span class="k">struct</span> <span class="n">SampleStructPack2</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-25"></a><span class="p">{</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-26"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-27"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-28"></a><span class="p">};</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-29"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-30"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-31"></a><span class="cp">#pragma pack (4)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-32"></a><span class="k">struct</span> <span class="n">SampleStructPack4</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-33"></a><span class="p">{</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-34"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-35"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-36"></a><span class="p">};</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-37"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-38"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-39"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-40"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-41"></a><span class="p">{</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-42"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-43"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-44"></a><span class="p">};</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-45"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-46"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-47"></a><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-48"></a><span class="p">{</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-49"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-50"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack1"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-51"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack1</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack1</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack1</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-52"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" -- "</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-53"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-54"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack2"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-55"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack2</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack2</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack2</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-56"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-57"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack4"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-58"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack4</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack4</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStructPack4</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-59"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-60"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStruct"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-61"></a>    <span class="n">print</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">flag</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SampleStruct</span><span class="o">::</span><span class="n">timeout</span><span class="p">));</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-62"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" -- "</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-63"></a>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-64"></a>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<a name="rest_code_12a0f1d39e6d42bdbd71ddbab46e536f-65"></a><span class="p">}</span>
</pre>
<p><a class="reference external" href="http://coliru.stacked-crooked.com/a/7c18ee6585e57366">Executing code with pragma pack directive</a>, we have different results depending of pragma value.</p>
<pre class="code bash"><a name="rest_code_2c15fb266b8a42de97195e802d13d35a-1"></a>SampleStructPack1
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-2"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-3"></a> +
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-4"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-5"></a> <span class="o">=</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-6"></a> 5Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-7"></a> sizeof struct:  <span class="m">5</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-8"></a> --
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-9"></a>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-10"></a>SampleStructPack2
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-11"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-12"></a> +
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-13"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-14"></a> <span class="o">=</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-15"></a> 5Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-16"></a> sizeof struct:  <span class="m">6</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-17"></a>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-18"></a>SampleStructPack4
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-19"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-20"></a> +
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-21"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-22"></a> <span class="o">=</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-23"></a> 5Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-24"></a> sizeof struct:  <span class="m">8</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-25"></a>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-26"></a>SampleStruct
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-27"></a> flag: <span class="m">1</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-28"></a> +
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-29"></a> timeout: <span class="nv">4Bytes</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-30"></a> <span class="o">=</span>
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-31"></a> 5Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-32"></a> sizeof struct:  <span class="m">8</span> Bytes
<a name="rest_code_2c15fb266b8a42de97195e802d13d35a-33"></a> --
</pre>
<p>Let's analyze those results:</p>
<dl class="docutils">
<dt>SampleStructPack1 <code>#pragma pack (1)</code>
</dt>
<dd>It allocates 1 byte memory block, so our sample struct fits perfectly, in this case it is true that <code>4 + 1 = 5</code>.</dd>
<dt>SampleStructPack2 <code>#pragma pack (2)</code>
</dt>
<dd>Minimum block size is 2 bytes. Integer attribute fits because it just needs 2 blocks of 2 Bytes. Boolean attribute needs just 1 Byte, but minimum block size is 2 Bytes, that's why total allocated memory is 6 bytes, <code>4 + 2 = 6</code>.</dd>
<dt>SampleStructPack4 <code>#pragma pack (4)</code>
</dt>
<dd>It is like previous one, but in this case we are wasting more memory for boolean attribute, it needs 1 Byte, but we are allocating 4 Bytes.</dd>
<dt>SampleStruct (alineación por defecto del compilador)</dt>
<dd>As you can see it behaves exactly like <code>#pragma pack (4)</code>, so we can deduct it is the default compiler alignment.</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Why don't we always use smallest memory alignment (<code>#pragma pack (1)</code>) so we can save more memory?</p>
<div class="admonition warning last">
<p class="first admonition-title">Warning</p>
<p class="last">Because of performance loss.</p>
</div>
</div>
</div>
<div class="section" id="performance-test">
<h2><a class="toc-backref" href="#id3">Performance test</a></h2>
<p>Test consists of allocate same number of elements in arrays for each structure type (1, 2, 4).</p>
<pre class="code bash"><a name="rest_code_68f47c6f66e34090b84026266f32256c-1"></a>SampleStructPack1: <span class="m">500000000000000000</span> bytes allocated in <span class="m">94311</span> nanoseconds
<a name="rest_code_68f47c6f66e34090b84026266f32256c-2"></a>SampleStructPack2: <span class="m">600000000000000000</span> bytes allocated in <span class="m">1777</span> nanoseconds
<a name="rest_code_68f47c6f66e34090b84026266f32256c-3"></a>SampleStructPack4: <span class="m">800000000000000000</span> bytes allocated in <span class="m">1519</span> nanoseconds
</pre>
<p>As you can see, the smallest memory alignment spends more time allocating and releasing memory. Puedes <a class="reference external" href="http://coliru.stacked-crooked.com/a/954ad542659c7591">execute performance test</a>.</p>
<p>Performance test source code:</p>
<pre class="code c++"><a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-1"></a><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-2"></a><span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp"></span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-3"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-4"></a><span class="cp">#pragma pack (1)</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-5"></a><span class="k">struct</span> <span class="n">SampleStructPack1</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-6"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-7"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-8"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-9"></a><span class="p">};</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-10"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-11"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-12"></a><span class="cp">#pragma pack (2)</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-13"></a><span class="k">struct</span> <span class="n">SampleStructPack2</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-14"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-15"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-16"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-17"></a><span class="p">};</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-18"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-19"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-20"></a><span class="cp">#pragma pack (4)</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-21"></a><span class="k">struct</span> <span class="n">SampleStructPack4</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-22"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-23"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-24"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-25"></a><span class="p">};</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-26"></a><span class="cp">#pragma pack(0)</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-27"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-28"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-29"></a><span class="k">struct</span> <span class="n">SampleStruct</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-30"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-31"></a>    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-32"></a>    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-33"></a><span class="p">};</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-34"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-35"></a><span class="k">static</span> <span class="k">const</span> <span class="kt">long</span> <span class="n">MAX_ELEMENTS</span> <span class="o">=</span> <span class="mi">100000000000000000</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-36"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-37"></a><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-38"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-39"></a><span class="kt">void</span> <span class="nf">allocate1</span><span class="p">()</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-40"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-41"></a>    <span class="n">SampleStructPack1</span> <span class="n">elements</span> <span class="p">[</span><span class="n">MAX_ELEMENTS</span><span class="p">];</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-42"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack1: "</span> <span class="o">&lt;&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" bytes allocated"</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-43"></a><span class="p">}</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-44"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-45"></a><span class="kt">void</span> <span class="nf">allocate2</span><span class="p">()</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-46"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-47"></a>    <span class="n">SampleStructPack2</span> <span class="n">elements</span> <span class="p">[</span><span class="n">MAX_ELEMENTS</span><span class="p">];</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-48"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack2: "</span> <span class="o">&lt;&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" bytes allocated"</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-49"></a><span class="p">}</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-50"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-51"></a><span class="kt">void</span> <span class="nf">allocate4</span><span class="p">()</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-52"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-53"></a>    <span class="n">SampleStructPack4</span> <span class="n">elements</span> <span class="p">[</span><span class="n">MAX_ELEMENTS</span><span class="p">];</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-54"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SampleStructPack4: "</span> <span class="o">&lt;&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" bytes allocated"</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-55"></a><span class="p">}</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-56"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-57"></a><span class="kt">void</span> <span class="nf">chrono1</span><span class="p">()</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-58"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-59"></a>    <span class="k">auto</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-60"></a>    <span class="n">allocate1</span><span class="p">();</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-61"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" in "</span> <span class="o">&lt;&lt;</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" nanoseconds"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-62"></a><span class="p">}</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-63"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-64"></a><span class="kt">void</span> <span class="nf">chrono2</span><span class="p">()</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-65"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-66"></a>    <span class="k">auto</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-67"></a>    <span class="n">allocate2</span><span class="p">();</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-68"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" in "</span> <span class="o">&lt;&lt;</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" nanoseconds"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-69"></a><span class="p">}</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-70"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-71"></a><span class="kt">void</span> <span class="nf">chrono4</span><span class="p">()</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-72"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-73"></a>    <span class="k">auto</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-74"></a>    <span class="n">allocate4</span><span class="p">();</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-75"></a>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" in "</span> <span class="o">&lt;&lt;</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" nanoseconds"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-76"></a><span class="p">}</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-77"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-78"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-79"></a><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-80"></a><span class="p">{</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-81"></a>    <span class="n">chrono1</span><span class="p">();</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-82"></a>    <span class="n">chrono2</span><span class="p">();</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-83"></a>    <span class="n">chrono4</span><span class="p">();</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-84"></a>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-85"></a>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<a name="rest_code_69909bb1c0174a73ac0e3a5be5f2663d-86"></a><span class="p">}</span>
</pre>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/c%2B%2B/" rel="tag">C++</a></li>
            <li><a class="tag p-category" href="../../categories/compilers/" rel="tag">Compilers</a></li>
            <li><a class="tag p-category" href="../../categories/performance/" rel="tag">Performance</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../git-proxy-config/" rel="prev" title="Git proxy configuration">Previous post</a>
            </li>
            <li class="next">
                <a href="../debug-libtool-lib/" rel="next" title="Depurar librería generada con libtool">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="carlosvin",
            disqus_url="https://carlosvin.github.io/posts/cpp-pragma-pack/",
        disqus_title="C++ Struct memory alignment",
        disqus_identifier="cache/posts/cpp-pragma-pack.en.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="carlosvin";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer"><div style="display=flex-inline; vertical-align=middle">
        <a href="https://www.linkedin.com/in/carlosvin" style="margin-right: 3%;">Carlos Martín Sánchez</a>
        <a href="https://twitter.com/carlosvin" class="twitter-follow-button" style="float: right;" data-show-count="false">Follow @carlosvin</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
    <br>
    Contents © 2018 - 
    
   <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
   <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a> - 
    Powered by <a href="http://getnikola.com" rel="nofollow">Nikola</a>
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1328360-9', 'carlosvin.github.io');
  ga('send', 'pageview');

</script><!-- Start of StatCounter Code for Default Guide --><script type="text/javascript">
var sc_project=9708205;
var sc_invisible=1;
var sc_security="4998d447";
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script><noscript><div class="statcounter"><a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="http://c.statcounter.com/9708205/0/4998d447/1/" alt="web analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->


</body>
</html>
