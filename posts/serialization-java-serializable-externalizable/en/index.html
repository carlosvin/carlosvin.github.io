<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=sapper name=generator> <meta content=a22af7614c96254d name=yandex-verification> <link href=/icons/icon-192x192.png rel=apple-touch-icon> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.894811689.css rel=stylesheet><link href=client/[...slug].3c0a908a.css rel=stylesheet><link href=client/client.f9aecfa1.css rel=stylesheet><link href=client/OtherLangs.a6141782.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Java serialization ways: Performance Comparison</title><link href=/rss rel=alternate type=application/rss+xml title='Subscribe to Carlos dice "bla bla"'><meta content=2014/05/13 name=date scheme=YYYY-MM-DD><meta content="Java serialization ways, performance comparison" name=description><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/vs.min.css rel=preload as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/vs.min.css rel=stylesheet></noscript><link href=/posts/serialization-java-serializable-externalizable/es rel=alternate hreflang=es><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-1v6ow72><button class=svelte-1v6ow72>≡</button> <ul class="svelte-1v6ow72 closed"><li class=svelte-1y8uoef><a href=. class=svelte-1y8uoef>Carlos dice "bla bla"</a></li> <li class=svelte-1y8uoef><a href=categories class=svelte-1y8uoef>Categories</a></li> <li class=svelte-1y8uoef><a href=about class=svelte-1y8uoef>About</a></ul> <div class="h svelte-1w8skyw"><a href=/rss rel=noopener target=_blank class="icon svelte-1lu397 rss" title='Subscribe to Carlos dice "bla bla"'></a> <a href=https://github.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 github" title="Find me at github"></a> <a href=https://twitter.com/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 twitter" title="Find me at twitter"></a> <a href=https://stackoverflow.com/story/carlosvin rel=noopener target=_blank class="icon svelte-1lu397 stackoverflow" title="Find me at stackoverflow"></a></div></nav> <main class=svelte-1m42syy> <header class=svelte-1knthhj><h1 class=svelte-1knthhj>Java serialization ways: Performance Comparison <span class="svelte-1knthhj share"><a href="https://twitter.com/intent/tweet?url=https://carlosvin.github.io/posts/serialization-java-serializable-externalizable/en&text=Java serialization ways: Performance Comparison: Java serialization ways, performance comparison&hashtags=Java,Performance" rel=noopener target=_blank class="icon svelte-1lu397 twitter" title='Share "Java serialization ways: Performance Comparison"'></a></span></h1> <p class="svelte-1knthhj description">Java serialization ways, performance comparison <span class="svelte-1hlui58 langs summary">Available in <span class="svelte-1hlui58 lang"><a href=/posts/serialization-java-serializable-externalizable/es rel=prefetch>es</a> </span></span></header> <div class="content svelte-1knthhj"><div class=toc id=toc> <div id=toctitle>Table of Contents</div> <ul class=sectlevel1> <li><a href=#_serializable>Serializable</a></li> <li><a href=#_externalizable>Externalizable</a></li> <li><a href=#_performance_tests_serializable_vs_externalizable>Performance tests (Serializable vs. Externalizable)</a> <ul class=sectlevel2> <li><a href=#_implementing_serializable>Implementing Serializable</a></li> <li><a href=#_implementing_externalizable_wrong_way>Implementing Externalizable (wrong way)</a></li> <li><a href=#_implementing_externalizable_right_way>Implementing Externalizable (right way)</a></li> <li><a href=#_results_analysis>Results Analysis</a></li> </ul> </li> </ul> </div> <div id=preamble> <div class=sectionbody> <div class=paragraph> <p>Recently I’ve had to serialize/deserialize some data in <a href=https://www.java.com rel=noopener target=_blank>Java</a> binary format. Lately I use <a href=https://www.json.org rel=noopener target=_blank>JSON</a> or <a href=https://en.wikipedia.org/wiki/XML rel=noopener target=_blank>XML</a> formats.</p> </div> <div class=paragraph> <p>I remember that to serialize <a href=https://www.java.com rel=noopener target=_blank>Java</a> objects they must implement the <a href=https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html rel=noopener target=_blank>Serializable</a> interface, but I had also read in Internet other way, implementing the <a href=https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html rel=noopener target=_blank>Externalizable</a> interface, then, which interface must I implement? It depends on what you want such as everything in the life.</p> </div> <div class=paragraph> <p>When to use <a href=#_serializable>Serializable</a> or <a href=#_externalizable>Externalizable</a>.</p> </div> </div> </div> <div class=sect1> <h2 id=_serializable>Serializable</h2> <div class=sectionbody> <div class=ulist> <ul> <li> <p>To serialize easily. You have to write less code.</p> </li> <li> <p>This way has some restrictions: The object to serialize must implement the default constructor (0 args). It must be responsible to manage the parent class attributes.</p> </li> <li> <p>The performance is not as important, we will see more about that in <a href=#_performance_tests_serializable_vs_externalizable>Performance tests (Serializable vs. Externalizable)</a>.</p> </li> </ul> </div> </div> </div> <div class=sect1> <h2 id=_externalizable>Externalizable</h2> <div class=sectionbody> <div class=ulist> <ul> <li> <p>You must implement the serialization/deserialization methods, so you have to write more code.</p> </li> <li> <p>When you cannot use <a href=#_serializable>Serializable</a>.</p> </li> <li> <p>When you want to improve the performance, as we’ll see in <a href=#_performance_tests_serializable_vs_externalizable>Performance tests (Serializable vs. Externalizable)</a>.</p> </li> <li> <p>If you have to manage the serialization of parent class attributes, then I recommend you use <a href=https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html rel=noopener target=_blank>Externalizable</a>, because we’ll avoid a weird private methods overriding.</p> </li> </ul> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-java data-lang=java><span class=hljs-function><span class=hljs-keyword>private</span> <span class=hljs-keyword>void</span> <span class=hljs-title>writeObject</span><span class=hljs-params>(ObjectOutputStream oos)</span>
<span class=hljs-keyword>private</span> <span class=hljs-keyword>void</span> <span class=hljs-title>readObject</span><span class=hljs-params>(ObjectInputStream ois)</span></span></code></pre> </div> </div> </div> </div> <div class=sect1> <h2 id=_performance_tests_serializable_vs_externalizable>Performance tests (Serializable vs. Externalizable)</h2> <div class=sectionbody> <div class=paragraph> <p><a href=#_serializable>Serializable</a>: Java, through introspection, guesses the types of class attributes to know how to serialize/deserialize them, but this "magic" is not free, it has a performance penalty.</p> </div> <div class=paragraph> <p>When we use <a href=#_externalizable>Externalizable</a> interface, we decide how to serialize/deserialize, namely we have to write the code that does it. We’ve lost ease, but also we avoid that <a href=https://www.java.com rel=noopener target=_blank>Java</a> does some tasks, so if we override the methods properly, we’ll get a performance improvement.</p> </div> <div class=paragraph> <p>To know how big is the performance difference between both interfaces, I’ve written a <a href=https://github.com/carlosvin/serializations-performance-java rel=noopener target=_blank>tiny example in which we serialize an object with 2 collections with 100000 elements each one</a>. Here you can find the <a href=http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html rel=noopener target=_blank>tests execution results</a>. There are 3 different implementations:</p> </div> <div class=sect2> <h3 id=_implementing_serializable>Implementing Serializable</h3> <div class=paragraph> <p>As we mentioned above, <a href=https://www.java.com rel=noopener target=_blank>Java</a> has to guess certain things. During this process it sacrifices some of performance (slowest way), in exchange we get really simple source code, the class to serialize just has to implement the <a href=https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html rel=noopener target=_blank>Serializable</a> interface.</p> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-java data-lang=java><span class=hljs-keyword>public</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>Contacts</span> <span class=hljs-keyword>implements</span> <span class=hljs-title>Serializable</span> </span>{
  <span class=hljs-comment>// ...</span>
}</code></pre> </div> </div> <div class=ulist> <ul> <li> <p>serializing: 1133 millisecond</p> </li> <li> <p>deserializing: 506 millisecond</p> </li> </ul> </div> </div> <div class=sect2> <h3 id=_implementing_externalizable_wrong_way>Implementing Externalizable (wrong way)</h3> <div class=paragraph> <p>If the class implements <a href=https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html rel=noopener target=_blank>Externalizable</a>, we must tell to <a href=https://www.java.com rel=noopener target=_blank>Java</a> how it has to serialize/deserialize the class attributes. We just have to be careful, because if we did it bad, then we’ll get the worst of the both worlds: more complex implementation and bad performance, i.e: If we serialize/deserialize complex class attributes (like collections), <a href=https://www.java.com rel=noopener target=_blank>Java</a> will also have to guess many things about the attributes type.</p> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-java data-lang=java><span class=hljs-meta>@Override</span>
<span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>readExternal</span><span class=hljs-params>(ObjectInput in)</span> <span class=hljs-keyword>throws</span> IOException, ClassNotFoundException </span>{
  setEmails((Set&lt;String>) in.readObject());
  setPhones((Set&lt;String>) in.readObject());
}

<span class=hljs-meta>@Override</span>
<span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>writeExternal</span><span class=hljs-params>(ObjectOutput out)</span> <span class=hljs-keyword>throws</span> IOException </span>{
  out.writeObject(emails);
  out.writeObject(phones);
}</code></pre> </div> </div> <div class=ulist> <ul> <li> <p>serializing: 737 millisecond</p> </li> <li> <p>deserializing: 367 millisecond</p> </li> </ul> </div> </div> <div class=sect2> <h3 id=_implementing_externalizable_right_way>Implementing Externalizable (right way)</h3> <div class=paragraph> <p>If we serialize one by one the collection elements, then we’ll save more time, because <a href=https://www.java.com rel=noopener target=_blank>Java</a> serializes simple types, this way avoids guessing things that we actually know.</p> </div> <div class=listingblock> <div class=content> <pre class=highlight><code class=language-java data-lang=java><span class=hljs-meta>@Override</span>
<span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>readExternal</span><span class=hljs-params>(ObjectInput in)</span> <span class=hljs-keyword>throws</span> IOException, ClassNotFoundException </span>{
  emails.clear();
  phones.clear();
  <span class=hljs-keyword>int</span> nEmails = in.readInt();
  <span class=hljs-keyword>for</span> (<span class=hljs-keyword>int</span> i = <span class=hljs-number>0</span>; i &lt; nEmails; i++) {
    emails.add(in.readUTF());
  }
  <span class=hljs-keyword>int</span> nPhones = in.readInt();
  <span class=hljs-keyword>for</span> (<span class=hljs-keyword>int</span> i = <span class=hljs-number>0</span>; i &lt; nPhones; i++) {
    phones.add(in.readUTF());
  }
}

<span class=hljs-meta>@Override</span>
<span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>writeExternal</span><span class=hljs-params>(ObjectOutput out)</span> <span class=hljs-keyword>throws</span> IOException </span>{
  out.writeInt(emails.size());
  <span class=hljs-keyword>for</span> (String e : emails) {
    out.writeUTF(e);
  }
  out.writeInt(phones.size());
  <span class=hljs-keyword>for</span> (String p : phones) {
    out.writeUTF(p);
  }
}</code></pre> </div> </div> <div class=ulist> <ul> <li> <p>serializing: 204 millisecond</p> </li> <li> <p>deserializing: 92 millisecond</p> </li> </ul> </div> <div class=paragraph> <p>We’ve gained performance at expense of write more code.</p> </div> </div> <div class=sect2> <h3 id=_results_analysis>Results Analysis</h3> <div class=paragraph> <p>We don’t gain performance due to use an interface or the other one.</p> </div> <div class=paragraph> <p>We gain performance because <a href=#_externalizable>Externalizable</a> interface forces us to implement ourselves the guessing code, so <a href=https://www.java.com rel=noopener target=_blank>Java</a> doesn’t have to do that.</p> </div> <div class=paragraph> <p>As we have seen at <a href=#_implementing_externalizable_wrong_way>Implementing Externalizable (wrong way)</a>, si no tenemos cuidado, conseguiremos una mejora poco significativa a costa de complicar nuestro código fuente.</p> </div> <div class=ulist> <ul> <li> <p><a href=http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html rel=noopener target=_blank>Test results</a>.</p> </li> <li> <p><a href=https://github.com/carlosvin/serializations-performance-java/ >Code in Github</a>.</p> </li> </ul> </div> </div> </div> </div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,(function(a,b,c,d,e,f,g){return {post:{sectids:a,"toc-placement":"auto",notitle:a,stylesheet:a,webfonts:a,prewrap:a,"attribute-undefined":"drop-line","attribute-missing":"skip","iconfont-remote":a,"caution-caption":"Caution","important-caption":"Important","note-caption":"Note","tip-caption":"Tip","warning-caption":"Warning","example-caption":"Example","figure-caption":"Figure","table-caption":"Table","toc-title":"Table of Contents","section-refsig":"Section","part-refsig":"Part","chapter-refsig":"Chapter","appendix-refsig":c,"appendix-caption":c,"untitled-label":"Untitled","version-label":"Version","last-update-label":"Last updated",docfile:"serialization-java-serializable-externalizable.en.adoc",docdir:a,docfilesuffix:".adoc",docname:"serialization-java-serializable-externalizable.en",embedded:a,asciidoctor:a,"asciidoctor-version":"2.0.10","safe-mode-name":"secure","safe-mode-secure":a,"safe-mode-level":20,"max-include-depth":64,"user-home":d,backend:"html5","max-attribute-value-size":4096,linkcss:a,doctype:"article",htmlsyntax:b,"backend-html5-doctype-article":a,"doctype-article":a,"backend-html5":a,outfilesuffix:".html",filetype:b,"filetype-html":a,"basebackend-html-doctype-article":a,"basebackend-html":a,basebackend:b,stylesdir:d,iconsdir:".\u002Fimages\u002Ficons",localdate:"2020-05-01",localyear:e,localtime:"03:34:16 +0200",localdatetime:"2020-05-01 03:34:16 +0200",docdate:"2020-04-19",docyear:e,doctime:"10:46:31 +0200",docdatetime:"2020-04-19 10:46:31 +0200",doctitle:f,date:"2014\u002F05\u002F13 17:00:00",lang:"en",toc:a,description:g,keywords:["Java","Performance"],java:"https:\u002F\u002Fwww.java.com[Java,window=_blank]",json:"https:\u002F\u002Fwww.json.org[JSON,window=_blank]",xml:"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FXML[XML,window=_blank]",serializable:"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FSerializable.html[Serializable,window=_blank]",externalizable:"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FExternalizable.html[Externalizable,window=_blank]",authorcount:0,title:f,summary:g,html:"\u003Cdiv id=\"toc\" class=\"toc\"\u003E\n\u003Cdiv id=\"toctitle\"\u003ETable of Contents\u003C\u002Fdiv\u003E\n\u003Cul class=\"sectlevel1\"\u003E\n\u003Cli\u003E\u003Ca href=\"#_serializable\"\u003ESerializable\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#_externalizable\"\u003EExternalizable\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#_performance_tests_serializable_vs_externalizable\"\u003EPerformance tests (Serializable vs. Externalizable)\u003C\u002Fa\u003E\n\u003Cul class=\"sectlevel2\"\u003E\n\u003Cli\u003E\u003Ca href=\"#_implementing_serializable\"\u003EImplementing Serializable\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#_implementing_externalizable_wrong_way\"\u003EImplementing Externalizable (wrong way)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#_implementing_externalizable_right_way\"\u003EImplementing Externalizable (right way)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#_results_analysis\"\u003EResults Analysis\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv id=\"preamble\"\u003E\n\u003Cdiv class=\"sectionbody\"\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003ERecently I&#8217;ve had to serialize\u002Fdeserialize some data in \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E binary format. Lately I use \u003Ca href=\"https:\u002F\u002Fwww.json.org\" target=\"_blank\" rel=\"noopener\"\u003EJSON\u003C\u002Fa\u003E or \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FXML\" target=\"_blank\" rel=\"noopener\"\u003EXML\u003C\u002Fa\u003E formats.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EI remember that to serialize \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E objects they must implement the \u003Ca href=\"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FSerializable.html\" target=\"_blank\" rel=\"noopener\"\u003ESerializable\u003C\u002Fa\u003E interface, but I had also read in Internet other way, implementing the \u003Ca href=\"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FExternalizable.html\" target=\"_blank\" rel=\"noopener\"\u003EExternalizable\u003C\u002Fa\u003E interface, then, which interface must I implement? It depends on what you want such as everything in the life.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EWhen to use \u003Ca href=\"#_serializable\"\u003ESerializable\u003C\u002Fa\u003E or \u003Ca href=\"#_externalizable\"\u003EExternalizable\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect1\"\u003E\n\u003Ch2 id=\"_serializable\"\u003ESerializable\u003C\u002Fh2\u003E\n\u003Cdiv class=\"sectionbody\"\u003E\n\u003Cdiv class=\"ulist\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003ETo serialize easily. You have to write less code.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EThis way has some restrictions: The object to serialize must implement the default constructor (0 args). It must be responsible to manage the parent class attributes.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EThe performance is not as important, we will see more about that in \u003Ca href=\"#_performance_tests_serializable_vs_externalizable\"\u003EPerformance tests (Serializable vs. Externalizable)\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect1\"\u003E\n\u003Ch2 id=\"_externalizable\"\u003EExternalizable\u003C\u002Fh2\u003E\n\u003Cdiv class=\"sectionbody\"\u003E\n\u003Cdiv class=\"ulist\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EYou must implement the serialization\u002Fdeserialization methods, so you have to write more code.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EWhen you cannot use \u003Ca href=\"#_serializable\"\u003ESerializable\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EWhen you want to improve the performance, as we&#8217;ll see in \u003Ca href=\"#_performance_tests_serializable_vs_externalizable\"\u003EPerformance tests (Serializable vs. Externalizable)\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EIf you have to manage the serialization of parent class attributes, then I recommend you use \u003Ca href=\"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FExternalizable.html\" target=\"_blank\" rel=\"noopener\"\u003EExternalizable\u003C\u002Fa\u003E, because we&#8217;ll avoid a weird private methods overriding.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"listingblock\"\u003E\n\u003Cdiv class=\"content\"\u003E\n\u003Cpre class=\"highlight\"\u003E\u003Ccode class=\"language-java\" data-lang=\"java\"\u003E\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Eprivate\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EwriteObject\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-params\"\u003E(ObjectOutputStream oos)\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eprivate\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EreadObject\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-params\"\u003E(ObjectInputStream ois)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect1\"\u003E\n\u003Ch2 id=\"_performance_tests_serializable_vs_externalizable\"\u003EPerformance tests (Serializable vs. Externalizable)\u003C\u002Fh2\u003E\n\u003Cdiv class=\"sectionbody\"\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003E\u003Ca href=\"#_serializable\"\u003ESerializable\u003C\u002Fa\u003E: Java, through introspection, guesses the types of class attributes to know how to serialize\u002Fdeserialize them, but this \"magic\" is not free, it has a performance penalty.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EWhen we use \u003Ca href=\"#_externalizable\"\u003EExternalizable\u003C\u002Fa\u003E interface, we decide how to serialize\u002Fdeserialize, namely we have to write the code that does it. We&#8217;ve lost ease, but also we avoid that \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E does some tasks, so if we override the methods properly, we&#8217;ll get a performance improvement.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003ETo know how big is the performance difference between both interfaces, I&#8217;ve written a \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fcarlosvin\u002Fserializations-performance-java\" target=\"_blank\" rel=\"noopener\"\u003Etiny example in which we serialize an object with 2 collections with 100000 elements each one\u003C\u002Fa\u003E. Here you can find the \u003Ca href=\"http:\u002F\u002Fcarlosvin.github.io\u002Fserializations-performance-java\u002Fclasses\u002Fcom.github.carlosvin.contacts.SerializationTest.html\" target=\"_blank\" rel=\"noopener\"\u003Etests execution results\u003C\u002Fa\u003E. There are 3 different implementations:\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect2\"\u003E\n\u003Ch3 id=\"_implementing_serializable\"\u003EImplementing Serializable\u003C\u002Fh3\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EAs we mentioned above, \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E has to guess certain things. During this process it sacrifices some of performance (slowest way), in exchange we get really simple source code, the class to serialize just has to implement the \u003Ca href=\"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FSerializable.html\" target=\"_blank\" rel=\"noopener\"\u003ESerializable\u003C\u002Fa\u003E interface.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"listingblock\"\u003E\n\u003Cdiv class=\"content\"\u003E\n\u003Cpre class=\"highlight\"\u003E\u003Ccode class=\"language-java\" data-lang=\"java\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EContacts\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eimplements\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003ESerializable\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F ...\u003C\u002Fspan\u003E\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"ulist\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003Eserializing: 1133 millisecond\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003Edeserializing: 506 millisecond\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect2\"\u003E\n\u003Ch3 id=\"_implementing_externalizable_wrong_way\"\u003EImplementing Externalizable (wrong way)\u003C\u002Fh3\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EIf the class implements \u003Ca href=\"https:\u002F\u002Fdocs.oracle.com\u002Fjavase\u002F7\u002Fdocs\u002Fapi\u002Fjava\u002Fio\u002FExternalizable.html\" target=\"_blank\" rel=\"noopener\"\u003EExternalizable\u003C\u002Fa\u003E, we must tell to \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E how it has to serialize\u002Fdeserialize the class attributes. We just have to be careful, because if we did it bad, then we&#8217;ll get the worst of the both worlds: more complex implementation and bad performance, i.e: If we serialize\u002Fdeserialize complex class attributes (like collections), \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E will also have to guess many things about the attributes type.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"listingblock\"\u003E\n\u003Cdiv class=\"content\"\u003E\n\u003Cpre class=\"highlight\"\u003E\u003Ccode class=\"language-java\" data-lang=\"java\"\u003E\u003Cspan class=\"hljs-meta\"\u003E@Override\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EreadExternal\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-params\"\u003E(ObjectInput in)\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethrows\u003C\u002Fspan\u003E IOException, ClassNotFoundException \u003C\u002Fspan\u003E{\n  setEmails((Set&lt;String&gt;) in.readObject());\n  setPhones((Set&lt;String&gt;) in.readObject());\n}\n\n\u003Cspan class=\"hljs-meta\"\u003E@Override\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EwriteExternal\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-params\"\u003E(ObjectOutput out)\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethrows\u003C\u002Fspan\u003E IOException \u003C\u002Fspan\u003E{\n  out.writeObject(emails);\n  out.writeObject(phones);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"ulist\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003Eserializing: 737 millisecond\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003Edeserializing: 367 millisecond\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect2\"\u003E\n\u003Ch3 id=\"_implementing_externalizable_right_way\"\u003EImplementing Externalizable (right way)\u003C\u002Fh3\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EIf we serialize one by one the collection elements, then we&#8217;ll save more time, because \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E serializes simple types, this way avoids guessing things that we actually know.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"listingblock\"\u003E\n\u003Cdiv class=\"content\"\u003E\n\u003Cpre class=\"highlight\"\u003E\u003Ccode class=\"language-java\" data-lang=\"java\"\u003E\u003Cspan class=\"hljs-meta\"\u003E@Override\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EreadExternal\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-params\"\u003E(ObjectInput in)\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethrows\u003C\u002Fspan\u003E IOException, ClassNotFoundException \u003C\u002Fspan\u003E{\n  emails.clear();\n  phones.clear();\n  \u003Cspan class=\"hljs-keyword\"\u003Eint\u003C\u002Fspan\u003E nEmails = in.readInt();\n  \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Eint\u003C\u002Fspan\u003E i = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E; i &lt; nEmails; i++) {\n    emails.add(in.readUTF());\n  }\n  \u003Cspan class=\"hljs-keyword\"\u003Eint\u003C\u002Fspan\u003E nPhones = in.readInt();\n  \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Eint\u003C\u002Fspan\u003E i = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E; i &lt; nPhones; i++) {\n    phones.add(in.readUTF());\n  }\n}\n\n\u003Cspan class=\"hljs-meta\"\u003E@Override\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EwriteExternal\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-params\"\u003E(ObjectOutput out)\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethrows\u003C\u002Fspan\u003E IOException \u003C\u002Fspan\u003E{\n  out.writeInt(emails.size());\n  \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (String e : emails) {\n    out.writeUTF(e);\n  }\n  out.writeInt(phones.size());\n  \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (String p : phones) {\n    out.writeUTF(p);\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"ulist\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003Eserializing: 204 millisecond\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003Edeserializing: 92 millisecond\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EWe&#8217;ve gained performance at expense of write more code.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"sect2\"\u003E\n\u003Ch3 id=\"_results_analysis\"\u003EResults Analysis\u003C\u002Fh3\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EWe don&#8217;t gain performance due to use an interface or the other one.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EWe gain performance because \u003Ca href=\"#_externalizable\"\u003EExternalizable\u003C\u002Fa\u003E interface forces us to implement ourselves the guessing code, so \u003Ca href=\"https:\u002F\u002Fwww.java.com\" target=\"_blank\" rel=\"noopener\"\u003EJava\u003C\u002Fa\u003E doesn&#8217;t have to do that.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"paragraph\"\u003E\n\u003Cp\u003EAs we have seen at \u003Ca href=\"#_implementing_externalizable_wrong_way\"\u003EImplementing Externalizable (wrong way)\u003C\u002Fa\u003E, si no tenemos cuidado, conseguiremos una mejora poco significativa a costa de complicar nuestro código fuente.\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"ulist\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"http:\u002F\u002Fcarlosvin.github.io\u002Fserializations-performance-java\u002Fclasses\u002Fcom.github.carlosvin.contacts.SerializationTest.html\" target=\"_blank\" rel=\"noopener\"\u003ETest results\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fcarlosvin\u002Fserializations-performance-java\u002F\"\u003ECode in Github\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E",slug:"serialization-java-serializable-externalizable",otherLangs:["es"]}}}("","html","Appendix",".","2020","Java serialization ways: Performance Comparison","Java serialization ways, performance comparison"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.f9aecfa1.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.f9aecfa1.js")}document.head.appendChild(s)</script> <script async defer> (function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-1328360-10', 'auto');
		ga('send', 'pageview'); </script> 