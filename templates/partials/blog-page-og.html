{# Enhanced metadata and OpenGraph for blog pages #}

{# Title and og:title: prefer page over section #}
<title>
    {% if page.title %}
    {{ page.title }}
    {% elif section.title %}
    {{ section.title }}
    {% else %}
    {{ config.title }}
    {% endif %}
</title>
<meta property="og:title"
    content="{% if page.title %}{{ page.title }}{% elif section.title %}{{ section.title }}{% else %}{{ config.title }}{% endif %}" />

{# Description and og:description: prefer page over section #}
{% set meta_description = page.description | default(value=section.description) | default(value=config.description) %}
{% if meta_description %}
<meta name="description" content="{{ meta_description }}" />
<meta property="og:description" content="{{ meta_description }}" />
{% endif %}

{# Canonical URL and og:url #}
{% set canonical_url = page.permalink | default(value=current_url) | default(value=config.base_url) %}
<link rel="canonical" href="{{ canonical_url }}" />
<meta property="og:url" content="{{ canonical_url }}" />

{# og:type: article for blog posts #}
<meta property="og:type" content="article" />

{# og:site_name #}
<meta property="og:site_name" content="{{ config.title }}" />

{# og:locale #}
<meta property="og:locale" content="{{ config.extra.og_locale | default(value='en_US') }}" />

{# Article published/modified time #}
{% if page.date %}
<meta property="article:published_time" content="{{ page.date | date(format='%Y-%m-%dT%H:%M:%SZ') }}" />
{% endif %}
{% if page.updated %}
<meta property="article:modified_time" content="{{ page.updated | date(format='%Y-%m-%dT%H:%M:%SZ') }}" />
{% endif %}

{# og:image: use page.preview_image or fallback #}
{% set og_image = page.preview_image | default(value=config.extra.preview_image) %}
{% if og_image %}
<meta property="og:image" content="{{ og_image }}" />
{% endif %}

{# Twitter Card #}
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title"
    content="{% if page.title %}{{ page.title }}{% elif section.title %}{{ section.title }}{% else %}{{ config.title }}{% endif %}" />
{% if meta_description %}
<meta name="twitter:description" content="{{ meta_description }}" />
{% endif %}
{% if og_image %}
<meta name="twitter:image" content="{{ og_image }}" />
{% endif %}
{% if config.extra.twitter_site %}
<meta name="twitter:site" content="{{ config.extra.twitter_site }}" />
{% endif %}