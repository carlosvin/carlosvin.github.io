<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../../favicon.png" />
		<script
			async
			src="https://cdn.jsdelivr.net/npm/@statsig/js-client@1/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-HFdLXhoqeAqLJGsEO0FuGCieE2nSFNxpPp2ziw3ZPYK"
		></script>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="/app.css" />
		
		<link href="../../../../_app/immutable/assets/2.D6-wnWlq.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/IconLink.DCDy1KOq.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/Social.BuJ-IkEK.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/8.BrJEuWPS.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/Details.CFCg3rNQ.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/start.DIeMxXbp.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/entry.DR7oPE4M.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/runtime.B6RPaHn-.js">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/app.BgUX0_E0.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/render.D3Fqu4WM.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/svelte-head.DIKBRFqu.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/disclose-version.CC-duLav.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/3.BSPqVS-c.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/props.PCEjw1P-.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/0.B8I90xuT.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/misc.miZ5XAUJ.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/2.CoeVyj2B.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/lifecycle.DkULVVTe.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/attributes.BBFwatIg.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/IconLink.BzKk1u2O.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/Social.Bk_NS1wS.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/8.Bha5KSvC.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/url.BRZsJGrD.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/Details.BxKKAt3G.js"><!--[--><meta name="date.created" content="2014-05-13T15:00:00.000Z"> <meta name="date.updated" content="2014-05-13T15:00:00.000Z"> <meta name="description" content="Comparación de rendimientos entre distintas formas de serialización en Java"> <!--[--><!--[--><link rel="alternate" hreflang="en" href="/langs/en/posts/serialization-java-serializable-externalizable"><!--]--><!--]--> <!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"Webpage","@id":"https://google.com/article"},"headline":"Distintas formas de serialización en Java: Comparación de rendimiento","alternativeHeadline":"Comparación de rendimientos entre distintas formas de serialización en Java","description":"Comparación de rendimientos entre distintas formas de serialización en Java","datePublished":"2014-05-13T15:00:00.000Z","dateModified":"2014-05-13T15:00:00.000Z","keywords":["Java","Performance"],"author":{"@type":"Person","name":"Carlos"},"publisher":{"@type":"Person","name":"Carlos"}}</script><!----><!--]--><title>Distintas formas de serialización en Java: Comparación de rendimiento</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!----><!--[--><!----><nav class="svelte-1kqmhwi"><ul class="svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/es/posts" rel="prefetch" class="svelte-1rykg79"><!----><img class="logo svelte-1kqmhwi" src="/favicon.25px.png" alt="Carlos dice bla bla logo"><!----></a></li><!----></ul> <ul class="closed svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/es/posts" rel="prefetch" class="svelte-1rykg79"><!----><span class="siteName">Carlos dice bla bla</span><!----></a></li><!----> <li class="svelte-1rykg79"><a href="/langs/es/categories" rel="prefetch" class="svelte-1rykg79"><!----><!---->Categorías<!----></a></li><!----> <li class="svelte-1rykg79"><a href="/langs/es/about" rel="prefetch" class="svelte-1rykg79"><!----><!---->Sobre mi<!----></a></li><!----></ul> <!--[--><!----><div class="h svelte-geb0ta"><!----><a href="/langs/es/feed.xml" target="_blank" class="icon rss svelte-blgowr" title="Suscríbete al feed Carlos dice bla bla" rel="noopener" aria-label="Suscríbete al feed Carlos dice bla bla"><!----><!----></a><!----> <a href="https://github.com/carlosvin" target="_blank" class="icon github svelte-blgowr" title="Find me at github" rel="noopener" aria-label="Find me at github"><!----><!----></a><!----> <a href="https://stackoverflow.com/users/1421059/carlosvin" target="_blank" class="icon stackoverflow svelte-blgowr" title="Find me at stackoverflow" rel="noopener" aria-label="Find me at stackoverflow"><!----><!----></a><!----></div><!----><!--]--> <button type="button" class="svelte-1kqmhwi">≡</button></nav><!----> <main class="svelte-7ld3yf"><!----><!----><header class="svelte-1ikjkmw"><h1 class="svelte-1ikjkmw">Distintas formas de serialización en Java: Comparación de rendimiento <span class="share svelte-1ikjkmw"><!--[!--><a href="https://twitter.com/intent/tweet?url=/langs/es/posts/serialization-java-serializable-externalizable&amp;text=Distintas formas de serialización en Java: Comparación de rendimiento:&amp;nbsp;Comparación de rendimientos entre distintas formas de serialización en Java&amp;hashtags=Java,Performance" target="_blank" class="icon twitter svelte-blgowr" title="Share &quot;Distintas formas de serialización en Java: Comparación de rendimiento&quot;" rel="noopener" aria-label="Share &quot;Distintas formas de serialización en Java: Comparación de rendimiento&quot;"><!----><!----></a><!--]--><!----></span></h1> <p class="summary svelte-1ikjkmw">Comparación de rendimientos entre distintas formas de serialización en Java</p> <div class="subtitle svelte-9uod0d"><span class="date">5/13/2014</span> <span class="langs"><!--[--><ul class="otherLangs svelte-1numgf3"><!--[--><!--[--><li class="svelte-1numgf3"><a rel="alternate" hreflang="en" href="/langs/en/posts/serialization-java-serializable-externalizable" title="Check the post in other language: en">en</a></li><!--]--><!--]--></ul><!--]--><!----></span> <!--[--><span class="tags svelte-wqh6y7"><!--[--><a href="/langs/es/categories/java" title="Java" class="svelte-1g7d2s3">Java</a><a href="/langs/es/categories/performance" title="Performance" class="svelte-1g7d2s3">Performance</a><!--]--></span><!--]--><!----></div><!----></header> <div class="postContent"><!----><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_serializable">Serializable</a></li>
<li><a href="#_externalizable">Externalizable</a></li>
<li><a href="#_pruebas_de_rendimiento_serializable_vs_externalizable">Pruebas de Rendimiento (Serializable vs Externalizable)</a>
<ul class="sectlevel2">
<li><a href="#_implementando_el_interfaz_serializable">Implementando el interfaz Serializable</a></li>
<li><a href="#_utilizando_el_interfaz_externalizable_mal">Utilizando el interfaz Externalizable (mal)</a></li>
<li><a href="#_utilizando_el_interfaz_externalizable_correctamente">Utilizando el interfaz Externalizable (correctamente)</a></li>
<li><a href="#_analizando_los_resultados">Analizando los resultados</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Hace poco, he tenido que serializar/deserializar unos datos en <a href="https://www.java.com" target="_blank" rel="noopener">Java</a>, hacía mucho que no lo hacía en formato binario directamente (ultimamente he utilizado <a href="https://www.json.org" target="_blank" rel="noopener">JSON</a> o <a href="https://en.wikipedia.org/wiki/XML" target="_blank" rel="noopener">XML</a>). Recordaba haber serializado objetos implementando el interfaz <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html" target="_blank" rel="noopener">Serializable</a>, pero había visto por Internet otra forma implementando el interfaz <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html" target="_blank" rel="noopener">Externalizable</a>, ¿cuál interfaz utilizo? Pues depende lo que quieras y necesites, como todo.</p>
</div>
<div class="paragraph">
<p>Veamos cuándo utilizar <a href="#_serializable">Serializable</a> o <a href="#_externalizable">Externalizable</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serializable">Serializable</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Cuando quieras escribir poco código, es la forma fácil.</p>
</li>
<li>
<p>Pero tiene algunas restricciones: El objeto a serializar debe implementar el constructor por defecto. Debe hacerse responsable de los atributos no accesibles de la clase padre.</p>
</li>
<li>
<p>Cuando no te importe mucho el rendimiento, como veremos en la sección <a href="#_pruebas_de_rendimiento_serializable_vs_externalizable">Pruebas de Rendimiento (Serializable vs Externalizable)</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_externalizable">Externalizable</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Vas a tener que implementar tú mismo los métodos de serialización.</p>
</li>
<li>
<p>Cuando no puedas utilizar <a href="#_serializable">Serializable</a>.</p>
</li>
<li>
<p>Cuando quieras obtener un mejor rendimiento, como veremos en la sección <a href="#_pruebas_de_rendimiento_serializable_vs_externalizable">Pruebas de Rendimiento (Serializable vs Externalizable)</a>.</p>
</li>
<li>
<p>Si tienes que encargarte de la serialización de los atributos de la clase padre, te recomiendo utilizar <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html" target="_blank" rel="noopener">Externalizable</a>, porque evitamos una sobrescritura extraña de métodos privados.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeObject</span><span class="hljs-params">(ObjectOutputStream oos)</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(ObjectInputStream ois)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pruebas_de_rendimiento_serializable_vs_externalizable">Pruebas de Rendimiento (Serializable vs Externalizable)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>El interfaz <a href="#_serializable">Serializable</a> utilizando la introspección de <a href="https://www.java.com" target="_blank" rel="noopener">Java</a>, adivina los tipos de los atributos de las clases que va a serializar/deserializar, pero esta "magia" tiene una penalización en el rendimiento.</p>
</div>
<div class="paragraph">
<p>Al utilizar el interfaz <a href="#_externalizable">Externalizable</a> somos nosotros los que decidimos cómo serializar/deserializar los objetos, es decir, tenemos que escribir nosotros el código que hace esto. Hemos perdido comodidad, pero evitamos que <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> haga algunas tareas y, si sobrescribimos correctamente los métodos del interfaz <a href="#_externalizable">Externalizable</a>, conseguiremos una mejora de rendimiento.</p>
</div>
<div class="paragraph">
<p>Para saber cuánto es la diferencia de rendimiento, he escrito un <a href="https://github.com/carlosvin/serializations-performance-java" target="_blank" rel="noopener">pequeño ejemplo en el que se serializa un objeto con dos colecciones con 100000 emails y 100000 teléfonos</a>. He contemplado 3 casos:</p>
</div>
<div class="sect2">
<h3 id="_implementando_el_interfaz_serializable">Implementando el interfaz Serializable</h3>
<div class="paragraph">
<p>Como dijimos más arriba, cuando implementamos el interfaz <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html" target="_blank" rel="noopener">Serializable</a>, <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> tiene que adivinar ciertas cosas, en este proceso sacrifica algo de rendimiento (es el que más tarda), a cambio ĺo único que tenemos que hacer es que nuestra clase implemente el interfaz <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html" target="_blank" rel="noopener">Serializable</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Contacts</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
  <span class="hljs-comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>1133 milisegundos en serializar</p>
</li>
<li>
<p>506 milisegundos en deserializar</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_utilizando_el_interfaz_externalizable_mal">Utilizando el interfaz Externalizable (mal)</h3>
<div class="paragraph">
<p>En este caso somos nosotros los encargados de "decir" a <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> cómo debe serializar/deserializar, pero debemos ser cuidadosos, de lo contrario podemos quedarnos con lo peor de los dos mundos, por ejemplo: Si simplemente serializamos/deserializamos los atributos de la clase, y estos son atributos complejos (como colecciones), <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> también tiene que adivinar bastantes cosas y también sacrificamos algo de rendimiento y además hemos tenido que escribir más código.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readExternal</span><span class="hljs-params">(ObjectInput in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
  setEmails((Set&lt;String&gt;) in.readObject());
  setPhones((Set&lt;String&gt;) in.readObject());
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeExternal</span><span class="hljs-params">(ObjectOutput out)</span> <span class="hljs-keyword">throws</span> IOException {
  out.writeObject(emails);
  out.writeObject(phones);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>737 milisegundos en serializar</p>
</li>
<li>
<p>367 milisegundos en deserializar</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_utilizando_el_interfaz_externalizable_correctamente">Utilizando el interfaz Externalizable (correctamente)</h3>
<div class="paragraph">
<p>Si serializamos/deserializamos uno por uno los elementos de las colecciones, ahorramos aún más tiempo, porque <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> está serializando tipos más simples (en este caso java.lang.String).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readExternal</span><span class="hljs-params">(ObjectInput in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
  emails.clear();
  phones.clear();
  <span class="hljs-type">int</span> <span class="hljs-variable">nEmails</span> <span class="hljs-operator">=</span> in.readInt();
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nEmails; i++) {
    emails.add(in.readUTF());
  }
  <span class="hljs-type">int</span> <span class="hljs-variable">nPhones</span> <span class="hljs-operator">=</span> in.readInt();
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nPhones; i++) {
    phones.add(in.readUTF());
  }
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeExternal</span><span class="hljs-params">(ObjectOutput out)</span> <span class="hljs-keyword">throws</span> IOException {
  out.writeInt(emails.size());
  <span class="hljs-keyword">for</span> (String e : emails) {
    out.writeUTF(e);
  }
  out.writeInt(phones.size());
  <span class="hljs-keyword">for</span> (String p : phones) {
    out.writeUTF(p);
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>204 milisegundos en serializar</p>
</li>
<li>
<p>92 milisegundos en deserializar</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hemos ganado rendimiento a costa de escribir un poco más de código.</p>
</div>
</div>
<div class="sect2">
<h3 id="_analizando_los_resultados">Analizando los resultados</h3>
<div class="paragraph">
<p>Por el hecho de utilizar un interfaz u otro, no ganamos rendimiento.</p>
</div>
<div class="paragraph">
<p>Ganamos rendimiento porque el interfaz <a href="#_externalizable">Externalizable</a> nos "obliga" a implementar parte de la serialización y quitamos esta carga a <a href="https://www.java.com" target="_blank" rel="noopener">Java</a>.</p>
</div>
<div class="paragraph">
<p>Aunque como hemos visto en <a href="#_utilizando_el_interfaz_externalizable_mal">Utilizando el interfaz Externalizable (mal)</a>, si no tenemos cuidado, conseguiremos una mejora poco significativa a costa de complicar nuestro código fuente.</p>
</div>
<div class="paragraph">
<p>A continuación os dejo los enlaces a:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html">Resultados de los tests</a>.</p>
</li>
<li>
<p><a href="https://github.com/carlosvin/serializations-performance-java/">Código en github</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div><!----> <div class="comments"><script src="https://utteranc.es/client.js" repo="carlosvin/carlosvin.github.io" issue-term="title" label="comment" theme="github-light" crossorigin="anonymous" async>
	</script></div><!----></div><!----><!----><!----></main><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_vktng3 = {
						base: new URL("../../../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{path:"/langs/es/posts/serialization-java-serializable-externalizable/",lang:"es",translations:{lang:"es",author:"Carlos Martin Sanchez",siteName:"Carlos dice bla bla",siteDescription:"Qué está pasando por mi cabeza y alrededores",categories:"categorías",Categories:"Categorías",RecentPosts:"Últimas entradas",NoPosts:"No hay entradas",SubscribeTo:"Suscríbete al feed",AboutMe:"Sobre mi",AllPosts:"Todas las entradas"}},"uses":{"params":["lang"],"url":1},"slash":"always"},{"type":"data","data":{html:"\u003Cdiv id=\"toc\" class=\"toc\">\n\u003Cdiv id=\"toctitle\">Table of Contents\u003C/div>\n\u003Cul class=\"sectlevel1\">\n\u003Cli>\u003Ca href=\"#_serializable\">Serializable\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_externalizable\">Externalizable\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_pruebas_de_rendimiento_serializable_vs_externalizable\">Pruebas de Rendimiento (Serializable vs Externalizable)\u003C/a>\n\u003Cul class=\"sectlevel2\">\n\u003Cli>\u003Ca href=\"#_implementando_el_interfaz_serializable\">Implementando el interfaz Serializable\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_utilizando_el_interfaz_externalizable_mal\">Utilizando el interfaz Externalizable (mal)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_utilizando_el_interfaz_externalizable_correctamente\">Utilizando el interfaz Externalizable (correctamente)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_analizando_los_resultados\">Analizando los resultados\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv id=\"preamble\">\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Hace poco, he tenido que serializar/deserializar unos datos en \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a>, hacía mucho que no lo hacía en formato binario directamente (ultimamente he utilizado \u003Ca href=\"https://www.json.org\" target=\"_blank\" rel=\"noopener\">JSON\u003C/a> o \u003Ca href=\"https://en.wikipedia.org/wiki/XML\" target=\"_blank\" rel=\"noopener\">XML\u003C/a>). Recordaba haber serializado objetos implementando el interfaz \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html\" target=\"_blank\" rel=\"noopener\">Serializable\u003C/a>, pero había visto por Internet otra forma implementando el interfaz \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html\" target=\"_blank\" rel=\"noopener\">Externalizable\u003C/a>, ¿cuál interfaz utilizo? Pues depende lo que quieras y necesites, como todo.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Veamos cuándo utilizar \u003Ca href=\"#_serializable\">Serializable\u003C/a> o \u003Ca href=\"#_externalizable\">Externalizable\u003C/a>.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_serializable\">Serializable\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>Cuando quieras escribir poco código, es la forma fácil.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Pero tiene algunas restricciones: El objeto a serializar debe implementar el constructor por defecto. Debe hacerse responsable de los atributos no accesibles de la clase padre.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Cuando no te importe mucho el rendimiento, como veremos en la sección \u003Ca href=\"#_pruebas_de_rendimiento_serializable_vs_externalizable\">Pruebas de Rendimiento (Serializable vs Externalizable)\u003C/a>.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_externalizable\">Externalizable\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>Vas a tener que implementar tú mismo los métodos de serialización.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Cuando no puedas utilizar \u003Ca href=\"#_serializable\">Serializable\u003C/a>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Cuando quieras obtener un mejor rendimiento, como veremos en la sección \u003Ca href=\"#_pruebas_de_rendimiento_serializable_vs_externalizable\">Pruebas de Rendimiento (Serializable vs Externalizable)\u003C/a>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Si tienes que encargarte de la serialización de los atributos de la clase padre, te recomiendo utilizar \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html\" target=\"_blank\" rel=\"noopener\">Externalizable\u003C/a>, porque evitamos una sobrescritura extraña de métodos privados.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-keyword\">private\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">writeObject\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectOutputStream oos)\u003C/span>\n\u003Cspan class=\"hljs-keyword\">private\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">readObject\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectInputStream ois)\u003C/span>\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_pruebas_de_rendimiento_serializable_vs_externalizable\">Pruebas de Rendimiento (Serializable vs Externalizable)\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>El interfaz \u003Ca href=\"#_serializable\">Serializable\u003C/a> utilizando la introspección de \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a>, adivina los tipos de los atributos de las clases que va a serializar/deserializar, pero esta \"magia\" tiene una penalización en el rendimiento.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Al utilizar el interfaz \u003Ca href=\"#_externalizable\">Externalizable\u003C/a> somos nosotros los que decidimos cómo serializar/deserializar los objetos, es decir, tenemos que escribir nosotros el código que hace esto. Hemos perdido comodidad, pero evitamos que \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> haga algunas tareas y, si sobrescribimos correctamente los métodos del interfaz \u003Ca href=\"#_externalizable\">Externalizable\u003C/a>, conseguiremos una mejora de rendimiento.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Para saber cuánto es la diferencia de rendimiento, he escrito un \u003Ca href=\"https://github.com/carlosvin/serializations-performance-java\" target=\"_blank\" rel=\"noopener\">pequeño ejemplo en el que se serializa un objeto con dos colecciones con 100000 emails y 100000 teléfonos\u003C/a>. He contemplado 3 casos:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_implementando_el_interfaz_serializable\">Implementando el interfaz Serializable\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Como dijimos más arriba, cuando implementamos el interfaz \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html\" target=\"_blank\" rel=\"noopener\">Serializable\u003C/a>, \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> tiene que adivinar ciertas cosas, en este proceso sacrifica algo de rendimiento (es el que más tarda), a cambio ĺo único que tenemos que hacer es que nuestra clase implemente el interfaz \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html\" target=\"_blank\" rel=\"noopener\">Serializable\u003C/a>.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">class\u003C/span> \u003Cspan class=\"hljs-title class_\">Contacts\u003C/span> \u003Cspan class=\"hljs-keyword\">implements\u003C/span> \u003Cspan class=\"hljs-title class_\">Serializable\u003C/span> {\n  \u003Cspan class=\"hljs-comment\">// ...\u003C/span>\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>1133 milisegundos en serializar\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>506 milisegundos en deserializar\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_utilizando_el_interfaz_externalizable_mal\">Utilizando el interfaz Externalizable (mal)\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>En este caso somos nosotros los encargados de \"decir\" a \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> cómo debe serializar/deserializar, pero debemos ser cuidadosos, de lo contrario podemos quedarnos con lo peor de los dos mundos, por ejemplo: Si simplemente serializamos/deserializamos los atributos de la clase, y estos son atributos complejos (como colecciones), \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> también tiene que adivinar bastantes cosas y también sacrificamos algo de rendimiento y además hemos tenido que escribir más código.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">readExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectInput in)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException, ClassNotFoundException {\n  setEmails((Set&lt;String&gt;) in.readObject());\n  setPhones((Set&lt;String&gt;) in.readObject());\n}\n\n\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">writeExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectOutput out)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException {\n  out.writeObject(emails);\n  out.writeObject(phones);\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>737 milisegundos en serializar\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>367 milisegundos en deserializar\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_utilizando_el_interfaz_externalizable_correctamente\">Utilizando el interfaz Externalizable (correctamente)\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Si serializamos/deserializamos uno por uno los elementos de las colecciones, ahorramos aún más tiempo, porque \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> está serializando tipos más simples (en este caso java.lang.String).\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">readExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectInput in)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException, ClassNotFoundException {\n  emails.clear();\n  phones.clear();\n  \u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">nEmails\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> in.readInt();\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">i\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>; i &lt; nEmails; i++) {\n    emails.add(in.readUTF());\n  }\n  \u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">nPhones\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> in.readInt();\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">i\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>; i &lt; nPhones; i++) {\n    phones.add(in.readUTF());\n  }\n}\n\n\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">writeExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectOutput out)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException {\n  out.writeInt(emails.size());\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (String e : emails) {\n    out.writeUTF(e);\n  }\n  out.writeInt(phones.size());\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (String p : phones) {\n    out.writeUTF(p);\n  }\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>204 milisegundos en serializar\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>92 milisegundos en deserializar\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Hemos ganado rendimiento a costa de escribir un poco más de código.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_analizando_los_resultados\">Analizando los resultados\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Por el hecho de utilizar un interfaz u otro, no ganamos rendimiento.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Ganamos rendimiento porque el interfaz \u003Ca href=\"#_externalizable\">Externalizable\u003C/a> nos \"obliga\" a implementar parte de la serialización y quitamos esta carga a \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a>.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Aunque como hemos visto en \u003Ca href=\"#_utilizando_el_interfaz_externalizable_mal\">Utilizando el interfaz Externalizable (mal)\u003C/a>, si no tenemos cuidado, conseguiremos una mejora poco significativa a costa de complicar nuestro código fuente.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>A continuación os dejo los enlaces a:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Ca href=\"http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html\">Resultados de los tests\u003C/a>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://github.com/carlosvin/serializations-performance-java/\">Código en github\u003C/a>.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>",props:{title:"Distintas formas de serialización en Java: Comparación de rendimiento",lang:"es",summary:"Comparación de rendimientos entre distintas formas de serialización en Java",slug:"serialization-java-serializable-externalizable",keywords:["Java","Performance"],filepath:"/static/posts/serialization-java-serializable-externalizable.es.adoc",dirpath:"/static/posts",created:1399993200000,modified:1399993200000,otherLangs:["en"],author:"Carlos",previewimage:void 0,path:"/langs/es/posts/serialization-java-serializable-externalizable"},jsonLd:"\u003Cscript type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"Webpage\",\"@id\":\"https://google.com/article\"},\"headline\":\"Distintas formas de serialización en Java: Comparación de rendimiento\",\"alternativeHeadline\":\"Comparación de rendimientos entre distintas formas de serialización en Java\",\"description\":\"Comparación de rendimientos entre distintas formas de serialización en Java\",\"datePublished\":\"2014-05-13T15:00:00.000Z\",\"dateModified\":\"2014-05-13T15:00:00.000Z\",\"keywords\":[\"Java\",\"Performance\"],\"author\":{\"@type\":\"Person\",\"name\":\"Carlos\"},\"publisher\":{\"@type\":\"Person\",\"name\":\"Carlos\"}}\u003C/script>"},"uses":{"params":["slug","lang"]}}];

					Promise.all([
						import("../../../../_app/immutable/entry/start.DIeMxXbp.js"),
						import("../../../../_app/immutable/entry/app.BgUX0_E0.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 8],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
