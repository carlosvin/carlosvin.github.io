<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Filesystem in C++17</title><!-- HTML_TAG_START -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-1328360-10', 'auto');
	</script>
	<!-- HTML_TAG_END --><meta name="date.created" content="2017-05-28T07:00:00.000Z" data-svelte="svelte-1lps7vh"><meta name="date.updated" content="2017-05-28T07:00:00.000Z" data-svelte="svelte-1lps7vh"><meta name="description" content="We are going to analyze with examples new filesystem features coming with C++17" data-svelte="svelte-1lps7vh"><link rel="alternate" hreflang="es" href="/langs/es/posts/recursive-directory-iterator" data-svelte="svelte-1lps7vh"><link rel="alternate" href="/langs/en/posts/recursive-directory-iterator.ld.json" type="application/ld+json" data-svelte="svelte-1lps7vh">

		

		<link rel="stylesheet" href="/_app/assets/start-61d1577b.css">
		<link rel="stylesheet" href="/_app/assets/pages/langs/_lang_/__layout.svelte-8bf39628.css">
		<link rel="stylesheet" href="/_app/assets/Social-7f1225f5.css">
		<link rel="stylesheet" href="/_app/assets/IconLink-98c179b7.css">
		<link rel="stylesheet" href="/_app/assets/pages/langs/_lang_/posts/_slug_.svelte-5c4cbc84.css">
		<link rel="stylesheet" href="/_app/assets/Details-4d02ff5e.css">
		<link rel="modulepreload" href="/_app/start-021215cb.js">
		<link rel="modulepreload" href="/_app/chunks/vendor-0252a1f8.js">
		<link rel="modulepreload" href="/_app/chunks/singletons-a42a5e91.js">
		<link rel="modulepreload" href="/_app/layout.svelte-db1cc4a9.js">
		<link rel="modulepreload" href="/_app/pages/langs/_lang_/__layout.svelte-86698bda.js">
		<link rel="modulepreload" href="/_app/chunks/lang-92ec2f88.js">
		<link rel="modulepreload" href="/_app/chunks/Social-5bd4a30f.js">
		<link rel="modulepreload" href="/_app/chunks/IconLink-54d4beae.js">
		<link rel="modulepreload" href="/_app/pages/langs/_lang_/posts/_slug_.svelte-274c2eab.js">
		<link rel="modulepreload" href="/_app/chunks/url-bb89230a.js">
		<link rel="modulepreload" href="/_app/chunks/Details-cd1601f7.js">

		<script type="module">
			import { start } from "/_app/start-021215cb.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":""},
				session: {},
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/_app/layout.svelte-db1cc4a9.js"),
						import("/_app/pages/langs/_lang_/__layout.svelte-86698bda.js"),
						import("/_app/pages/langs/_lang_/posts/_slug_.svelte-274c2eab.js")
					],
					url: new URL("http://prerender/langs/en/posts/recursive-directory-iterator"),
					params: {lang:"en",slug:"recursive-directory-iterator"}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">




<nav class="svelte-1kqmhwi"><ul class="svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/en/posts" rel="prefetch" class="svelte-1rykg79"><img class="logo svelte-1kqmhwi" src="/favicon.png" alt="Carlos Say&#39;s Bla Bla logo"></a>
</li></ul>
	<ul class="closed svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/en/posts" rel="prefetch" class="svelte-1rykg79"><span class="siteName">Carlos Say&#39;s Bla Bla</span></a>
</li>
		<li class="svelte-1rykg79"><a href="/langs/en/categories" rel="prefetch" class="svelte-1rykg79">Categories</a>
</li>
		<li class="svelte-1rykg79"><a href="/langs/en/about" rel="prefetch" class="svelte-1rykg79">About</a>
</li></ul>
	<div class="h svelte-geb0ta"><a href="/langs/en/feed.xml" target="_blank" class="icon rss svelte-blgowr" title="Subscribe to Carlos Say&#39;s Bla Bla" rel="noopener" aria-label="Subscribe to Carlos Say&#39;s Bla Bla">
</a>
	<a href="https://github.com/carlosvin" target="_blank" class="icon github svelte-blgowr" title="Find me at github" rel="noopener" aria-label="Find me at github">
</a>
	<a href="https://twitter.com/carlosvin" target="_blank" class="icon twitter svelte-blgowr" title="Find me at twitter" rel="noopener" aria-label="Find me at twitter">
</a>
	<a href="https://stackoverflow.com/story/carlosvin" target="_blank" class="icon stackoverflow svelte-blgowr" title="Find me at stackoverflow" rel="noopener" aria-label="Find me at stackoverflow">
</a>
</div>
	<button type="button" class="svelte-1kqmhwi">â‰¡</button>
</nav>
<main class="svelte-1m42syy">

<header class="svelte-1ikjkmw"><h1 class="svelte-1ikjkmw">Filesystem in C++17
		<span class="share svelte-1ikjkmw"><a href="https://twitter.com/intent/tweet?url=/langs/en/posts/recursive-directory-iterator&amp;text=Filesystem in C++17:&amp;nbsp;We are going to analyze with examples new filesystem features coming with C++17&amp;hashtags=C++,C++11,C++17,IO,Filesystem" target="_blank" class="icon twitter svelte-blgowr" title="Share &quot;Filesystem in C++17&quot;" rel="noopener" aria-label="Share &quot;Filesystem in C++17&quot;">
</a></span></h1>
	<p class="summary svelte-1ikjkmw">We are going to analyze with examples new filesystem features coming with C++17</p>
	<div class="subtitle svelte-19u0gw1"><span class="date svelte-19u0gw1">28/05/2017</span>
	<span class="tags svelte-wqh6y7"><a href="/langs/en/categories/c" title="C++" class="svelte-vx17la">C++
</a><a href="/langs/en/categories/c11" title="C++11" class="svelte-vx17la">C++11
</a><a href="/langs/en/categories/c17" title="C++17" class="svelte-vx17la">C++17
</a><a href="/langs/en/categories/io" title="IO" class="svelte-vx17la">IO
</a><a href="/langs/en/categories/filesystem" title="Filesystem" class="svelte-vx17la">Filesystem
</a></span>
</div></header>

<div class="postContent"><!-- HTML_TAG_START --><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_gettting_started_with_experimental_filesystem_features_c17_g">Gettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)</a></li>
<li><a href="#_c17_filesystem_features">C&#43;&#43;17 Filesystem Features</a>
<ul class="sectlevel2">
<li><a href="#_stdfilesystempath">std::filesystem::path</a></li>
<li><a href="#_directory_separator">Directory separator</a></li>
<li><a href="#_directory_separator_operator">Directory Separator Operator</a></li>
<li><a href="#_createremove_directories">Create/Remove Directories</a></li>
</ul>
</li>
<li><a href="#_full_example_recursive_directory_iterator">Full example: Recursive Directory Iterator</a>
<ul class="sectlevel2">
<li><a href="#_c11">C&#43;&#43;11</a></li>
<li><a href="#_c17">C&#43;&#43;17</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since C&#43;&#43;17 new filesystem abstractions will be added to C&#43;&#43; environment. So far they are available as <a href="https://en.cppreference.com/w/cpp/experimental">Experimental C&#43;&#43; Features</a>. If you want to dig more about this new library, here it is the <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4100.pdf" target="_blank" rel="noopener">final draft of File System Technical Specification</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gettting_started_with_experimental_filesystem_features_c17_g">Gettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We just have to "tell" compiler that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>we write C&#43;&#43;17 (<code>-c++1z</code>) and</p>
</li>
<li>
<p>it has to add <em>standard library with filesystem library</em> (<code>-lstdc++fs</code>).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; ./a.out</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s see a simple example with <code>std::filesystem::path</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    fs::path aPath {<span class="hljs-string">&quot;./path/to/file.txt&quot;</span>};

    cout &lt;&lt; <span class="hljs-string">&quot;Parent path: &quot;</span> &lt;&lt; aPath.<span class="hljs-built_in">parent_path</span>() &lt;&lt; endl;
    cout &lt;&lt; <span class="hljs-string">&quot;Filename: &quot;</span> &lt;&lt; aPath.<span class="hljs-built_in">filename</span>() &lt;&lt; endl;
    cout &lt;&lt; <span class="hljs-string">&quot;Extension: &quot;</span> &lt;&lt; aPath.<span class="hljs-built_in">extension</span>() &lt;&lt; endl;

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/9f8bebb8b7f0fbe7" target="_blank" rel="noopener">Compile and run: Basic C&#43;&#43;17 example</a></div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; ./a.out
$ ./a.out

Parent path: <span class="hljs-string">&quot;./path/to&quot;</span>
Filename: <span class="hljs-string">&quot;file.txt&quot;</span>
Extension: <span class="hljs-string">&quot;.txt&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c17_filesystem_features">C&#43;&#43;17 Filesystem Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we are going to explain some <a href="https://en.cppreference.com/w/cpp/filesystem" target="_blank" rel="noopener">std::filesystem</a> features with examples, which will help us to highlight differences between C&#43;&#43;11 and C&#43;&#43;17 so we can get a better idea about what this new library will supply and how it might make developer&#8217;s work easier.</p>
</div>
<div class="sect2">
<h3 id="_stdfilesystempath">std::filesystem::path</h3>
<div class="paragraph">
<p>Upper we have seen a tiny <a href="https://coliru.stacked-crooked.com/a/9f8bebb8b7f0fbe7" target="_blank" rel="noopener">use case for std::filesystem::path</a>. That is a quite powerful and convenient feature that supplies an multi-platform abstraction for paths to files using the correct directory path separator depending on the platform we are building our application for (<code>\</code> for Windows based systems and <code>/</code> for Unix based systems).</p>
</div>
</div>
<div class="sect2">
<h3 id="_directory_separator">Directory separator</h3>
<div class="paragraph">
<p>When we want our application to use the correct directory separator in C&#43;&#43;11, we could use conditional macro declaration:</p>
</div>
<div class="listingblock">
<div class="title">Platform independent directory separator in C&#43;&#43;11</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;\\&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;/&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    cout &lt;&lt; <span class="hljs-string">&quot;Separator in my system &quot;</span> &lt;&lt; SEP &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://coliru.stacked-crooked.com/a/5023ee989105fc54" target="_blank" rel="noopener">Compile and run: C&#43;&#43;11 separator example</a>.</p>
</div>
<div class="listingblock">
<div class="title">Platform independent directory separator in C&#43;&#43;17. Cleaner and simpler.</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    cout &lt;&lt; <span class="hljs-string">&quot;Separator in my system &quot;</span> &lt;&lt; fs::path::preferred_separator &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://coliru.stacked-crooked.com/a/1f2f63b3f5597d05" target="_blank" rel="noopener">Compile and run: C&#43;&#43;17 separator example</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_directory_separator_operator">Directory Separator Operator</h3>
<div class="paragraph">
<p><a href="https://en.cppreference.com/w/cpp/filesystem/path">std::filesystem::path</a> implements <code>/</code> operator, which allows to easily concatenate paths to files and directories.</p>
</div>
<div class="paragraph">
<p>When we want to concatenate paths in C&#43;&#43;11, we have to add extra logic to avoid adding duplicate separators and to select the correct separator for target platform:</p>
</div>
<div class="listingblock">
<div class="title">Concatenate paths in C&#43;&#43;11</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;\\&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;/&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    string root {<span class="hljs-string">&quot;/&quot;</span>};
    string dir {<span class="hljs-string">&quot;var/www/&quot;</span>};
    string index {<span class="hljs-string">&quot;index.html&quot;</span>};

    string pathToIndex{};
    pathToIndex.<span class="hljs-built_in">append</span>(root).<span class="hljs-built_in">append</span>(SEP).<span class="hljs-built_in">append</span>(dir).<span class="hljs-built_in">append</span>(SEP).<span class="hljs-built_in">append</span>(index);

    cout &lt;&lt; pathToIndex &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/290b278ec1de9573" target="_blank" rel="noopener">Compile and run: Concatenate paths in C&#43;&#43;11</a></div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">//var/www//index.html</code></pre>
</div>
</div>
<div class="paragraph">
<p>Checking program output we notice it is not fully correct, we should have checked whether path parts already contains a separator so we don&#8217;t append another separator again. That logic is already implemented in <a href="https://en.cppreference.com/w/cpp/filesystem/path">std::filesystem::path</a>, so C&#43;&#43;17 can be like:</p>
</div>
<div class="listingblock">
<div class="title">Concatenate paths in C&#43;&#43;17</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    fs::path root {<span class="hljs-string">&quot;/&quot;</span>};
    fs::path dir {<span class="hljs-string">&quot;var/www/&quot;</span>};
    fs::path index {<span class="hljs-string">&quot;index.html&quot;</span>};

    fs::path pathToIndex = root / dir / index;

    cout &lt;&lt; pathToIndex &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/a24d50875b4daad1">Compile and run: Concatenate paths in C&#43;&#43;17</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"><span class="hljs-string">&quot;/var/www/index.html&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Code is cleaner and just correct, there are no duplicated separators.</p>
</div>
</div>
<div class="sect2">
<h3 id="_createremove_directories">Create/Remove Directories</h3>
<div class="paragraph">
<p><a href="https://en.cppreference.com/w/cpp/filesystem" target="_blank" rel="noopener">std::filesystem</a> comes with some utilities to create and remove files and directories, but firstly let&#8217;s try to do so in C&#43;&#43;11.</p>
</div>
<div class="listingblock">
<div class="title">Create and remove nested directories in C&#43;&#43;11</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> opts = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/c&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/c/d&quot;</span>, opts);

    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la sandbox/*&quot;</span>);

    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/c/d&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/c&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox&quot;</span>);

    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la&quot;</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/26f4763ec5b42adb">Compile and run: Create and remove directories C&#43;&#43;11</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++-4.9 -std=c++11 main.cpp -lm &amp;&amp; ./a.out
sandbox/a:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 12:27 .
drwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..
drwxr-xr-x 2 2001 2000 4096 May 28 12:27 b

sandbox/c:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 12:27 .
drwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..
drwxr-xr-x 2 2001 2000 4096 May 28 12:27 d
total 8012
drwxrwxrwx 2 2001 2000    4096 May 28 12:27 .
drwxrwxrwx 3 2002 2000 8175616 May 28 12:27 ..
-rwxr-xr-x 1 2001 2000    8168 May 28 12:27 a.out
-rw-rw-rw- 1 2001 2000     517 May 28 12:27 main.cpp</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have to create/remove one by one. We could rewrite this code snippet with less lines (using a loop), but we still have to pay attention to creation/deletion order, we cannot remove parent directory before we have removed all children.</p>
</div>
<div class="paragraph">
<p>Since C&#43;&#43;17, we can create and remove nested directories with just one call.</p>
</div>
<div class="listingblock">
<div class="title">Create and remove nested directories C&#43;&#43;17</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    fs::<span class="hljs-built_in">create_directories</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>);
    fs::<span class="hljs-built_in">create_directories</span>(<span class="hljs-string">&quot;sandbox/c/d&quot;</span>);
    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la sandbox/*&quot;</span>);

    cout &lt;&lt; <span class="hljs-string">&quot;Were directories removed? &quot;</span> &lt;&lt; fs::<span class="hljs-built_in">remove_all</span>(<span class="hljs-string">&quot;sandbox&quot;</span>) &lt;&lt; endl;
    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la&quot;</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/62c2d22fa0e7144c">Compile and run: Create and remove nested directories C&#43;&#43;17</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++1z -fconcepts -fgnu-tm  -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out
sandbox/a:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 16:45 .
drwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..
drwxr-xr-x 2 2001 2000 4096 May 28 16:45 b

sandbox/c:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 16:45 .
drwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..
drwxr-xr-x 2 2001 2000 4096 May 28 16:45 d
Were directories removed? 1
total 10132
drwxrwxrwx 2 2001 2000    4096 May 28 16:45 .
drwxrwxrwx 3 2002 2000 8175616 May 28 16:45 ..
-rwxr-xr-x 1 2001 2000 2170976 May 28 16:45 a.out
-rw-rw-rw- 1 2001 2000     393 May 28 16:45 main.cpp</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_full_example_recursive_directory_iterator">Full example: Recursive Directory Iterator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This example consists of iterate recursively through dicrectories fintering files by extension.</p>
</div>
<div class="sect2">
<h3 id="_c11">C&#43;&#43;11</h3>
<div class="paragraph">
<p>To keep C&#43;&#43;11 example simple, I haven&#8217;t added filtering  logic, but filtering logic is present in C&#43;&#43;17 example:</p>
</div>
<div class="listingblock">
<div class="title">filesystem.11.cpp</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;dirent.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span> <span class="hljs-comment">// std::ofstream</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;system_error&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">const</span> string UP_DIR = <span class="hljs-string">&quot;..&quot;</span>;
<span class="hljs-type">const</span> string CURRENT_DIR = <span class="hljs-string">&quot;.&quot;</span>;
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;/&quot;</span>;


<span class="hljs-function">string <span class="hljs-title">path</span><span class="hljs-params">(initializer_list&lt;string&gt; parts)</span>
</span>{
    string pathTmp {};
    string separator = <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp; part: parts)
    {
        pathTmp.<span class="hljs-built_in">append</span>(separator).<span class="hljs-built_in">append</span>(part);
        separator = SEP;
    }
    <span class="hljs-keyword">return</span> pathTmp;
}

<span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">getDirectoryFiles</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; dir, <span class="hljs-type">const</span> vector&lt;string&gt; &amp; extensions)</span>
</span>{
    vector&lt;string&gt; files;
    <span class="hljs-function">shared_ptr&lt;DIR&gt; <span class="hljs-title">directory_ptr</span><span class="hljs-params">(opendir(dir.c_str()), [](DIR* dir){ dir &amp;&amp; closedir(dir); })</span></span>;
    <span class="hljs-keyword">if</span> (!directory_ptr)
    {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">system_error</span>(<span class="hljs-built_in">error_code</span>(errno, <span class="hljs-built_in">system_category</span>()), <span class="hljs-string">&quot;Error opening : &quot;</span> + dir);
    }

    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">dirent</span> *dirent_ptr;
    <span class="hljs-keyword">while</span> ((dirent_ptr = <span class="hljs-built_in">readdir</span>(directory_ptr.<span class="hljs-built_in">get</span>())) != <span class="hljs-literal">nullptr</span>)
    {
        <span class="hljs-type">const</span> string fileName {dirent_ptr-&gt;d_name};
        <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_DIR)
        {
            <span class="hljs-keyword">if</span> (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)
            {
                <span class="hljs-keyword">auto</span> subFiles = <span class="hljs-built_in">getDirectoryFiles</span>(<span class="hljs-built_in">path</span>({dir, fileName}), extensions);
                files.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">end</span>(files), <span class="hljs-built_in">begin</span>(subFiles), <span class="hljs-built_in">end</span>(subFiles));
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_REG)
        {
            <span class="hljs-comment">// here we should check also if filename has an extension in extensions vector</span>
            files.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">path</span>({dir, fileName}));
        }
    }
    <span class="hljs-keyword">return</span> files;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>, opt);

	vector&lt;string&gt; e_files = {
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.rst&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.txt&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/file2.RST&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/file3.md&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/will_be.ignored&quot;</span>
	};

	<span class="hljs-comment">// create files</span>
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;f: e_files)
	{
		<span class="hljs-function">ofstream <span class="hljs-title">of</span><span class="hljs-params">(f, ofstream::out)</span></span>;
		of &lt;&lt; <span class="hljs-string">&quot;test&quot;</span>;
	}

    cout &lt;&lt; <span class="hljs-string">&quot;filtered files: &quot;</span> &lt;&lt; endl;
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;f: <span class="hljs-built_in">getDirectoryFiles</span>(<span class="hljs-string">&quot;.&quot;</span>, {<span class="hljs-string">&quot;.rst&quot;</span>, <span class="hljs-string">&quot;.RST&quot;</span>, <span class="hljs-string">&quot;.md&quot;</span>})){
	    cout &lt;&lt; <span class="hljs-string">&quot;\t&quot;</span> &lt;&lt; f &lt;&lt; endl;
	}

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/af4228e039a281b3" target="_blank" rel="noopener">Compile and run C&#43;&#43;11 example</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out
filtered files:
	./main.cpp
	./sandbox/file3.md
	./sandbox/will_be.ignored
	./sandbox/a/b/file1.rst
	./sandbox/a/b/file1.txt
	./sandbox/a/file2.RST
	./a.out</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_c17">C&#43;&#43;17</h3>
<div class="paragraph">
<p>Following example also filters files by extension.</p>
</div>
<div class="listingblock">
<div class="title">filesystem.17.cpp</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"><span class="hljs-comment">#include &lt;dirent.h&gt;</span>
<span class="hljs-comment">#include &lt;cstring&gt;</span>
<span class="hljs-comment">#include &lt;iostream&gt;</span>
<span class="hljs-comment">#include &lt;fstream&gt; // std::ofstream</span>
<span class="hljs-comment">#include &lt;vector&gt;</span>
<span class="hljs-comment">#include &lt;memory&gt;</span>
<span class="hljs-comment">#include &lt;system_error&gt;</span>
<span class="hljs-comment">#include &lt;sys/stat.h&gt;</span>

using namespace std;

const string UP_DIR = <span class="hljs-string">&quot;..&quot;</span>;
const string CURRENT_DIR = <span class="hljs-string">&quot;.&quot;</span>;
const string SEP = <span class="hljs-string">&quot;/&quot;</span>;


string path(initializer_list&lt;string&gt; parts)
{
    string pathTmp {};
    string separator = <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">for</span> (auto &amp; part: parts)
    {
        pathTmp.append(separator).append(part);
        separator = SEP;
    }
    <span class="hljs-built_in">return</span> pathTmp;
}

vector&lt;string&gt; getDirectoryFiles(const string&amp; <span class="hljs-built_in">dir</span>, const vector&lt;string&gt; &amp; extensions)
{
    vector&lt;string&gt; files;
    shared_ptr&lt;DIR&gt; directory_ptr(opendir(dir.c_str()), [](DIR* <span class="hljs-built_in">dir</span>){ <span class="hljs-built_in">dir</span> &amp;&amp; closedir(<span class="hljs-built_in">dir</span>); });
    <span class="hljs-keyword">if</span> (!directory_ptr)
    {
        throw system_error(error_code(errno, system_category()), <span class="hljs-string">&quot;Error opening : &quot;</span> + <span class="hljs-built_in">dir</span>);
    }

    struct dirent *dirent_ptr;
    <span class="hljs-keyword">while</span> ((dirent_ptr = readdir(directory_ptr.get())) != nullptr)
    {
        const string fileName {dirent_ptr-&gt;d_name};
        <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_DIR)
        {
            <span class="hljs-keyword">if</span> (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)
            {
                auto subFiles = getDirectoryFiles(path({<span class="hljs-built_in">dir</span>, fileName}), extensions);
                files.insert(end(files), begin(subFiles), end(subFiles));
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_REG)
        {
            // here we should check also <span class="hljs-keyword">if</span> filename has an extension <span class="hljs-keyword">in</span> extensions vector
            files.push_back(path({<span class="hljs-built_in">dir</span>, fileName}));
        }
    }
    <span class="hljs-built_in">return</span> files;
}

int <span class="hljs-function"><span class="hljs-title">main</span></span> ()
{
    auto opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>, opt);

	vector&lt;string&gt; e_files = {
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.rst&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.txt&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/file2.RST&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/file3.md&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/will_be.ignored&quot;</span>
	};

	// create files
	<span class="hljs-keyword">for</span> (auto &amp;f: e_files)
	{
		ofstream of(f, ofstream::out);
		of &lt;&lt; <span class="hljs-string">&quot;test&quot;</span>;
	}

    cout &lt;&lt; <span class="hljs-string">&quot;filtered files: &quot;</span> &lt;&lt; <span class="hljs-string">endl;
	for (auto &amp;f: getDirectoryFiles(&quot;.&quot;, {&quot;.rst&quot;, &quot;.RST&quot;, &quot;.md&quot;})){
	    cout &lt;&lt; &quot;\t&quot; &lt;&lt; f &lt;&lt; endl</span>;
	}

    <span class="hljs-built_in">return</span> 0;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/af4228e039a281b3" target="_blank" rel="noopener">Compile and run C&#43;&#43;17 example</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out
filtered files:
	./main.cpp
	./sandbox/file3.md
	./sandbox/will_be.ignored
	./sandbox/a/b/file1.rst
	./sandbox/a/b/file1.txt
	./sandbox/a/file2.RST
	./a.out</code></pre>
</div>
</div>
</div>
</div>
</div><!-- HTML_TAG_END -->
	<div class="comments"><script src="https://utteranc.es/client.js" repo="carlosvin/carlosvin.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div>
	
	<a href="/posts/recursive-directory-iterator/en"></a>
	
	<a href="/posts/recursive-directory-iterator"></a>
</div>
</main>

<script type="application/json" data-type="svelte-data" data-url="/langs/en/posts/recursive-directory-iterator.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"html\":\"\u003Cdiv id=\\\"toc\\\" class=\\\"toc\\\"\u003E\\n\u003Cdiv id=\\\"toctitle\\\"\u003ETable of Contents\u003C\u002Fdiv\u003E\\n\u003Cul class=\\\"sectlevel1\\\"\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_introduction\\\"\u003EIntroduction\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_gettting_started_with_experimental_filesystem_features_c17_g\\\"\u003EGettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_c17_filesystem_features\\\"\u003EC&#43;&#43;17 Filesystem Features\u003C\u002Fa\u003E\\n\u003Cul class=\\\"sectlevel2\\\"\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_stdfilesystempath\\\"\u003Estd::filesystem::path\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_directory_separator\\\"\u003EDirectory separator\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_directory_separator_operator\\\"\u003EDirectory Separator Operator\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_createremove_directories\\\"\u003ECreate\u002FRemove Directories\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_full_example_recursive_directory_iterator\\\"\u003EFull example: Recursive Directory Iterator\u003C\u002Fa\u003E\\n\u003Cul class=\\\"sectlevel2\\\"\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_c11\\\"\u003EC&#43;&#43;11\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"#_c17\\\"\u003EC&#43;&#43;17\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect1\\\"\u003E\\n\u003Ch2 id=\\\"_introduction\\\"\u003EIntroduction\u003C\u002Fh2\u003E\\n\u003Cdiv class=\\\"sectionbody\\\"\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003ESince C&#43;&#43;17 new filesystem abstractions will be added to C&#43;&#43; environment. So far they are available as \u003Ca href=\\\"https:\u002F\u002Fen.cppreference.com\u002Fw\u002Fcpp\u002Fexperimental\\\"\u003EExperimental C&#43;&#43; Features\u003C\u002Fa\u003E. If you want to dig more about this new library, here it is the \u003Ca href=\\\"http:\u002F\u002Fwww.open-std.org\u002Fjtc1\u002Fsc22\u002Fwg21\u002Fdocs\u002Fpapers\u002F2014\u002Fn4100.pdf\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003Efinal draft of File System Technical Specification\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect1\\\"\u003E\\n\u003Ch2 id=\\\"_gettting_started_with_experimental_filesystem_features_c17_g\\\"\u003EGettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)\u003C\u002Fh2\u003E\\n\u003Cdiv class=\\\"sectionbody\\\"\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EWe just have to \\\"tell\\\" compiler that:\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"ulist\\\"\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\\n\u003Cp\u003Ewe write C&#43;&#43;17 (\u003Ccode\u003E-c++1z\u003C\u002Fcode\u003E) and\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003Cli\u003E\\n\u003Cp\u003Eit has to add \u003Cem\u003Estandard library with filesystem library\u003C\u002Fem\u003E (\u003Ccode\u003E-lstdc++fs\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003Eg++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; .\u002Fa.out\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003ELet&#8217;s see a simple example with \u003Ccode\u003Estd::filesystem::path\u003C\u002Fcode\u003E class.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;experimental\u002Ffilesystem&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E fs = std::experimental::filesystem;\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    fs::path aPath {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fpath\u002Fto\u002Ffile.txt&quot;\u003C\u002Fspan\u003E};\\n\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Parent path: &quot;\u003C\u002Fspan\u003E &lt;&lt; aPath.\u003Cspan class=\\\"hljs-built_in\\\"\u003Eparent_path\u003C\u002Fspan\u003E() &lt;&lt; endl;\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Filename: &quot;\u003C\u002Fspan\u003E &lt;&lt; aPath.\u003Cspan class=\\\"hljs-built_in\\\"\u003Efilename\u003C\u002Fspan\u003E() &lt;&lt; endl;\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Extension: &quot;\u003C\u002Fspan\u003E &lt;&lt; aPath.\u003Cspan class=\\\"hljs-built_in\\\"\u003Eextension\u003C\u002Fspan\u003E() &lt;&lt; endl;\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F9f8bebb8b7f0fbe7\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003ECompile and run: Basic C&#43;&#43;17 example\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003E$ g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; .\u002Fa.out\\n$ .\u002Fa.out\\n\\nParent path: \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fpath\u002Fto&quot;\u003C\u002Fspan\u003E\\nFilename: \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;file.txt&quot;\u003C\u002Fspan\u003E\\nExtension: \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.txt&quot;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect1\\\"\u003E\\n\u003Ch2 id=\\\"_c17_filesystem_features\\\"\u003EC&#43;&#43;17 Filesystem Features\u003C\u002Fh2\u003E\\n\u003Cdiv class=\\\"sectionbody\\\"\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EIn this section, we are going to explain some \u003Ca href=\\\"https:\u002F\u002Fen.cppreference.com\u002Fw\u002Fcpp\u002Ffilesystem\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003Estd::filesystem\u003C\u002Fa\u003E features with examples, which will help us to highlight differences between C&#43;&#43;11 and C&#43;&#43;17 so we can get a better idea about what this new library will supply and how it might make developer&#8217;s work easier.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect2\\\"\u003E\\n\u003Ch3 id=\\\"_stdfilesystempath\\\"\u003Estd::filesystem::path\u003C\u002Fh3\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EUpper we have seen a tiny \u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F9f8bebb8b7f0fbe7\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003Euse case for std::filesystem::path\u003C\u002Fa\u003E. That is a quite powerful and convenient feature that supplies an multi-platform abstraction for paths to files using the correct directory path separator depending on the platform we are building our application for (\u003Ccode\u003E\\\\\u003C\u002Fcode\u003E for Windows based systems and \u003Ccode\u003E\u002F\u003C\u002Fcode\u003E for Unix based systems).\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect2\\\"\u003E\\n\u003Ch3 id=\\\"_directory_separator\\\"\u003EDirectory separator\u003C\u002Fh3\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EWhen we want our application to use the correct directory separator in C&#43;&#43;11, we could use conditional macro declaration:\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003EPlatform independent directory separator in C&#43;&#43;11\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Eifdef\u003C\u002Fspan\u003E _WIN32\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string SEP = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\\\\\\\\&quot;\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Eelse\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string SEP = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002F&quot;\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Eendif\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Separator in my system &quot;\u003C\u002Fspan\u003E &lt;&lt; SEP &lt;&lt; endl;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F5023ee989105fc54\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003ECompile and run: C&#43;&#43;11 separator example\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003EPlatform independent directory separator in C&#43;&#43;17. Cleaner and simpler.\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;experimental\u002Ffilesystem&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E fs = std::experimental::filesystem;\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Separator in my system &quot;\u003C\u002Fspan\u003E &lt;&lt; fs::path::preferred_separator &lt;&lt; endl;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F1f2f63b3f5597d05\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003ECompile and run: C&#43;&#43;17 separator example\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect2\\\"\u003E\\n\u003Ch3 id=\\\"_directory_separator_operator\\\"\u003EDirectory Separator Operator\u003C\u002Fh3\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fen.cppreference.com\u002Fw\u002Fcpp\u002Ffilesystem\u002Fpath\\\"\u003Estd::filesystem::path\u003C\u002Fa\u003E implements \u003Ccode\u003E\u002F\u003C\u002Fcode\u003E operator, which allows to easily concatenate paths to files and directories.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EWhen we want to concatenate paths in C&#43;&#43;11, we have to add extra logic to avoid adding duplicate separators and to select the correct separator for target platform:\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003EConcatenate paths in C&#43;&#43;11\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Eifdef\u003C\u002Fspan\u003E _WIN32\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string SEP = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\\\\\\\\&quot;\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Eelse\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string SEP = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002F&quot;\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Eendif\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    string root {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002F&quot;\u003C\u002Fspan\u003E};\\n    string dir {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;var\u002Fwww\u002F&quot;\u003C\u002Fspan\u003E};\\n    string index {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;index.html&quot;\u003C\u002Fspan\u003E};\\n\\n    string pathToIndex{};\\n    pathToIndex.\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(root).\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(SEP).\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(dir).\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(SEP).\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(index);\\n\\n    cout &lt;&lt; pathToIndex &lt;&lt; endl;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F290b278ec1de9573\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003ECompile and run: Concatenate paths in C&#43;&#43;11\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003E\u002F\u002Fvar\u002Fwww\u002F\u002Findex.html\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EChecking program output we notice it is not fully correct, we should have checked whether path parts already contains a separator so we don&#8217;t append another separator again. That logic is already implemented in \u003Ca href=\\\"https:\u002F\u002Fen.cppreference.com\u002Fw\u002Fcpp\u002Ffilesystem\u002Fpath\\\"\u003Estd::filesystem::path\u003C\u002Fa\u003E, so C&#43;&#43;17 can be like:\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003EConcatenate paths in C&#43;&#43;17\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;experimental\u002Ffilesystem&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E fs = std::experimental::filesystem;\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    fs::path root {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002F&quot;\u003C\u002Fspan\u003E};\\n    fs::path dir {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;var\u002Fwww\u002F&quot;\u003C\u002Fspan\u003E};\\n    fs::path index {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;index.html&quot;\u003C\u002Fspan\u003E};\\n\\n    fs::path pathToIndex = root \u002F dir \u002F index;\\n\\n    cout &lt;&lt; pathToIndex &lt;&lt; endl;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002Fa24d50875b4daad1\\\"\u003ECompile and run: Concatenate paths in C&#43;&#43;17\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003E\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002Fvar\u002Fwww\u002Findex.html&quot;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003ECode is cleaner and just correct, there are no duplicated separators.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect2\\\"\u003E\\n\u003Ch3 id=\\\"_createremove_directories\\\"\u003ECreate\u002FRemove Directories\u003C\u002Fh3\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fen.cppreference.com\u002Fw\u002Fcpp\u002Ffilesystem\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003Estd::filesystem\u003C\u002Fa\u003E comes with some utilities to create and remove files and directories, but firstly let&#8217;s try to do so in C&#43;&#43;11.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003ECreate and remove nested directories in C&#43;&#43;11\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;cstdio&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;sys\u002Fstat.h&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eauto\u003C\u002Fspan\u003E opts = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox&quot;\u003C\u002Fspan\u003E, opts);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa&quot;\u003C\u002Fspan\u003E, opts);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa\u002Fb&quot;\u003C\u002Fspan\u003E, opts);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fc&quot;\u003C\u002Fspan\u003E, opts);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fc\u002Fd&quot;\u003C\u002Fspan\u003E, opts);\\n\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Esystem\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;ls -la sandbox\u002F*&quot;\u003C\u002Fspan\u003E);\\n\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Eremove\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fc\u002Fd&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Eremove\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa\u002Fb&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Eremove\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fc&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Eremove\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Eremove\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox&quot;\u003C\u002Fspan\u003E);\\n\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Esystem\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;ls -la&quot;\u003C\u002Fspan\u003E);\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F26f4763ec5b42adb\\\"\u003ECompile and run: Create and remove directories C&#43;&#43;11\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003Eg++-4.9 -std=c++11 main.cpp -lm &amp;&amp; .\u002Fa.out\\nsandbox\u002Fa:\\ntotal 12\\ndrwxr-xr-x 3 2001 2000 4096 May 28 12:27 .\\ndrwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..\\ndrwxr-xr-x 2 2001 2000 4096 May 28 12:27 b\\n\\nsandbox\u002Fc:\\ntotal 12\\ndrwxr-xr-x 3 2001 2000 4096 May 28 12:27 .\\ndrwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..\\ndrwxr-xr-x 2 2001 2000 4096 May 28 12:27 d\\ntotal 8012\\ndrwxrwxrwx 2 2001 2000    4096 May 28 12:27 .\\ndrwxrwxrwx 3 2002 2000 8175616 May 28 12:27 ..\\n-rwxr-xr-x 1 2001 2000    8168 May 28 12:27 a.out\\n-rw-rw-rw- 1 2001 2000     517 May 28 12:27 main.cpp\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EWe have to create\u002Fremove one by one. We could rewrite this code snippet with less lines (using a loop), but we still have to pay attention to creation\u002Fdeletion order, we cannot remove parent directory before we have removed all children.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003ESince C&#43;&#43;17, we can create and remove nested directories with just one call.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003ECreate and remove nested directories C&#43;&#43;17\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;experimental\u002Ffilesystem&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E fs = std::experimental::filesystem;\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    fs::\u003Cspan class=\\\"hljs-built_in\\\"\u003Ecreate_directories\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa\u002Fb&quot;\u003C\u002Fspan\u003E);\\n    fs::\u003Cspan class=\\\"hljs-built_in\\\"\u003Ecreate_directories\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fc\u002Fd&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Esystem\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;ls -la sandbox\u002F*&quot;\u003C\u002Fspan\u003E);\\n\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Were directories removed? &quot;\u003C\u002Fspan\u003E &lt;&lt; fs::\u003Cspan class=\\\"hljs-built_in\\\"\u003Eremove_all\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox&quot;\u003C\u002Fspan\u003E) &lt;&lt; endl;\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Esystem\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;ls -la&quot;\u003C\u002Fspan\u003E);\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002F62c2d22fa0e7144c\\\"\u003ECompile and run: Create and remove nested directories C&#43;&#43;17\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003Eg++ -std=c++1z -fconcepts -fgnu-tm  -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; .\u002Fa.out\\nsandbox\u002Fa:\\ntotal 12\\ndrwxr-xr-x 3 2001 2000 4096 May 28 16:45 .\\ndrwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..\\ndrwxr-xr-x 2 2001 2000 4096 May 28 16:45 b\\n\\nsandbox\u002Fc:\\ntotal 12\\ndrwxr-xr-x 3 2001 2000 4096 May 28 16:45 .\\ndrwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..\\ndrwxr-xr-x 2 2001 2000 4096 May 28 16:45 d\\nWere directories removed? 1\\ntotal 10132\\ndrwxrwxrwx 2 2001 2000    4096 May 28 16:45 .\\ndrwxrwxrwx 3 2002 2000 8175616 May 28 16:45 ..\\n-rwxr-xr-x 1 2001 2000 2170976 May 28 16:45 a.out\\n-rw-rw-rw- 1 2001 2000     393 May 28 16:45 main.cpp\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect1\\\"\u003E\\n\u003Ch2 id=\\\"_full_example_recursive_directory_iterator\\\"\u003EFull example: Recursive Directory Iterator\u003C\u002Fh2\u003E\\n\u003Cdiv class=\\\"sectionbody\\\"\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EThis example consists of iterate recursively through dicrectories fintering files by extension.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect2\\\"\u003E\\n\u003Ch3 id=\\\"_c11\\\"\u003EC&#43;&#43;11\u003C\u002Fh3\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003ETo keep C&#43;&#43;11 example simple, I haven&#8217;t added filtering  logic, but filtering logic is present in C&#43;&#43;17 example:\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003Efilesystem.11.cpp\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-cpp\\\" data-lang=\\\"cpp\\\"\u003E\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;dirent.h&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;cstring&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;iostream&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;fstream&gt;\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F std::ofstream\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;vector&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;memory&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;system_error&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-meta\\\"\u003E#\u003Cspan class=\\\"hljs-keyword\\\"\u003Einclude\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-string\\\"\u003E&lt;sys\u002Fstat.h&gt;\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enamespace\u003C\u002Fspan\u003E std;\\n\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string UP_DIR = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;..&quot;\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string CURRENT_DIR = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.&quot;\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string SEP = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002F&quot;\u003C\u002Fspan\u003E;\\n\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003Estring \u003Cspan class=\\\"hljs-title\\\"\u003Epath\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E(initializer_list&lt;string&gt; parts)\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    string pathTmp {};\\n    string separator = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Eauto\u003C\u002Fspan\u003E &amp; part: parts)\\n    {\\n        pathTmp.\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(separator).\u003Cspan class=\\\"hljs-built_in\\\"\u003Eappend\u003C\u002Fspan\u003E(part);\\n        separator = SEP;\\n    }\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E pathTmp;\\n}\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003Evector&lt;string&gt; \u003Cspan class=\\\"hljs-title\\\"\u003EgetDirectoryFiles\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E(\u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string&amp; dir, \u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E vector&lt;string&gt; &amp; extensions)\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    vector&lt;string&gt; files;\\n    \u003Cspan class=\\\"hljs-function\\\"\u003Eshared_ptr&lt;DIR&gt; \u003Cspan class=\\\"hljs-title\\\"\u003Edirectory_ptr\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E(opendir(dir.c_str()), [](DIR* dir){ dir &amp;&amp; closedir(dir); })\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (!directory_ptr)\\n    {\\n        \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-built_in\\\"\u003Esystem_error\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-built_in\\\"\u003Eerror_code\u003C\u002Fspan\u003E(errno, \u003Cspan class=\\\"hljs-built_in\\\"\u003Esystem_category\u003C\u002Fspan\u003E()), \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Error opening : &quot;\u003C\u002Fspan\u003E + dir);\\n    }\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003Edirent\u003C\u002Fspan\u003E *dirent_ptr;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ewhile\u003C\u002Fspan\u003E ((dirent_ptr = \u003Cspan class=\\\"hljs-built_in\\\"\u003Ereaddir\u003C\u002Fspan\u003E(directory_ptr.\u003Cspan class=\\\"hljs-built_in\\\"\u003Eget\u003C\u002Fspan\u003E())) != \u003Cspan class=\\\"hljs-literal\\\"\u003Enullptr\u003C\u002Fspan\u003E)\\n    {\\n        \u003Cspan class=\\\"hljs-type\\\"\u003Econst\u003C\u002Fspan\u003E string fileName {dirent_ptr-&gt;d_name};\\n        \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (dirent_ptr-&gt;d_type == DT_DIR)\\n        {\\n            \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)\\n            {\\n                \u003Cspan class=\\\"hljs-keyword\\\"\u003Eauto\u003C\u002Fspan\u003E subFiles = \u003Cspan class=\\\"hljs-built_in\\\"\u003EgetDirectoryFiles\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-built_in\\\"\u003Epath\u003C\u002Fspan\u003E({dir, fileName}), extensions);\\n                files.\u003Cspan class=\\\"hljs-built_in\\\"\u003Einsert\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-built_in\\\"\u003Eend\u003C\u002Fspan\u003E(files), \u003Cspan class=\\\"hljs-built_in\\\"\u003Ebegin\u003C\u002Fspan\u003E(subFiles), \u003Cspan class=\\\"hljs-built_in\\\"\u003Eend\u003C\u002Fspan\u003E(subFiles));\\n            }\\n        }\\n        \u003Cspan class=\\\"hljs-keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (dirent_ptr-&gt;d_type == DT_REG)\\n        {\\n            \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F here we should check also if filename has an extension in extensions vector\u003C\u002Fspan\u003E\\n            files.\u003Cspan class=\\\"hljs-built_in\\\"\u003Epush_back\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-built_in\\\"\u003Epath\u003C\u002Fspan\u003E({dir, fileName}));\\n        }\\n    }\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E files;\\n}\\n\\n\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-type\\\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-params\\\"\u003E()\u003C\u002Fspan\u003E\\n\u003C\u002Fspan\u003E{\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eauto\u003C\u002Fspan\u003E opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox&quot;\u003C\u002Fspan\u003E, opt);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa&quot;\u003C\u002Fspan\u003E, opt);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa\u002Fb&quot;\u003C\u002Fspan\u003E, opt);\\n\\n\\tvector&lt;string&gt; e_files = {\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.rst&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.txt&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fa\u002Ffile2.RST&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Ffile3.md&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fwill_be.ignored&quot;\u003C\u002Fspan\u003E\\n\\t};\\n\\n\\t\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F create files\u003C\u002Fspan\u003E\\n\\t\u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Eauto\u003C\u002Fspan\u003E &amp;f: e_files)\\n\\t{\\n\\t\\t\u003Cspan class=\\\"hljs-function\\\"\u003Eofstream \u003Cspan class=\\\"hljs-title\\\"\u003Eof\u003C\u002Fspan\u003E\u003Cspan class=\\\"hljs-params\\\"\u003E(f, ofstream::out)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E;\\n\\t\\tof &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;test&quot;\u003C\u002Fspan\u003E;\\n\\t}\\n\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;filtered files: &quot;\u003C\u002Fspan\u003E &lt;&lt; endl;\\n\\t\u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Eauto\u003C\u002Fspan\u003E &amp;f: \u003Cspan class=\\\"hljs-built_in\\\"\u003EgetDirectoryFiles\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.&quot;\u003C\u002Fspan\u003E, {\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.rst&quot;\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.RST&quot;\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.md&quot;\u003C\u002Fspan\u003E})){\\n\\t    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\\\\t&quot;\u003C\u002Fspan\u003E &lt;&lt; f &lt;&lt; endl;\\n\\t}\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002Faf4228e039a281b3\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003ECompile and run C&#43;&#43;11 example\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003Eg++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; .\u002Fa.out\\nfiltered files:\\n\\t.\u002Fmain.cpp\\n\\t.\u002Fsandbox\u002Ffile3.md\\n\\t.\u002Fsandbox\u002Fwill_be.ignored\\n\\t.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.rst\\n\\t.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.txt\\n\\t.\u002Fsandbox\u002Fa\u002Ffile2.RST\\n\\t.\u002Fa.out\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"sect2\\\"\u003E\\n\u003Ch3 id=\\\"_c17\\\"\u003EC&#43;&#43;17\u003C\u002Fh3\u003E\\n\u003Cdiv class=\\\"paragraph\\\"\u003E\\n\u003Cp\u003EFollowing example also filters files by extension.\u003C\u002Fp\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003Efilesystem.17.cpp\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003E\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;dirent.h&gt;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;cstring&gt;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;iostream&gt;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;fstream&gt; \u002F\u002F std::ofstream\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;vector&gt;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;memory&gt;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;system_error&gt;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E#include &lt;sys\u002Fstat.h&gt;\u003C\u002Fspan\u003E\\n\\nusing namespace std;\\n\\nconst string UP_DIR = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;..&quot;\u003C\u002Fspan\u003E;\\nconst string CURRENT_DIR = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.&quot;\u003C\u002Fspan\u003E;\\nconst string SEP = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;\u002F&quot;\u003C\u002Fspan\u003E;\\n\\n\\nstring path(initializer_list&lt;string&gt; parts)\\n{\\n    string pathTmp {};\\n    string separator = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (auto &amp; part: parts)\\n    {\\n        pathTmp.append(separator).append(part);\\n        separator = SEP;\\n    }\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Ereturn\u003C\u002Fspan\u003E pathTmp;\\n}\\n\\nvector&lt;string&gt; getDirectoryFiles(const string&amp; \u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E, const vector&lt;string&gt; &amp; extensions)\\n{\\n    vector&lt;string&gt; files;\\n    shared_ptr&lt;DIR&gt; directory_ptr(opendir(dir.c_str()), [](DIR* \u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E){ \u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E &amp;&amp; closedir(\u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E); });\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (!directory_ptr)\\n    {\\n        throw system_error(error_code(errno, system_category()), \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Error opening : &quot;\u003C\u002Fspan\u003E + \u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E);\\n    }\\n\\n    struct dirent *dirent_ptr;\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Ewhile\u003C\u002Fspan\u003E ((dirent_ptr = readdir(directory_ptr.get())) != nullptr)\\n    {\\n        const string fileName {dirent_ptr-&gt;d_name};\\n        \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (dirent_ptr-&gt;d_type == DT_DIR)\\n        {\\n            \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)\\n            {\\n                auto subFiles = getDirectoryFiles(path({\u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E, fileName}), extensions);\\n                files.insert(end(files), begin(subFiles), end(subFiles));\\n            }\\n        }\\n        \u003Cspan class=\\\"hljs-keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (dirent_ptr-&gt;d_type == DT_REG)\\n        {\\n            \u002F\u002F here we should check also \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E filename has an extension \u003Cspan class=\\\"hljs-keyword\\\"\u003Ein\u003C\u002Fspan\u003E extensions vector\\n            files.push_back(path({\u003Cspan class=\\\"hljs-built_in\\\"\u003Edir\u003C\u002Fspan\u003E, fileName}));\\n        }\\n    }\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Ereturn\u003C\u002Fspan\u003E files;\\n}\\n\\nint \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-title\\\"\u003Emain\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E ()\\n{\\n    auto opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox&quot;\u003C\u002Fspan\u003E, opt);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa&quot;\u003C\u002Fspan\u003E, opt);\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Emkdir\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;sandbox\u002Fa\u002Fb&quot;\u003C\u002Fspan\u003E, opt);\\n\\n\\tvector&lt;string&gt; e_files = {\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.rst&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.txt&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fa\u002Ffile2.RST&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Ffile3.md&quot;\u003C\u002Fspan\u003E,\\n\\t    \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;.\u002Fsandbox\u002Fwill_be.ignored&quot;\u003C\u002Fspan\u003E\\n\\t};\\n\\n\\t\u002F\u002F create files\\n\\t\u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (auto &amp;f: e_files)\\n\\t{\\n\\t\\tofstream of(f, ofstream::out);\\n\\t\\tof &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;test&quot;\u003C\u002Fspan\u003E;\\n\\t}\\n\\n    cout &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;filtered files: &quot;\u003C\u002Fspan\u003E &lt;&lt; \u003Cspan class=\\\"hljs-string\\\"\u003Eendl;\\n\\tfor (auto &amp;f: getDirectoryFiles(&quot;.&quot;, {&quot;.rst&quot;, &quot;.RST&quot;, &quot;.md&quot;})){\\n\\t    cout &lt;&lt; &quot;\\\\t&quot; &lt;&lt; f &lt;&lt; endl\u003C\u002Fspan\u003E;\\n\\t}\\n\\n    \u003Cspan class=\\\"hljs-built_in\\\"\u003Ereturn\u003C\u002Fspan\u003E 0;\\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"listingblock\\\"\u003E\\n\u003Cdiv class=\\\"title\\\"\u003E\u003Ca href=\\\"https:\u002F\u002Fcoliru.stacked-crooked.com\u002Fa\u002Faf4228e039a281b3\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\"\u003ECompile and run C&#43;&#43;17 example\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E\\n\u003Cdiv class=\\\"content\\\"\u003E\\n\u003Cpre class=\\\"highlight\\\"\u003E\u003Ccode class=\\\"language-bash\\\" data-lang=\\\"bash\\\"\u003Eg++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; .\u002Fa.out\\nfiltered files:\\n\\t.\u002Fmain.cpp\\n\\t.\u002Fsandbox\u002Ffile3.md\\n\\t.\u002Fsandbox\u002Fwill_be.ignored\\n\\t.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.rst\\n\\t.\u002Fsandbox\u002Fa\u002Fb\u002Ffile1.txt\\n\\t.\u002Fsandbox\u002Fa\u002Ffile2.RST\\n\\t.\u002Fa.out\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\\n\u003C\u002Fdiv\u003E\",\"props\":{\"title\":\"Filesystem in C++17\",\"created\":1495954800000,\"modified\":1495954800000,\"filepath\":\"\u002FUsers\u002Fcarlos.martin-sanchez\u002Fpers\u002Fcarlosvin.github.io\u002Fstatic\u002Fposts\u002Frecursive-directory-iterator.en.adoc\",\"dirpath\":\"\u002FUsers\u002Fcarlos.martin-sanchez\u002Fpers\u002Fcarlosvin.github.io\u002Fstatic\u002Fposts\",\"keywords\":[\"C++\",\"C++11\",\"C++17\",\"IO\",\"Filesystem\"],\"lang\":\"en\",\"otherLangs\":[\"es\"],\"slug\":\"recursive-directory-iterator\",\"summary\":\"We are going to analyze with examples new filesystem features coming with C++17\",\"author\":\"Carlos\",\"path\":\"\u002Flangs\u002Fen\u002Fposts\u002Frecursive-directory-iterator\"}}"}</script></div>
	</body>
</html>
