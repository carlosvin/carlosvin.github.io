<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../../favicon.png" />
		<script
			async
			src="https://cdn.jsdelivr.net/npm/@statsig/js-client@1/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-HFdLXhoqeAqLJGsEO0FuGCieE2nSFNxpPp2ziw3ZPYK"
		></script>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="/app.css" />
		
		<link href="../../../../_app/immutable/assets/2.D6-wnWlq.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/IconLink.DCDy1KOq.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/Social.BuJ-IkEK.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/8.BrJEuWPS.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/Details.CFCg3rNQ.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/start.IIzfTrMD.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/entry.Cc1c2pEu.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/runtime.B6RPaHn-.js">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/app.B-pbQJ2K.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/render.D3Fqu4WM.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/svelte-head.DIKBRFqu.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/disclose-version.CC-duLav.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/3.BSPqVS-c.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/props.PCEjw1P-.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/0.B8I90xuT.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/misc.miZ5XAUJ.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/2.CoeVyj2B.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/lifecycle.DkULVVTe.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/attributes.BBFwatIg.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/IconLink.BzKk1u2O.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/Social.Bk_NS1wS.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/8.Bha5KSvC.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/url.BRZsJGrD.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/Details.BxKKAt3G.js"><!--[--><meta name="date.created" content="2017-05-28T07:00:00.000Z"> <meta name="date.updated" content="2017-05-28T07:00:00.000Z"> <meta name="description" content="We are going to analyze with examples new filesystem features coming with C++17"> <!--[--><!--[--><link rel="alternate" hreflang="es" href="/langs/es/posts/recursive-directory-iterator"><!--]--><!--]--> <!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"Webpage","@id":"https://google.com/article"},"headline":"Filesystem in C++17","alternativeHeadline":"We are going to analyze with examples new filesystem features coming with C++17","description":"We are going to analyze with examples new filesystem features coming with C++17","datePublished":"2017-05-28T07:00:00.000Z","dateModified":"2017-05-28T07:00:00.000Z","keywords":["C++","C++11","C++17","IO","Filesystem"],"author":{"@type":"Person","name":"Carlos"},"publisher":{"@type":"Person","name":"Carlos"}}</script><!----><!--]--><title>Filesystem in C++17</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!----><!--[--><!----><nav class="svelte-1kqmhwi"><ul class="svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/en/posts" rel="prefetch" class="svelte-1rykg79"><!----><img class="logo svelte-1kqmhwi" src="/favicon.25px.png" alt="Carlos Say's Bla Bla logo"><!----></a></li><!----></ul> <ul class="closed svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/en/posts" rel="prefetch" class="svelte-1rykg79"><!----><span class="siteName">Carlos Say's Bla Bla</span><!----></a></li><!----> <li class="svelte-1rykg79"><a href="/langs/en/categories" rel="prefetch" class="svelte-1rykg79"><!----><!---->Categories<!----></a></li><!----> <li class="svelte-1rykg79"><a href="/langs/en/about" rel="prefetch" class="svelte-1rykg79"><!----><!---->About me<!----></a></li><!----></ul> <!--[--><!----><div class="h svelte-geb0ta"><!----><a href="/langs/en/feed.xml" target="_blank" class="icon rss svelte-blgowr" title="Subscribe to the feed Carlos Say's Bla Bla" rel="noopener" aria-label="Subscribe to the feed Carlos Say's Bla Bla"><!----><!----></a><!----> <a href="https://github.com/carlosvin" target="_blank" class="icon github svelte-blgowr" title="Find me at github" rel="noopener" aria-label="Find me at github"><!----><!----></a><!----> <a href="https://stackoverflow.com/users/1421059/carlosvin" target="_blank" class="icon stackoverflow svelte-blgowr" title="Find me at stackoverflow" rel="noopener" aria-label="Find me at stackoverflow"><!----><!----></a><!----></div><!----><!--]--> <button type="button" class="svelte-1kqmhwi">â‰¡</button></nav><!----> <main class="svelte-7ld3yf"><!----><!----><header class="svelte-1ikjkmw"><h1 class="svelte-1ikjkmw">Filesystem in C++17 <span class="share svelte-1ikjkmw"><!--[!--><a href="https://twitter.com/intent/tweet?url=/langs/en/posts/recursive-directory-iterator&amp;text=Filesystem in C++17:&amp;nbsp;We are going to analyze with examples new filesystem features coming with C++17&amp;hashtags=C++,C++11,C++17,IO,Filesystem" target="_blank" class="icon twitter svelte-blgowr" title="Share &quot;Filesystem in C++17&quot;" rel="noopener" aria-label="Share &quot;Filesystem in C++17&quot;"><!----><!----></a><!--]--><!----></span></h1> <p class="summary svelte-1ikjkmw">We are going to analyze with examples new filesystem features coming with C++17</p> <div class="subtitle svelte-9uod0d"><span class="date">5/28/2017</span> <span class="langs"><!--[--><ul class="otherLangs svelte-1numgf3"><!--[--><!--[--><li class="svelte-1numgf3"><a rel="alternate" hreflang="es" href="/langs/es/posts/recursive-directory-iterator" title="Check the post in other language: es">es</a></li><!--]--><!--]--></ul><!--]--><!----></span> <!--[--><span class="tags svelte-wqh6y7"><!--[--><a href="/langs/en/categories/c" title="C++" class="svelte-1g7d2s3">C++</a><a href="/langs/en/categories/c11" title="C++11" class="svelte-1g7d2s3">C++11</a><a href="/langs/en/categories/c17" title="C++17" class="svelte-1g7d2s3">C++17</a><a href="/langs/en/categories/io" title="IO" class="svelte-1g7d2s3">IO</a><a href="/langs/en/categories/filesystem" title="Filesystem" class="svelte-1g7d2s3">Filesystem</a><!--]--></span><!--]--><!----></div><!----></header> <div class="postContent"><!----><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_gettting_started_with_experimental_filesystem_features_c17_g">Gettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)</a></li>
<li><a href="#_c17_filesystem_features">C&#43;&#43;17 Filesystem Features</a>
<ul class="sectlevel2">
<li><a href="#_stdfilesystempath">std::filesystem::path</a></li>
<li><a href="#_directory_separator">Directory separator</a></li>
<li><a href="#_directory_separator_operator">Directory Separator Operator</a></li>
<li><a href="#_createremove_directories">Create/Remove Directories</a></li>
</ul>
</li>
<li><a href="#_full_example_recursive_directory_iterator">Full example: Recursive Directory Iterator</a>
<ul class="sectlevel2">
<li><a href="#_c11">C&#43;&#43;11</a></li>
<li><a href="#_c17">C&#43;&#43;17</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since C&#43;&#43;17 new filesystem abstractions will be added to C&#43;&#43; environment. So far they are available as <a href="https://en.cppreference.com/w/cpp/experimental">Experimental C&#43;&#43; Features</a>. If you want to dig more about this new library, here it is the <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4100.pdf" target="_blank" rel="noopener">final draft of File System Technical Specification</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gettting_started_with_experimental_filesystem_features_c17_g">Gettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We just have to "tell" compiler that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>we write C&#43;&#43;17 (<code>-c++1z</code>) and</p>
</li>
<li>
<p>it has to add <em>standard library with filesystem library</em> (<code>-lstdc++fs</code>).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; ./a.out</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s see a simple example with <code>std::filesystem::path</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    fs::path aPath {<span class="hljs-string">&quot;./path/to/file.txt&quot;</span>};

    cout &lt;&lt; <span class="hljs-string">&quot;Parent path: &quot;</span> &lt;&lt; aPath.<span class="hljs-built_in">parent_path</span>() &lt;&lt; endl;
    cout &lt;&lt; <span class="hljs-string">&quot;Filename: &quot;</span> &lt;&lt; aPath.<span class="hljs-built_in">filename</span>() &lt;&lt; endl;
    cout &lt;&lt; <span class="hljs-string">&quot;Extension: &quot;</span> &lt;&lt; aPath.<span class="hljs-built_in">extension</span>() &lt;&lt; endl;

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/9f8bebb8b7f0fbe7" target="_blank" rel="noopener">Compile and run: Basic C&#43;&#43;17 example</a></div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; ./a.out
$ ./a.out

Parent path: <span class="hljs-string">&quot;./path/to&quot;</span>
Filename: <span class="hljs-string">&quot;file.txt&quot;</span>
Extension: <span class="hljs-string">&quot;.txt&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c17_filesystem_features">C&#43;&#43;17 Filesystem Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we are going to explain some <a href="https://en.cppreference.com/w/cpp/filesystem" target="_blank" rel="noopener">std::filesystem</a> features with examples, which will help us to highlight differences between C&#43;&#43;11 and C&#43;&#43;17 so we can get a better idea about what this new library will supply and how it might make developer&#8217;s work easier.</p>
</div>
<div class="sect2">
<h3 id="_stdfilesystempath">std::filesystem::path</h3>
<div class="paragraph">
<p>Upper we have seen a tiny <a href="https://coliru.stacked-crooked.com/a/9f8bebb8b7f0fbe7" target="_blank" rel="noopener">use case for std::filesystem::path</a>. That is a quite powerful and convenient feature that supplies an multi-platform abstraction for paths to files using the correct directory path separator depending on the platform we are building our application for (<code>\</code> for Windows based systems and <code>/</code> for Unix based systems).</p>
</div>
</div>
<div class="sect2">
<h3 id="_directory_separator">Directory separator</h3>
<div class="paragraph">
<p>When we want our application to use the correct directory separator in C&#43;&#43;11, we could use conditional macro declaration:</p>
</div>
<div class="listingblock">
<div class="title">Platform independent directory separator in C&#43;&#43;11</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;\\&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;/&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    cout &lt;&lt; <span class="hljs-string">&quot;Separator in my system &quot;</span> &lt;&lt; SEP &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://coliru.stacked-crooked.com/a/5023ee989105fc54" target="_blank" rel="noopener">Compile and run: C&#43;&#43;11 separator example</a>.</p>
</div>
<div class="listingblock">
<div class="title">Platform independent directory separator in C&#43;&#43;17. Cleaner and simpler.</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    cout &lt;&lt; <span class="hljs-string">&quot;Separator in my system &quot;</span> &lt;&lt; fs::path::preferred_separator &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://coliru.stacked-crooked.com/a/1f2f63b3f5597d05" target="_blank" rel="noopener">Compile and run: C&#43;&#43;17 separator example</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_directory_separator_operator">Directory Separator Operator</h3>
<div class="paragraph">
<p><a href="https://en.cppreference.com/w/cpp/filesystem/path">std::filesystem::path</a> implements <code>/</code> operator, which allows to easily concatenate paths to files and directories.</p>
</div>
<div class="paragraph">
<p>When we want to concatenate paths in C&#43;&#43;11, we have to add extra logic to avoid adding duplicate separators and to select the correct separator for target platform:</p>
</div>
<div class="listingblock">
<div class="title">Concatenate paths in C&#43;&#43;11</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;\\&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;/&quot;</span>;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    string root {<span class="hljs-string">&quot;/&quot;</span>};
    string dir {<span class="hljs-string">&quot;var/www/&quot;</span>};
    string index {<span class="hljs-string">&quot;index.html&quot;</span>};

    string pathToIndex{};
    pathToIndex.<span class="hljs-built_in">append</span>(root).<span class="hljs-built_in">append</span>(SEP).<span class="hljs-built_in">append</span>(dir).<span class="hljs-built_in">append</span>(SEP).<span class="hljs-built_in">append</span>(index);

    cout &lt;&lt; pathToIndex &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/290b278ec1de9573" target="_blank" rel="noopener">Compile and run: Concatenate paths in C&#43;&#43;11</a></div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">//var/www//index.html</code></pre>
</div>
</div>
<div class="paragraph">
<p>Checking program output we notice it is not fully correct, we should have checked whether path parts already contains a separator so we don&#8217;t append another separator again. That logic is already implemented in <a href="https://en.cppreference.com/w/cpp/filesystem/path">std::filesystem::path</a>, so C&#43;&#43;17 can be like:</p>
</div>
<div class="listingblock">
<div class="title">Concatenate paths in C&#43;&#43;17</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    fs::path root {<span class="hljs-string">&quot;/&quot;</span>};
    fs::path dir {<span class="hljs-string">&quot;var/www/&quot;</span>};
    fs::path index {<span class="hljs-string">&quot;index.html&quot;</span>};

    fs::path pathToIndex = root / dir / index;

    cout &lt;&lt; pathToIndex &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/a24d50875b4daad1">Compile and run: Concatenate paths in C&#43;&#43;17</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"><span class="hljs-string">&quot;/var/www/index.html&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Code is cleaner and just correct, there are no duplicated separators.</p>
</div>
</div>
<div class="sect2">
<h3 id="_createremove_directories">Create/Remove Directories</h3>
<div class="paragraph">
<p><a href="https://en.cppreference.com/w/cpp/filesystem" target="_blank" rel="noopener">std::filesystem</a> comes with some utilities to create and remove files and directories, but firstly let&#8217;s try to do so in C&#43;&#43;11.</p>
</div>
<div class="listingblock">
<div class="title">Create and remove nested directories in C&#43;&#43;11</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> opts = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/c&quot;</span>, opts);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/c/d&quot;</span>, opts);

    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la sandbox/*&quot;</span>);

    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/c/d&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/c&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>);
    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;sandbox&quot;</span>);

    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la&quot;</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/26f4763ec5b42adb">Compile and run: Create and remove directories C&#43;&#43;11</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++-4.9 -std=c++11 main.cpp -lm &amp;&amp; ./a.out
sandbox/a:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 12:27 .
drwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..
drwxr-xr-x 2 2001 2000 4096 May 28 12:27 b

sandbox/c:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 12:27 .
drwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..
drwxr-xr-x 2 2001 2000 4096 May 28 12:27 d
total 8012
drwxrwxrwx 2 2001 2000    4096 May 28 12:27 .
drwxrwxrwx 3 2002 2000 8175616 May 28 12:27 ..
-rwxr-xr-x 1 2001 2000    8168 May 28 12:27 a.out
-rw-rw-rw- 1 2001 2000     517 May 28 12:27 main.cpp</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have to create/remove one by one. We could rewrite this code snippet with less lines (using a loop), but we still have to pay attention to creation/deletion order, we cannot remove parent directory before we have removed all children.</p>
</div>
<div class="paragraph">
<p>Since C&#43;&#43;17, we can create and remove nested directories with just one call.</p>
</div>
<div class="listingblock">
<div class="title">Create and remove nested directories C&#43;&#43;17</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;experimental/filesystem&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">namespace</span> fs = std::experimental::filesystem;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    fs::<span class="hljs-built_in">create_directories</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>);
    fs::<span class="hljs-built_in">create_directories</span>(<span class="hljs-string">&quot;sandbox/c/d&quot;</span>);
    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la sandbox/*&quot;</span>);

    cout &lt;&lt; <span class="hljs-string">&quot;Were directories removed? &quot;</span> &lt;&lt; fs::<span class="hljs-built_in">remove_all</span>(<span class="hljs-string">&quot;sandbox&quot;</span>) &lt;&lt; endl;
    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la&quot;</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/62c2d22fa0e7144c">Compile and run: Create and remove nested directories C&#43;&#43;17</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++1z -fconcepts -fgnu-tm  -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out
sandbox/a:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 16:45 .
drwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..
drwxr-xr-x 2 2001 2000 4096 May 28 16:45 b

sandbox/c:
total 12
drwxr-xr-x 3 2001 2000 4096 May 28 16:45 .
drwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..
drwxr-xr-x 2 2001 2000 4096 May 28 16:45 d
Were directories removed? 1
total 10132
drwxrwxrwx 2 2001 2000    4096 May 28 16:45 .
drwxrwxrwx 3 2002 2000 8175616 May 28 16:45 ..
-rwxr-xr-x 1 2001 2000 2170976 May 28 16:45 a.out
-rw-rw-rw- 1 2001 2000     393 May 28 16:45 main.cpp</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_full_example_recursive_directory_iterator">Full example: Recursive Directory Iterator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This example consists of iterate recursively through dicrectories fintering files by extension.</p>
</div>
<div class="sect2">
<h3 id="_c11">C&#43;&#43;11</h3>
<div class="paragraph">
<p>To keep C&#43;&#43;11 example simple, I haven&#8217;t added filtering  logic, but filtering logic is present in C&#43;&#43;17 example:</p>
</div>
<div class="listingblock">
<div class="title">filesystem.11.cpp</div>
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;dirent.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span> <span class="hljs-comment">// std::ofstream</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;system_error&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">const</span> string UP_DIR = <span class="hljs-string">&quot;..&quot;</span>;
<span class="hljs-type">const</span> string CURRENT_DIR = <span class="hljs-string">&quot;.&quot;</span>;
<span class="hljs-type">const</span> string SEP = <span class="hljs-string">&quot;/&quot;</span>;


<span class="hljs-function">string <span class="hljs-title">path</span><span class="hljs-params">(initializer_list&lt;string&gt; parts)</span>
</span>{
    string pathTmp {};
    string separator = <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp; part: parts)
    {
        pathTmp.<span class="hljs-built_in">append</span>(separator).<span class="hljs-built_in">append</span>(part);
        separator = SEP;
    }
    <span class="hljs-keyword">return</span> pathTmp;
}

<span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">getDirectoryFiles</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; dir, <span class="hljs-type">const</span> vector&lt;string&gt; &amp; extensions)</span>
</span>{
    vector&lt;string&gt; files;
    <span class="hljs-function">shared_ptr&lt;DIR&gt; <span class="hljs-title">directory_ptr</span><span class="hljs-params">(opendir(dir.c_str()), [](DIR* dir){ dir &amp;&amp; closedir(dir); })</span></span>;
    <span class="hljs-keyword">if</span> (!directory_ptr)
    {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">system_error</span>(<span class="hljs-built_in">error_code</span>(errno, <span class="hljs-built_in">system_category</span>()), <span class="hljs-string">&quot;Error opening : &quot;</span> + dir);
    }

    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">dirent</span> *dirent_ptr;
    <span class="hljs-keyword">while</span> ((dirent_ptr = <span class="hljs-built_in">readdir</span>(directory_ptr.<span class="hljs-built_in">get</span>())) != <span class="hljs-literal">nullptr</span>)
    {
        <span class="hljs-type">const</span> string fileName {dirent_ptr-&gt;d_name};
        <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_DIR)
        {
            <span class="hljs-keyword">if</span> (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)
            {
                <span class="hljs-keyword">auto</span> subFiles = <span class="hljs-built_in">getDirectoryFiles</span>(<span class="hljs-built_in">path</span>({dir, fileName}), extensions);
                files.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">end</span>(files), <span class="hljs-built_in">begin</span>(subFiles), <span class="hljs-built_in">end</span>(subFiles));
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_REG)
        {
            <span class="hljs-comment">// here we should check also if filename has an extension in extensions vector</span>
            files.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">path</span>({dir, fileName}));
        }
    }
    <span class="hljs-keyword">return</span> files;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>, opt);

	vector&lt;string&gt; e_files = {
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.rst&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.txt&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/file2.RST&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/file3.md&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/will_be.ignored&quot;</span>
	};

	<span class="hljs-comment">// create files</span>
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;f: e_files)
	{
		<span class="hljs-function">ofstream <span class="hljs-title">of</span><span class="hljs-params">(f, ofstream::out)</span></span>;
		of &lt;&lt; <span class="hljs-string">&quot;test&quot;</span>;
	}

    cout &lt;&lt; <span class="hljs-string">&quot;filtered files: &quot;</span> &lt;&lt; endl;
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;f: <span class="hljs-built_in">getDirectoryFiles</span>(<span class="hljs-string">&quot;.&quot;</span>, {<span class="hljs-string">&quot;.rst&quot;</span>, <span class="hljs-string">&quot;.RST&quot;</span>, <span class="hljs-string">&quot;.md&quot;</span>})){
	    cout &lt;&lt; <span class="hljs-string">&quot;\t&quot;</span> &lt;&lt; f &lt;&lt; endl;
	}

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/af4228e039a281b3" target="_blank" rel="noopener">Compile and run C&#43;&#43;11 example</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out
filtered files:
	./main.cpp
	./sandbox/file3.md
	./sandbox/will_be.ignored
	./sandbox/a/b/file1.rst
	./sandbox/a/b/file1.txt
	./sandbox/a/file2.RST
	./a.out</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_c17">C&#43;&#43;17</h3>
<div class="paragraph">
<p>Following example also filters files by extension.</p>
</div>
<div class="listingblock">
<div class="title">filesystem.17.cpp</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"><span class="hljs-comment">#include &lt;dirent.h&gt;</span>
<span class="hljs-comment">#include &lt;cstring&gt;</span>
<span class="hljs-comment">#include &lt;iostream&gt;</span>
<span class="hljs-comment">#include &lt;fstream&gt; // std::ofstream</span>
<span class="hljs-comment">#include &lt;vector&gt;</span>
<span class="hljs-comment">#include &lt;memory&gt;</span>
<span class="hljs-comment">#include &lt;system_error&gt;</span>
<span class="hljs-comment">#include &lt;sys/stat.h&gt;</span>

using namespace std;

const string UP_DIR = <span class="hljs-string">&quot;..&quot;</span>;
const string CURRENT_DIR = <span class="hljs-string">&quot;.&quot;</span>;
const string SEP = <span class="hljs-string">&quot;/&quot;</span>;


string path(initializer_list&lt;string&gt; parts)
{
    string pathTmp {};
    string separator = <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">for</span> (auto &amp; part: parts)
    {
        pathTmp.append(separator).append(part);
        separator = SEP;
    }
    <span class="hljs-built_in">return</span> pathTmp;
}

vector&lt;string&gt; getDirectoryFiles(const string&amp; <span class="hljs-built_in">dir</span>, const vector&lt;string&gt; &amp; extensions)
{
    vector&lt;string&gt; files;
    shared_ptr&lt;DIR&gt; directory_ptr(opendir(dir.c_str()), [](DIR* <span class="hljs-built_in">dir</span>){ <span class="hljs-built_in">dir</span> &amp;&amp; closedir(<span class="hljs-built_in">dir</span>); });
    <span class="hljs-keyword">if</span> (!directory_ptr)
    {
        throw system_error(error_code(errno, system_category()), <span class="hljs-string">&quot;Error opening : &quot;</span> + <span class="hljs-built_in">dir</span>);
    }

    struct dirent *dirent_ptr;
    <span class="hljs-keyword">while</span> ((dirent_ptr = readdir(directory_ptr.get())) != nullptr)
    {
        const string fileName {dirent_ptr-&gt;d_name};
        <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_DIR)
        {
            <span class="hljs-keyword">if</span> (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)
            {
                auto subFiles = getDirectoryFiles(path({<span class="hljs-built_in">dir</span>, fileName}), extensions);
                files.insert(end(files), begin(subFiles), end(subFiles));
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dirent_ptr-&gt;d_type == DT_REG)
        {
            // here we should check also <span class="hljs-keyword">if</span> filename has an extension <span class="hljs-keyword">in</span> extensions vector
            files.push_back(path({<span class="hljs-built_in">dir</span>, fileName}));
        }
    }
    <span class="hljs-built_in">return</span> files;
}

int <span class="hljs-function"><span class="hljs-title">main</span></span> ()
{
    auto opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a&quot;</span>, opt);
    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;sandbox/a/b&quot;</span>, opt);

	vector&lt;string&gt; e_files = {
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.rst&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/b/file1.txt&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/a/file2.RST&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/file3.md&quot;</span>,
	    <span class="hljs-string">&quot;./sandbox/will_be.ignored&quot;</span>
	};

	// create files
	<span class="hljs-keyword">for</span> (auto &amp;f: e_files)
	{
		ofstream of(f, ofstream::out);
		of &lt;&lt; <span class="hljs-string">&quot;test&quot;</span>;
	}

    cout &lt;&lt; <span class="hljs-string">&quot;filtered files: &quot;</span> &lt;&lt; <span class="hljs-string">endl;
	for (auto &amp;f: getDirectoryFiles(&quot;.&quot;, {&quot;.rst&quot;, &quot;.RST&quot;, &quot;.md&quot;})){
	    cout &lt;&lt; &quot;\t&quot; &lt;&lt; f &lt;&lt; endl</span>;
	}

    <span class="hljs-built_in">return</span> 0;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://coliru.stacked-crooked.com/a/af4228e039a281b3" target="_blank" rel="noopener">Compile and run C&#43;&#43;17 example</a>.</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">g++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out
filtered files:
	./main.cpp
	./sandbox/file3.md
	./sandbox/will_be.ignored
	./sandbox/a/b/file1.rst
	./sandbox/a/b/file1.txt
	./sandbox/a/file2.RST
	./a.out</code></pre>
</div>
</div>
</div>
</div>
</div><!----> <div class="comments"><script src="https://utteranc.es/client.js" repo="carlosvin/carlosvin.github.io" issue-term="title" label="comment" theme="github-light" crossorigin="anonymous" async>
	</script></div><!----></div><!----><!----><!----></main><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_nj8046 = {
						base: new URL("../../../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{path:"/langs/en/posts/recursive-directory-iterator/",lang:"en",translations:{lang:"en",author:"Carlos Martin Sanchez",siteName:"Carlos Say's Bla Bla",siteDescription:"What is going on in my mind and its surroundings",categories:"categories",Categories:"Categories",RecentPosts:"Recent posts",NoPosts:"There are no posts",SubscribeTo:"Subscribe to the feed",AboutMe:"About me",AllPosts:"All posts"}},"uses":{"params":["lang"],"url":1},"slash":"always"},{"type":"data","data":{html:"\u003Cdiv id=\"toc\" class=\"toc\">\n\u003Cdiv id=\"toctitle\">Table of Contents\u003C/div>\n\u003Cul class=\"sectlevel1\">\n\u003Cli>\u003Ca href=\"#_introduction\">Introduction\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_gettting_started_with_experimental_filesystem_features_c17_g\">Gettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_c17_filesystem_features\">C&#43;&#43;17 Filesystem Features\u003C/a>\n\u003Cul class=\"sectlevel2\">\n\u003Cli>\u003Ca href=\"#_stdfilesystempath\">std::filesystem::path\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_directory_separator\">Directory separator\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_directory_separator_operator\">Directory Separator Operator\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_createremove_directories\">Create/Remove Directories\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Ca href=\"#_full_example_recursive_directory_iterator\">Full example: Recursive Directory Iterator\u003C/a>\n\u003Cul class=\"sectlevel2\">\n\u003Cli>\u003Ca href=\"#_c11\">C&#43;&#43;11\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_c17\">C&#43;&#43;17\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_introduction\">Introduction\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Since C&#43;&#43;17 new filesystem abstractions will be added to C&#43;&#43; environment. So far they are available as \u003Ca href=\"https://en.cppreference.com/w/cpp/experimental\">Experimental C&#43;&#43; Features\u003C/a>. If you want to dig more about this new library, here it is the \u003Ca href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4100.pdf\" target=\"_blank\" rel=\"noopener\">final draft of File System Technical Specification\u003C/a>.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_gettting_started_with_experimental_filesystem_features_c17_g\">Gettting started with Experimental Filesystem Features C&#43;&#43;17 (g++)\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>We just have to \"tell\" compiler that:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>we write C&#43;&#43;17 (\u003Ccode>-c++1z\u003C/code>) and\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>it has to add \u003Cem>standard library with filesystem library\u003C/em> (\u003Ccode>-lstdc++fs\u003C/code>).\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; ./a.out\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Let&#8217;s see a simple example with \u003Ccode>std::filesystem::path\u003C/code> class.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;experimental/filesystem&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">namespace\u003C/span> fs = std::experimental::filesystem;\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    fs::path aPath {\u003Cspan class=\"hljs-string\">&quot;./path/to/file.txt&quot;\u003C/span>};\n\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;Parent path: &quot;\u003C/span> &lt;&lt; aPath.\u003Cspan class=\"hljs-built_in\">parent_path\u003C/span>() &lt;&lt; endl;\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;Filename: &quot;\u003C/span> &lt;&lt; aPath.\u003Cspan class=\"hljs-built_in\">filename\u003C/span>() &lt;&lt; endl;\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;Extension: &quot;\u003C/span> &lt;&lt; aPath.\u003Cspan class=\"hljs-built_in\">extension\u003C/span>() &lt;&lt; endl;\n\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/9f8bebb8b7f0fbe7\" target=\"_blank\" rel=\"noopener\">Compile and run: Basic C&#43;&#43;17 example\u003C/a>\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">$ g++ -std=c++1z main.cpp -lstdc++fs &amp;&amp; ./a.out\n$ ./a.out\n\nParent path: \u003Cspan class=\"hljs-string\">&quot;./path/to&quot;\u003C/span>\nFilename: \u003Cspan class=\"hljs-string\">&quot;file.txt&quot;\u003C/span>\nExtension: \u003Cspan class=\"hljs-string\">&quot;.txt&quot;\u003C/span>\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_c17_filesystem_features\">C&#43;&#43;17 Filesystem Features\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>In this section, we are going to explain some \u003Ca href=\"https://en.cppreference.com/w/cpp/filesystem\" target=\"_blank\" rel=\"noopener\">std::filesystem\u003C/a> features with examples, which will help us to highlight differences between C&#43;&#43;11 and C&#43;&#43;17 so we can get a better idea about what this new library will supply and how it might make developer&#8217;s work easier.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_stdfilesystempath\">std::filesystem::path\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Upper we have seen a tiny \u003Ca href=\"https://coliru.stacked-crooked.com/a/9f8bebb8b7f0fbe7\" target=\"_blank\" rel=\"noopener\">use case for std::filesystem::path\u003C/a>. That is a quite powerful and convenient feature that supplies an multi-platform abstraction for paths to files using the correct directory path separator depending on the platform we are building our application for (\u003Ccode>\\\u003C/code> for Windows based systems and \u003Ccode>/\u003C/code> for Unix based systems).\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_directory_separator\">Directory separator\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>When we want our application to use the correct directory separator in C&#43;&#43;11, we could use conditional macro declaration:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">Platform independent directory separator in C&#43;&#43;11\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">ifdef\u003C/span> _WIN32\u003C/span>\n\u003Cspan class=\"hljs-type\">const\u003C/span> string SEP = \u003Cspan class=\"hljs-string\">&quot;\\\\&quot;\u003C/span>;\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">else\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-type\">const\u003C/span> string SEP = \u003Cspan class=\"hljs-string\">&quot;/&quot;\u003C/span>;\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">endif\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;Separator in my system &quot;\u003C/span> &lt;&lt; SEP &lt;&lt; endl;\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>\u003Ca href=\"https://coliru.stacked-crooked.com/a/5023ee989105fc54\" target=\"_blank\" rel=\"noopener\">Compile and run: C&#43;&#43;11 separator example\u003C/a>.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">Platform independent directory separator in C&#43;&#43;17. Cleaner and simpler.\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;experimental/filesystem&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">namespace\u003C/span> fs = std::experimental::filesystem;\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;Separator in my system &quot;\u003C/span> &lt;&lt; fs::path::preferred_separator &lt;&lt; endl;\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>\u003Ca href=\"https://coliru.stacked-crooked.com/a/1f2f63b3f5597d05\" target=\"_blank\" rel=\"noopener\">Compile and run: C&#43;&#43;17 separator example\u003C/a>.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_directory_separator_operator\">Directory Separator Operator\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>\u003Ca href=\"https://en.cppreference.com/w/cpp/filesystem/path\">std::filesystem::path\u003C/a> implements \u003Ccode>/\u003C/code> operator, which allows to easily concatenate paths to files and directories.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>When we want to concatenate paths in C&#43;&#43;11, we have to add extra logic to avoid adding duplicate separators and to select the correct separator for target platform:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">Concatenate paths in C&#43;&#43;11\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">ifdef\u003C/span> _WIN32\u003C/span>\n\u003Cspan class=\"hljs-type\">const\u003C/span> string SEP = \u003Cspan class=\"hljs-string\">&quot;\\\\&quot;\u003C/span>;\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">else\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-type\">const\u003C/span> string SEP = \u003Cspan class=\"hljs-string\">&quot;/&quot;\u003C/span>;\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">endif\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    string root {\u003Cspan class=\"hljs-string\">&quot;/&quot;\u003C/span>};\n    string dir {\u003Cspan class=\"hljs-string\">&quot;var/www/&quot;\u003C/span>};\n    string index {\u003Cspan class=\"hljs-string\">&quot;index.html&quot;\u003C/span>};\n\n    string pathToIndex{};\n    pathToIndex.\u003Cspan class=\"hljs-built_in\">append\u003C/span>(root).\u003Cspan class=\"hljs-built_in\">append\u003C/span>(SEP).\u003Cspan class=\"hljs-built_in\">append\u003C/span>(dir).\u003Cspan class=\"hljs-built_in\">append\u003C/span>(SEP).\u003Cspan class=\"hljs-built_in\">append\u003C/span>(index);\n\n    cout &lt;&lt; pathToIndex &lt;&lt; endl;\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/290b278ec1de9573\" target=\"_blank\" rel=\"noopener\">Compile and run: Concatenate paths in C&#43;&#43;11\u003C/a>\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">//var/www//index.html\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Checking program output we notice it is not fully correct, we should have checked whether path parts already contains a separator so we don&#8217;t append another separator again. That logic is already implemented in \u003Ca href=\"https://en.cppreference.com/w/cpp/filesystem/path\">std::filesystem::path\u003C/a>, so C&#43;&#43;17 can be like:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">Concatenate paths in C&#43;&#43;17\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;experimental/filesystem&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">namespace\u003C/span> fs = std::experimental::filesystem;\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    fs::path root {\u003Cspan class=\"hljs-string\">&quot;/&quot;\u003C/span>};\n    fs::path dir {\u003Cspan class=\"hljs-string\">&quot;var/www/&quot;\u003C/span>};\n    fs::path index {\u003Cspan class=\"hljs-string\">&quot;index.html&quot;\u003C/span>};\n\n    fs::path pathToIndex = root / dir / index;\n\n    cout &lt;&lt; pathToIndex &lt;&lt; endl;\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/a24d50875b4daad1\">Compile and run: Concatenate paths in C&#43;&#43;17\u003C/a>.\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">\u003Cspan class=\"hljs-string\">&quot;/var/www/index.html&quot;\u003C/span>\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Code is cleaner and just correct, there are no duplicated separators.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_createremove_directories\">Create/Remove Directories\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>\u003Ca href=\"https://en.cppreference.com/w/cpp/filesystem\" target=\"_blank\" rel=\"noopener\">std::filesystem\u003C/a> comes with some utilities to create and remove files and directories, but firstly let&#8217;s try to do so in C&#43;&#43;11.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">Create and remove nested directories in C&#43;&#43;11\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;cstdio&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;sys/stat.h&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    \u003Cspan class=\"hljs-keyword\">auto\u003C/span> opts = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox&quot;\u003C/span>, opts);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a&quot;\u003C/span>, opts);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a/b&quot;\u003C/span>, opts);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/c&quot;\u003C/span>, opts);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/c/d&quot;\u003C/span>, opts);\n\n    \u003Cspan class=\"hljs-built_in\">system\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;ls -la sandbox/*&quot;\u003C/span>);\n\n    \u003Cspan class=\"hljs-built_in\">remove\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/c/d&quot;\u003C/span>);\n    \u003Cspan class=\"hljs-built_in\">remove\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a/b&quot;\u003C/span>);\n    \u003Cspan class=\"hljs-built_in\">remove\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/c&quot;\u003C/span>);\n    \u003Cspan class=\"hljs-built_in\">remove\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a&quot;\u003C/span>);\n    \u003Cspan class=\"hljs-built_in\">remove\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox&quot;\u003C/span>);\n\n    \u003Cspan class=\"hljs-built_in\">system\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;ls -la&quot;\u003C/span>);\n\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/26f4763ec5b42adb\">Compile and run: Create and remove directories C&#43;&#43;11\u003C/a>.\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">g++-4.9 -std=c++11 main.cpp -lm &amp;&amp; ./a.out\nsandbox/a:\ntotal 12\ndrwxr-xr-x 3 2001 2000 4096 May 28 12:27 .\ndrwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..\ndrwxr-xr-x 2 2001 2000 4096 May 28 12:27 b\n\nsandbox/c:\ntotal 12\ndrwxr-xr-x 3 2001 2000 4096 May 28 12:27 .\ndrwxr-xr-x 4 2001 2000 4096 May 28 12:27 ..\ndrwxr-xr-x 2 2001 2000 4096 May 28 12:27 d\ntotal 8012\ndrwxrwxrwx 2 2001 2000    4096 May 28 12:27 .\ndrwxrwxrwx 3 2002 2000 8175616 May 28 12:27 ..\n-rwxr-xr-x 1 2001 2000    8168 May 28 12:27 a.out\n-rw-rw-rw- 1 2001 2000     517 May 28 12:27 main.cpp\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>We have to create/remove one by one. We could rewrite this code snippet with less lines (using a loop), but we still have to pay attention to creation/deletion order, we cannot remove parent directory before we have removed all children.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Since C&#43;&#43;17, we can create and remove nested directories with just one call.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">Create and remove nested directories C&#43;&#43;17\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;experimental/filesystem&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">namespace\u003C/span> fs = std::experimental::filesystem;\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span>\u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    fs::\u003Cspan class=\"hljs-built_in\">create_directories\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a/b&quot;\u003C/span>);\n    fs::\u003Cspan class=\"hljs-built_in\">create_directories\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/c/d&quot;\u003C/span>);\n    \u003Cspan class=\"hljs-built_in\">system\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;ls -la sandbox/*&quot;\u003C/span>);\n\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;Were directories removed? &quot;\u003C/span> &lt;&lt; fs::\u003Cspan class=\"hljs-built_in\">remove_all\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox&quot;\u003C/span>) &lt;&lt; endl;\n    \u003Cspan class=\"hljs-built_in\">system\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;ls -la&quot;\u003C/span>);\n\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/62c2d22fa0e7144c\">Compile and run: Create and remove nested directories C&#43;&#43;17\u003C/a>.\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">g++ -std=c++1z -fconcepts -fgnu-tm  -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out\nsandbox/a:\ntotal 12\ndrwxr-xr-x 3 2001 2000 4096 May 28 16:45 .\ndrwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..\ndrwxr-xr-x 2 2001 2000 4096 May 28 16:45 b\n\nsandbox/c:\ntotal 12\ndrwxr-xr-x 3 2001 2000 4096 May 28 16:45 .\ndrwxr-xr-x 4 2001 2000 4096 May 28 16:45 ..\ndrwxr-xr-x 2 2001 2000 4096 May 28 16:45 d\nWere directories removed? 1\ntotal 10132\ndrwxrwxrwx 2 2001 2000    4096 May 28 16:45 .\ndrwxrwxrwx 3 2002 2000 8175616 May 28 16:45 ..\n-rwxr-xr-x 1 2001 2000 2170976 May 28 16:45 a.out\n-rw-rw-rw- 1 2001 2000     393 May 28 16:45 main.cpp\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_full_example_recursive_directory_iterator\">Full example: Recursive Directory Iterator\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>This example consists of iterate recursively through dicrectories fintering files by extension.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_c11\">C&#43;&#43;11\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>To keep C&#43;&#43;11 example simple, I haven&#8217;t added filtering  logic, but filtering logic is present in C&#43;&#43;17 example:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">filesystem.11.cpp\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-cpp\" data-lang=\"cpp\">\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;dirent.h&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;cstring&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;iostream&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;fstream&gt;\u003C/span> \u003Cspan class=\"hljs-comment\">// std::ofstream\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;vector&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;memory&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;system_error&gt;\u003C/span>\u003C/span>\n\u003Cspan class=\"hljs-meta\">#\u003Cspan class=\"hljs-keyword\">include\u003C/span> \u003Cspan class=\"hljs-string\">&lt;sys/stat.h&gt;\u003C/span>\u003C/span>\n\n\u003Cspan class=\"hljs-keyword\">using\u003C/span> \u003Cspan class=\"hljs-keyword\">namespace\u003C/span> std;\n\n\u003Cspan class=\"hljs-type\">const\u003C/span> string UP_DIR = \u003Cspan class=\"hljs-string\">&quot;..&quot;\u003C/span>;\n\u003Cspan class=\"hljs-type\">const\u003C/span> string CURRENT_DIR = \u003Cspan class=\"hljs-string\">&quot;.&quot;\u003C/span>;\n\u003Cspan class=\"hljs-type\">const\u003C/span> string SEP = \u003Cspan class=\"hljs-string\">&quot;/&quot;\u003C/span>;\n\n\n\u003Cspan class=\"hljs-function\">string \u003Cspan class=\"hljs-title\">path\u003C/span>\u003Cspan class=\"hljs-params\">(initializer_list&lt;string&gt; parts)\u003C/span>\n\u003C/span>{\n    string pathTmp {};\n    string separator = \u003Cspan class=\"hljs-string\">&quot;&quot;\u003C/span>;\n    \u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-keyword\">auto\u003C/span> &amp; part: parts)\n    {\n        pathTmp.\u003Cspan class=\"hljs-built_in\">append\u003C/span>(separator).\u003Cspan class=\"hljs-built_in\">append\u003C/span>(part);\n        separator = SEP;\n    }\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> pathTmp;\n}\n\n\u003Cspan class=\"hljs-function\">vector&lt;string&gt; \u003Cspan class=\"hljs-title\">getDirectoryFiles\u003C/span>\u003Cspan class=\"hljs-params\">(\u003Cspan class=\"hljs-type\">const\u003C/span> string&amp; dir, \u003Cspan class=\"hljs-type\">const\u003C/span> vector&lt;string&gt; &amp; extensions)\u003C/span>\n\u003C/span>{\n    vector&lt;string&gt; files;\n    \u003Cspan class=\"hljs-function\">shared_ptr&lt;DIR&gt; \u003Cspan class=\"hljs-title\">directory_ptr\u003C/span>\u003Cspan class=\"hljs-params\">(opendir(dir.c_str()), [](DIR* dir){ dir &amp;&amp; closedir(dir); })\u003C/span>\u003C/span>;\n    \u003Cspan class=\"hljs-keyword\">if\u003C/span> (!directory_ptr)\n    {\n        \u003Cspan class=\"hljs-keyword\">throw\u003C/span> \u003Cspan class=\"hljs-built_in\">system_error\u003C/span>(\u003Cspan class=\"hljs-built_in\">error_code\u003C/span>(errno, \u003Cspan class=\"hljs-built_in\">system_category\u003C/span>()), \u003Cspan class=\"hljs-string\">&quot;Error opening : &quot;\u003C/span> + dir);\n    }\n\n    \u003Cspan class=\"hljs-keyword\">struct\u003C/span> \u003Cspan class=\"hljs-title class_\">dirent\u003C/span> *dirent_ptr;\n    \u003Cspan class=\"hljs-keyword\">while\u003C/span> ((dirent_ptr = \u003Cspan class=\"hljs-built_in\">readdir\u003C/span>(directory_ptr.\u003Cspan class=\"hljs-built_in\">get\u003C/span>())) != \u003Cspan class=\"hljs-literal\">nullptr\u003C/span>)\n    {\n        \u003Cspan class=\"hljs-type\">const\u003C/span> string fileName {dirent_ptr-&gt;d_name};\n        \u003Cspan class=\"hljs-keyword\">if\u003C/span> (dirent_ptr-&gt;d_type == DT_DIR)\n        {\n            \u003Cspan class=\"hljs-keyword\">if\u003C/span> (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)\n            {\n                \u003Cspan class=\"hljs-keyword\">auto\u003C/span> subFiles = \u003Cspan class=\"hljs-built_in\">getDirectoryFiles\u003C/span>(\u003Cspan class=\"hljs-built_in\">path\u003C/span>({dir, fileName}), extensions);\n                files.\u003Cspan class=\"hljs-built_in\">insert\u003C/span>(\u003Cspan class=\"hljs-built_in\">end\u003C/span>(files), \u003Cspan class=\"hljs-built_in\">begin\u003C/span>(subFiles), \u003Cspan class=\"hljs-built_in\">end\u003C/span>(subFiles));\n            }\n        }\n        \u003Cspan class=\"hljs-keyword\">else\u003C/span> \u003Cspan class=\"hljs-keyword\">if\u003C/span> (dirent_ptr-&gt;d_type == DT_REG)\n        {\n            \u003Cspan class=\"hljs-comment\">// here we should check also if filename has an extension in extensions vector\u003C/span>\n            files.\u003Cspan class=\"hljs-built_in\">push_back\u003C/span>(\u003Cspan class=\"hljs-built_in\">path\u003C/span>({dir, fileName}));\n        }\n    }\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> files;\n}\n\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-title\">main\u003C/span> \u003Cspan class=\"hljs-params\">()\u003C/span>\n\u003C/span>{\n    \u003Cspan class=\"hljs-keyword\">auto\u003C/span> opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox&quot;\u003C/span>, opt);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a&quot;\u003C/span>, opt);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a/b&quot;\u003C/span>, opt);\n\n\tvector&lt;string&gt; e_files = {\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/a/b/file1.rst&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/a/b/file1.txt&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/a/file2.RST&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/file3.md&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/will_be.ignored&quot;\u003C/span>\n\t};\n\n\t\u003Cspan class=\"hljs-comment\">// create files\u003C/span>\n\t\u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-keyword\">auto\u003C/span> &amp;f: e_files)\n\t{\n\t\t\u003Cspan class=\"hljs-function\">ofstream \u003Cspan class=\"hljs-title\">of\u003C/span>\u003Cspan class=\"hljs-params\">(f, ofstream::out)\u003C/span>\u003C/span>;\n\t\tof &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;test&quot;\u003C/span>;\n\t}\n\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;filtered files: &quot;\u003C/span> &lt;&lt; endl;\n\t\u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-keyword\">auto\u003C/span> &amp;f: \u003Cspan class=\"hljs-built_in\">getDirectoryFiles\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;.&quot;\u003C/span>, {\u003Cspan class=\"hljs-string\">&quot;.rst&quot;\u003C/span>, \u003Cspan class=\"hljs-string\">&quot;.RST&quot;\u003C/span>, \u003Cspan class=\"hljs-string\">&quot;.md&quot;\u003C/span>})){\n\t    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;\\t&quot;\u003C/span> &lt;&lt; f &lt;&lt; endl;\n\t}\n\n    \u003Cspan class=\"hljs-keyword\">return\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/af4228e039a281b3\" target=\"_blank\" rel=\"noopener\">Compile and run C&#43;&#43;11 example\u003C/a>.\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">g++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out\nfiltered files:\n\t./main.cpp\n\t./sandbox/file3.md\n\t./sandbox/will_be.ignored\n\t./sandbox/a/b/file1.rst\n\t./sandbox/a/b/file1.txt\n\t./sandbox/a/file2.RST\n\t./a.out\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_c17\">C&#43;&#43;17\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Following example also filters files by extension.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">filesystem.17.cpp\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">\u003Cspan class=\"hljs-comment\">#include &lt;dirent.h&gt;\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;cstring&gt;\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;iostream&gt;\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;fstream&gt; // std::ofstream\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;vector&gt;\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;memory&gt;\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;system_error&gt;\u003C/span>\n\u003Cspan class=\"hljs-comment\">#include &lt;sys/stat.h&gt;\u003C/span>\n\nusing namespace std;\n\nconst string UP_DIR = \u003Cspan class=\"hljs-string\">&quot;..&quot;\u003C/span>;\nconst string CURRENT_DIR = \u003Cspan class=\"hljs-string\">&quot;.&quot;\u003C/span>;\nconst string SEP = \u003Cspan class=\"hljs-string\">&quot;/&quot;\u003C/span>;\n\n\nstring path(initializer_list&lt;string&gt; parts)\n{\n    string pathTmp {};\n    string separator = \u003Cspan class=\"hljs-string\">&quot;&quot;\u003C/span>;\n    \u003Cspan class=\"hljs-keyword\">for\u003C/span> (auto &amp; part: parts)\n    {\n        pathTmp.append(separator).append(part);\n        separator = SEP;\n    }\n    \u003Cspan class=\"hljs-built_in\">return\u003C/span> pathTmp;\n}\n\nvector&lt;string&gt; getDirectoryFiles(const string&amp; \u003Cspan class=\"hljs-built_in\">dir\u003C/span>, const vector&lt;string&gt; &amp; extensions)\n{\n    vector&lt;string&gt; files;\n    shared_ptr&lt;DIR&gt; directory_ptr(opendir(dir.c_str()), [](DIR* \u003Cspan class=\"hljs-built_in\">dir\u003C/span>){ \u003Cspan class=\"hljs-built_in\">dir\u003C/span> &amp;&amp; closedir(\u003Cspan class=\"hljs-built_in\">dir\u003C/span>); });\n    \u003Cspan class=\"hljs-keyword\">if\u003C/span> (!directory_ptr)\n    {\n        throw system_error(error_code(errno, system_category()), \u003Cspan class=\"hljs-string\">&quot;Error opening : &quot;\u003C/span> + \u003Cspan class=\"hljs-built_in\">dir\u003C/span>);\n    }\n\n    struct dirent *dirent_ptr;\n    \u003Cspan class=\"hljs-keyword\">while\u003C/span> ((dirent_ptr = readdir(directory_ptr.get())) != nullptr)\n    {\n        const string fileName {dirent_ptr-&gt;d_name};\n        \u003Cspan class=\"hljs-keyword\">if\u003C/span> (dirent_ptr-&gt;d_type == DT_DIR)\n        {\n            \u003Cspan class=\"hljs-keyword\">if\u003C/span> (CURRENT_DIR != fileName &amp;&amp; UP_DIR != fileName)\n            {\n                auto subFiles = getDirectoryFiles(path({\u003Cspan class=\"hljs-built_in\">dir\u003C/span>, fileName}), extensions);\n                files.insert(end(files), begin(subFiles), end(subFiles));\n            }\n        }\n        \u003Cspan class=\"hljs-keyword\">else\u003C/span> \u003Cspan class=\"hljs-keyword\">if\u003C/span> (dirent_ptr-&gt;d_type == DT_REG)\n        {\n            // here we should check also \u003Cspan class=\"hljs-keyword\">if\u003C/span> filename has an extension \u003Cspan class=\"hljs-keyword\">in\u003C/span> extensions vector\n            files.push_back(path({\u003Cspan class=\"hljs-built_in\">dir\u003C/span>, fileName}));\n        }\n    }\n    \u003Cspan class=\"hljs-built_in\">return\u003C/span> files;\n}\n\nint \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-title\">main\u003C/span>\u003C/span> ()\n{\n    auto opt = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH;\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox&quot;\u003C/span>, opt);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a&quot;\u003C/span>, opt);\n    \u003Cspan class=\"hljs-built_in\">mkdir\u003C/span>(\u003Cspan class=\"hljs-string\">&quot;sandbox/a/b&quot;\u003C/span>, opt);\n\n\tvector&lt;string&gt; e_files = {\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/a/b/file1.rst&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/a/b/file1.txt&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/a/file2.RST&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/file3.md&quot;\u003C/span>,\n\t    \u003Cspan class=\"hljs-string\">&quot;./sandbox/will_be.ignored&quot;\u003C/span>\n\t};\n\n\t// create files\n\t\u003Cspan class=\"hljs-keyword\">for\u003C/span> (auto &amp;f: e_files)\n\t{\n\t\tofstream of(f, ofstream::out);\n\t\tof &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;test&quot;\u003C/span>;\n\t}\n\n    cout &lt;&lt; \u003Cspan class=\"hljs-string\">&quot;filtered files: &quot;\u003C/span> &lt;&lt; \u003Cspan class=\"hljs-string\">endl;\n\tfor (auto &amp;f: getDirectoryFiles(&quot;.&quot;, {&quot;.rst&quot;, &quot;.RST&quot;, &quot;.md&quot;})){\n\t    cout &lt;&lt; &quot;\\t&quot; &lt;&lt; f &lt;&lt; endl\u003C/span>;\n\t}\n\n    \u003Cspan class=\"hljs-built_in\">return\u003C/span> 0;\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"title\">\u003Ca href=\"https://coliru.stacked-crooked.com/a/af4228e039a281b3\" target=\"_blank\" rel=\"noopener\">Compile and run C&#43;&#43;17 example\u003C/a>.\u003C/div>\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-bash\" data-lang=\"bash\">g++ -std=c++11 -O2 -Wall -Wextra -pedantic -pthread -pedantic-errors main.cpp -lm  -latomic -lstdc++fs &amp;&amp; ./a.out\nfiltered files:\n\t./main.cpp\n\t./sandbox/file3.md\n\t./sandbox/will_be.ignored\n\t./sandbox/a/b/file1.rst\n\t./sandbox/a/b/file1.txt\n\t./sandbox/a/file2.RST\n\t./a.out\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>",props:{title:"Filesystem in C++17",lang:"en",summary:"We are going to analyze with examples new filesystem features coming with C++17",slug:"recursive-directory-iterator",keywords:["C++","C++11","C++17","IO","Filesystem"],filepath:"/static/posts/recursive-directory-iterator.en.adoc",dirpath:"/static/posts",created:1495954800000,modified:1495954800000,otherLangs:["es"],author:"Carlos",previewimage:void 0,path:"/langs/en/posts/recursive-directory-iterator"},jsonLd:"\u003Cscript type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"Webpage\",\"@id\":\"https://google.com/article\"},\"headline\":\"Filesystem in C++17\",\"alternativeHeadline\":\"We are going to analyze with examples new filesystem features coming with C++17\",\"description\":\"We are going to analyze with examples new filesystem features coming with C++17\",\"datePublished\":\"2017-05-28T07:00:00.000Z\",\"dateModified\":\"2017-05-28T07:00:00.000Z\",\"keywords\":[\"C++\",\"C++11\",\"C++17\",\"IO\",\"Filesystem\"],\"author\":{\"@type\":\"Person\",\"name\":\"Carlos\"},\"publisher\":{\"@type\":\"Person\",\"name\":\"Carlos\"}}\u003C/script>"},"uses":{"params":["slug","lang"]}}];

					Promise.all([
						import("../../../../_app/immutable/entry/start.IIzfTrMD.js"),
						import("../../../../_app/immutable/entry/app.B-pbQJ2K.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 8],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
