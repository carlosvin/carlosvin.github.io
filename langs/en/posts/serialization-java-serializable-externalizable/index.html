<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../../favicon.png" />
		<script src="https://cdn.jsdelivr.net/npm/@statsig/js-client@1/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-HFdLXhoqeAqLJGsEO0FuGCieE2nSFNxpPp2ziw3ZPYK"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="/app.css" />
		
		<link href="../../../../_app/immutable/assets/2.D6-wnWlq.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/IconLink.DCDy1KOq.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/Social.BuJ-IkEK.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/8.BrJEuWPS.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/Details.CFCg3rNQ.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/start.C6GL3CUo.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/entry.DS9v2Ffe.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/runtime.Dmq9lEfb.js">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/app.CwDFx9-h.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/render.DEuRsD3K.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/svelte-head.gMhgFLgJ.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/disclose-version.DZGYuMPK.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/if.DdJqp0Gs.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/props.DtZ137fb.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/0.BtfsVLlS.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/misc.Djj4xh76.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/lifecycle.Dfv6L9JC.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/html.B-jAldvN.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/stores.CB3iCtwo.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/2.BdJhhyR_.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/attributes.Dp_OjnNi.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/IconLink.B1K-9nqp.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/Social.D9rHMohW.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/8.BBCEuTE_.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/url.CTei4sZV.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/Details.DX1vSZDn.js"><!--[--><!---->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-1328360-10', 'auto');
	</script>
	<!----><!--]--><!--[--><meta name="date.created" content="2014-05-13T15:00:00.000Z"> <meta name="date.updated" content="2014-05-13T15:00:00.000Z"> <meta name="description" content="Java serialization ways, performance comparison"> <!--[--><!--[--><link rel="alternate" hreflang="es" href="/langs/es/posts/serialization-java-serializable-externalizable"><!--]--><!--]--> <!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"Webpage","@id":"https://google.com/article"},"headline":"Java serialization ways: Performance Comparison","alternativeHeadline":"Java serialization ways, performance comparison","description":"Java serialization ways, performance comparison","datePublished":"2014-05-13T15:00:00.000Z","dateModified":"2014-05-13T15:00:00.000Z","keywords":["Java","Performance"],"author":{"@type":"Person","name":"Carlos"},"publisher":{"@type":"Person","name":"Carlos"}}</script><!----><!--]--><title>Java serialization ways: Performance Comparison</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!--[--><!--]--> <!----><!--[--><!----><nav class="svelte-1kqmhwi"><ul class="svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/en/posts" rel="prefetch" class="svelte-1rykg79"><!----><img class="logo svelte-1kqmhwi" src="/favicon.png" alt="Carlos Say's Bla Bla logo"><!----></a></li><!----></ul> <ul class="closed svelte-1kqmhwi"><li class="svelte-1rykg79"><a aria-current="page" href="/langs/en/posts" rel="prefetch" class="svelte-1rykg79"><!----><span class="siteName">Carlos Say's Bla Bla</span><!----></a></li><!----> <li class="svelte-1rykg79"><a href="/langs/en/categories" rel="prefetch" class="svelte-1rykg79"><!----><!---->Categories<!----></a></li><!----> <li class="svelte-1rykg79"><a href="/langs/en/about" rel="prefetch" class="svelte-1rykg79"><!----><!---->About me<!----></a></li><!----></ul> <!--[--><!----><div class="h svelte-geb0ta"><!----><a href="/langs/en/feed.xml" target="_blank" class="icon rss svelte-blgowr" title="Subscribe to the feed Carlos Say's Bla Bla" rel="noopener" aria-label="Subscribe to the feed Carlos Say's Bla Bla"><!----><!----></a><!----> <a href="https://github.com/carlosvin" target="_blank" class="icon github svelte-blgowr" title="Find me at github" rel="noopener" aria-label="Find me at github"><!----><!----></a><!----> <a href="https://stackoverflow.com/users/1421059/carlosvin" target="_blank" class="icon stackoverflow svelte-blgowr" title="Find me at stackoverflow" rel="noopener" aria-label="Find me at stackoverflow"><!----><!----></a><!----></div><!----><!--]--> <button type="button" class="svelte-1kqmhwi">≡</button></nav><!----> <main class="svelte-7ld3yf"><!----><!----><header class="svelte-1ikjkmw"><h1 class="svelte-1ikjkmw">Java serialization ways: Performance Comparison <span class="share svelte-1ikjkmw"><!--[!--><a href="https://twitter.com/intent/tweet?url=/langs/en/posts/serialization-java-serializable-externalizable&amp;text=Java serialization ways: Performance Comparison:&amp;nbsp;Java serialization ways, performance comparison&amp;hashtags=Java,Performance" target="_blank" class="icon twitter svelte-blgowr" title="Share &quot;Java serialization ways: Performance Comparison&quot;" rel="noopener" aria-label="Share &quot;Java serialization ways: Performance Comparison&quot;"><!----><!----></a><!--]--><!----></span></h1> <p class="summary svelte-1ikjkmw">Java serialization ways, performance comparison</p> <div class="subtitle svelte-9uod0d"><span class="date">5/13/2014</span> <span class="langs"><!--[--><ul class="otherLangs svelte-1numgf3"><!--[--><!--[--><li class="svelte-1numgf3"><a rel="alternate" hreflang="es" href="/langs/es/posts/serialization-java-serializable-externalizable" title="Check the post in other language: es">es</a></li><!--]--><!--]--></ul><!--]--><!----></span> <!--[--><span class="tags svelte-wqh6y7"><!--[--><a href="/langs/en/categories/java" title="Java" class="svelte-1g7d2s3">Java</a><a href="/langs/en/categories/performance" title="Performance" class="svelte-1g7d2s3">Performance</a><!--]--></span><!--]--><!----></div><!----></header> <div class="postContent"><!----><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_serializable">Serializable</a></li>
<li><a href="#_externalizable">Externalizable</a></li>
<li><a href="#_performance_tests_serializable_vs_externalizable">Performance tests (Serializable vs. Externalizable)</a>
<ul class="sectlevel2">
<li><a href="#_implementing_serializable">Implementing Serializable</a></li>
<li><a href="#_implementing_externalizable_wrong_way">Implementing Externalizable (wrong way)</a></li>
<li><a href="#_implementing_externalizable_right_way">Implementing Externalizable (right way)</a></li>
<li><a href="#_results_analysis">Results Analysis</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recently I&#8217;ve had to serialize/deserialize some data in <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> binary format. Lately I use <a href="https://www.json.org" target="_blank" rel="noopener">JSON</a> or <a href="https://en.wikipedia.org/wiki/XML" target="_blank" rel="noopener">XML</a> formats.</p>
</div>
<div class="paragraph">
<p>I remember that to serialize <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> objects they must implement the <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html" target="_blank" rel="noopener">Serializable</a> interface, but I had also read in Internet other way, implementing the <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html" target="_blank" rel="noopener">Externalizable</a> interface, then, which interface must I implement? It depends on what you want such as everything in the life.</p>
</div>
<div class="paragraph">
<p>When to use <a href="#_serializable">Serializable</a> or <a href="#_externalizable">Externalizable</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serializable">Serializable</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To serialize easily. You have to write less code.</p>
</li>
<li>
<p>This way has some restrictions: The object to serialize must implement the default constructor (0 args). It must be responsible to manage the parent class attributes.</p>
</li>
<li>
<p>The performance is not as important, we will see more about that in <a href="#_performance_tests_serializable_vs_externalizable">Performance tests (Serializable vs. Externalizable)</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_externalizable">Externalizable</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You must implement the serialization/deserialization methods, so you have to write more code.</p>
</li>
<li>
<p>When you cannot use <a href="#_serializable">Serializable</a>.</p>
</li>
<li>
<p>When you want to improve the performance, as we&#8217;ll see in <a href="#_performance_tests_serializable_vs_externalizable">Performance tests (Serializable vs. Externalizable)</a>.</p>
</li>
<li>
<p>If you have to manage the serialization of parent class attributes, then I recommend you use <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html" target="_blank" rel="noopener">Externalizable</a>, because we&#8217;ll avoid a weird private methods overriding.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeObject</span><span class="hljs-params">(ObjectOutputStream oos)</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(ObjectInputStream ois)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_performance_tests_serializable_vs_externalizable">Performance tests (Serializable vs. Externalizable)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#_serializable">Serializable</a>: Java, through introspection, guesses the types of class attributes to know how to serialize/deserialize them, but this "magic" is not free, it has a performance penalty.</p>
</div>
<div class="paragraph">
<p>When we use <a href="#_externalizable">Externalizable</a> interface, we decide how to serialize/deserialize, namely we have to write the code that does it. We&#8217;ve lost ease, but also we avoid that <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> does some tasks, so if we override the methods properly, we&#8217;ll get a performance improvement.</p>
</div>
<div class="paragraph">
<p>To know how big is the performance difference between both interfaces, I&#8217;ve written a <a href="https://github.com/carlosvin/serializations-performance-java" target="_blank" rel="noopener">tiny example in which we serialize an object with 2 collections with 100000 elements each one</a>. Here you can find the <a href="http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html" target="_blank" rel="noopener">tests execution results</a>. There are 3 different implementations:</p>
</div>
<div class="sect2">
<h3 id="_implementing_serializable">Implementing Serializable</h3>
<div class="paragraph">
<p>As we mentioned above, <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> has to guess certain things. During this process it sacrifices some of performance (slowest way), in exchange we get really simple source code, the class to serialize just has to implement the <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html" target="_blank" rel="noopener">Serializable</a> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Contacts</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
  <span class="hljs-comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>serializing: 1133 millisecond</p>
</li>
<li>
<p>deserializing: 506 millisecond</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_externalizable_wrong_way">Implementing Externalizable (wrong way)</h3>
<div class="paragraph">
<p>If the class implements <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html" target="_blank" rel="noopener">Externalizable</a>, we must tell to <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> how it has to serialize/deserialize the class attributes. We just have to be careful, because if we did it bad, then we&#8217;ll get the worst of the both worlds: more complex implementation and bad performance, i.e: If we serialize/deserialize complex class attributes (like collections), <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> will also have to guess many things about the attributes type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readExternal</span><span class="hljs-params">(ObjectInput in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
  setEmails((Set&lt;String&gt;) in.readObject());
  setPhones((Set&lt;String&gt;) in.readObject());
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeExternal</span><span class="hljs-params">(ObjectOutput out)</span> <span class="hljs-keyword">throws</span> IOException {
  out.writeObject(emails);
  out.writeObject(phones);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>serializing: 737 millisecond</p>
</li>
<li>
<p>deserializing: 367 millisecond</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_externalizable_right_way">Implementing Externalizable (right way)</h3>
<div class="paragraph">
<p>If we serialize one by one the collection elements, then we&#8217;ll save more time, because <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> serializes simple types, this way avoids guessing things that we actually know.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readExternal</span><span class="hljs-params">(ObjectInput in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
  emails.clear();
  phones.clear();
  <span class="hljs-type">int</span> <span class="hljs-variable">nEmails</span> <span class="hljs-operator">=</span> in.readInt();
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nEmails; i++) {
    emails.add(in.readUTF());
  }
  <span class="hljs-type">int</span> <span class="hljs-variable">nPhones</span> <span class="hljs-operator">=</span> in.readInt();
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nPhones; i++) {
    phones.add(in.readUTF());
  }
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeExternal</span><span class="hljs-params">(ObjectOutput out)</span> <span class="hljs-keyword">throws</span> IOException {
  out.writeInt(emails.size());
  <span class="hljs-keyword">for</span> (String e : emails) {
    out.writeUTF(e);
  }
  out.writeInt(phones.size());
  <span class="hljs-keyword">for</span> (String p : phones) {
    out.writeUTF(p);
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>serializing: 204 millisecond</p>
</li>
<li>
<p>deserializing: 92 millisecond</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ve gained performance at expense of write more code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_results_analysis">Results Analysis</h3>
<div class="paragraph">
<p>We don&#8217;t gain performance due to use an interface or the other one.</p>
</div>
<div class="paragraph">
<p>We gain performance because <a href="#_externalizable">Externalizable</a> interface forces us to implement ourselves the guessing code, so <a href="https://www.java.com" target="_blank" rel="noopener">Java</a> doesn&#8217;t have to do that.</p>
</div>
<div class="paragraph">
<p>As we have seen at <a href="#_implementing_externalizable_wrong_way">Implementing Externalizable (wrong way)</a>, si no tenemos cuidado, conseguiremos una mejora poco significativa a costa de complicar nuestro código fuente.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html" target="_blank" rel="noopener">Test results</a>.</p>
</li>
<li>
<p><a href="https://github.com/carlosvin/serializations-performance-java/">Code in Github</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div><!----> <div class="comments"><script src="https://utteranc.es/client.js" repo="carlosvin/carlosvin.github.io" issue-term="title" label="comment" theme="github-light" crossorigin="anonymous" async>
	</script></div><!----></div><!----><!----><!----></main><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_97huwt = {
						base: new URL("../../../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{path:"/langs/en/posts/serialization-java-serializable-externalizable/",lang:"en",translations:{lang:"en",author:"Carlos Martin Sanchez",siteName:"Carlos Say's Bla Bla",siteDescription:"What is going on in my mind and its surroundings",categories:"categories",Categories:"Categories",RecentPosts:"Recent posts",NoPosts:"There are no posts",SubscribeTo:"Subscribe to the feed",AboutMe:"About me",AllPosts:"All posts"}},"uses":{"params":["lang"],"url":1},"slash":"always"},{"type":"data","data":{html:"\u003Cdiv id=\"toc\" class=\"toc\">\n\u003Cdiv id=\"toctitle\">Table of Contents\u003C/div>\n\u003Cul class=\"sectlevel1\">\n\u003Cli>\u003Ca href=\"#_serializable\">Serializable\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_externalizable\">Externalizable\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_performance_tests_serializable_vs_externalizable\">Performance tests (Serializable vs. Externalizable)\u003C/a>\n\u003Cul class=\"sectlevel2\">\n\u003Cli>\u003Ca href=\"#_implementing_serializable\">Implementing Serializable\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_implementing_externalizable_wrong_way\">Implementing Externalizable (wrong way)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_implementing_externalizable_right_way\">Implementing Externalizable (right way)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#_results_analysis\">Results Analysis\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv id=\"preamble\">\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>Recently I&#8217;ve had to serialize/deserialize some data in \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> binary format. Lately I use \u003Ca href=\"https://www.json.org\" target=\"_blank\" rel=\"noopener\">JSON\u003C/a> or \u003Ca href=\"https://en.wikipedia.org/wiki/XML\" target=\"_blank\" rel=\"noopener\">XML\u003C/a> formats.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>I remember that to serialize \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> objects they must implement the \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html\" target=\"_blank\" rel=\"noopener\">Serializable\u003C/a> interface, but I had also read in Internet other way, implementing the \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html\" target=\"_blank\" rel=\"noopener\">Externalizable\u003C/a> interface, then, which interface must I implement? It depends on what you want such as everything in the life.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>When to use \u003Ca href=\"#_serializable\">Serializable\u003C/a> or \u003Ca href=\"#_externalizable\">Externalizable\u003C/a>.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_serializable\">Serializable\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>To serialize easily. You have to write less code.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>This way has some restrictions: The object to serialize must implement the default constructor (0 args). It must be responsible to manage the parent class attributes.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>The performance is not as important, we will see more about that in \u003Ca href=\"#_performance_tests_serializable_vs_externalizable\">Performance tests (Serializable vs. Externalizable)\u003C/a>.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_externalizable\">Externalizable\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>You must implement the serialization/deserialization methods, so you have to write more code.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>When you cannot use \u003Ca href=\"#_serializable\">Serializable\u003C/a>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>When you want to improve the performance, as we&#8217;ll see in \u003Ca href=\"#_performance_tests_serializable_vs_externalizable\">Performance tests (Serializable vs. Externalizable)\u003C/a>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>If you have to manage the serialization of parent class attributes, then I recommend you use \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html\" target=\"_blank\" rel=\"noopener\">Externalizable\u003C/a>, because we&#8217;ll avoid a weird private methods overriding.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-keyword\">private\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">writeObject\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectOutputStream oos)\u003C/span>\n\u003Cspan class=\"hljs-keyword\">private\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">readObject\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectInputStream ois)\u003C/span>\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect1\">\n\u003Ch2 id=\"_performance_tests_serializable_vs_externalizable\">Performance tests (Serializable vs. Externalizable)\u003C/h2>\n\u003Cdiv class=\"sectionbody\">\n\u003Cdiv class=\"paragraph\">\n\u003Cp>\u003Ca href=\"#_serializable\">Serializable\u003C/a>: Java, through introspection, guesses the types of class attributes to know how to serialize/deserialize them, but this \"magic\" is not free, it has a performance penalty.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>When we use \u003Ca href=\"#_externalizable\">Externalizable\u003C/a> interface, we decide how to serialize/deserialize, namely we have to write the code that does it. We&#8217;ve lost ease, but also we avoid that \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> does some tasks, so if we override the methods properly, we&#8217;ll get a performance improvement.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>To know how big is the performance difference between both interfaces, I&#8217;ve written a \u003Ca href=\"https://github.com/carlosvin/serializations-performance-java\" target=\"_blank\" rel=\"noopener\">tiny example in which we serialize an object with 2 collections with 100000 elements each one\u003C/a>. Here you can find the \u003Ca href=\"http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html\" target=\"_blank\" rel=\"noopener\">tests execution results\u003C/a>. There are 3 different implementations:\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_implementing_serializable\">Implementing Serializable\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>As we mentioned above, \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> has to guess certain things. During this process it sacrifices some of performance (slowest way), in exchange we get really simple source code, the class to serialize just has to implement the \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html\" target=\"_blank\" rel=\"noopener\">Serializable\u003C/a> interface.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">class\u003C/span> \u003Cspan class=\"hljs-title class_\">Contacts\u003C/span> \u003Cspan class=\"hljs-keyword\">implements\u003C/span> \u003Cspan class=\"hljs-title class_\">Serializable\u003C/span> {\n  \u003Cspan class=\"hljs-comment\">// ...\u003C/span>\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>serializing: 1133 millisecond\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>deserializing: 506 millisecond\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_implementing_externalizable_wrong_way\">Implementing Externalizable (wrong way)\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>If the class implements \u003Ca href=\"https://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html\" target=\"_blank\" rel=\"noopener\">Externalizable\u003C/a>, we must tell to \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> how it has to serialize/deserialize the class attributes. We just have to be careful, because if we did it bad, then we&#8217;ll get the worst of the both worlds: more complex implementation and bad performance, i.e: If we serialize/deserialize complex class attributes (like collections), \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> will also have to guess many things about the attributes type.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">readExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectInput in)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException, ClassNotFoundException {\n  setEmails((Set&lt;String&gt;) in.readObject());\n  setPhones((Set&lt;String&gt;) in.readObject());\n}\n\n\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">writeExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectOutput out)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException {\n  out.writeObject(emails);\n  out.writeObject(phones);\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>serializing: 737 millisecond\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>deserializing: 367 millisecond\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_implementing_externalizable_right_way\">Implementing Externalizable (right way)\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>If we serialize one by one the collection elements, then we&#8217;ll save more time, because \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> serializes simple types, this way avoids guessing things that we actually know.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"listingblock\">\n\u003Cdiv class=\"content\">\n\u003Cpre class=\"highlight\">\u003Ccode class=\"language-java\" data-lang=\"java\">\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">readExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectInput in)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException, ClassNotFoundException {\n  emails.clear();\n  phones.clear();\n  \u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">nEmails\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> in.readInt();\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">i\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>; i &lt; nEmails; i++) {\n    emails.add(in.readUTF());\n  }\n  \u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">nPhones\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> in.readInt();\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (\u003Cspan class=\"hljs-type\">int\u003C/span> \u003Cspan class=\"hljs-variable\">i\u003C/span> \u003Cspan class=\"hljs-operator\">=\u003C/span> \u003Cspan class=\"hljs-number\">0\u003C/span>; i &lt; nPhones; i++) {\n    phones.add(in.readUTF());\n  }\n}\n\n\u003Cspan class=\"hljs-meta\">@Override\u003C/span>\n\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title function_\">writeExternal\u003C/span>\u003Cspan class=\"hljs-params\">(ObjectOutput out)\u003C/span> \u003Cspan class=\"hljs-keyword\">throws\u003C/span> IOException {\n  out.writeInt(emails.size());\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (String e : emails) {\n    out.writeUTF(e);\n  }\n  out.writeInt(phones.size());\n  \u003Cspan class=\"hljs-keyword\">for\u003C/span> (String p : phones) {\n    out.writeUTF(p);\n  }\n}\u003C/code>\u003C/pre>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>serializing: 204 millisecond\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>deserializing: 92 millisecond\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>We&#8217;ve gained performance at expense of write more code.\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003Cdiv class=\"sect2\">\n\u003Ch3 id=\"_results_analysis\">Results Analysis\u003C/h3>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>We don&#8217;t gain performance due to use an interface or the other one.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>We gain performance because \u003Ca href=\"#_externalizable\">Externalizable\u003C/a> interface forces us to implement ourselves the guessing code, so \u003Ca href=\"https://www.java.com\" target=\"_blank\" rel=\"noopener\">Java\u003C/a> doesn&#8217;t have to do that.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"paragraph\">\n\u003Cp>As we have seen at \u003Ca href=\"#_implementing_externalizable_wrong_way\">Implementing Externalizable (wrong way)\u003C/a>, si no tenemos cuidado, conseguiremos una mejora poco significativa a costa de complicar nuestro código fuente.\u003C/p>\n\u003C/div>\n\u003Cdiv class=\"ulist\">\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Ca href=\"http://carlosvin.github.io/serializations-performance-java/classes/com.github.carlosvin.contacts.SerializationTest.html\" target=\"_blank\" rel=\"noopener\">Test results\u003C/a>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://github.com/carlosvin/serializations-performance-java/\">Code in Github\u003C/a>.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/div>\n\u003C/div>\n\u003C/div>\n\u003C/div>",props:{title:"Java serialization ways: Performance Comparison",lang:"en",summary:"Java serialization ways, performance comparison",slug:"serialization-java-serializable-externalizable",keywords:["Java","Performance"],filepath:"/static/posts/serialization-java-serializable-externalizable.en.adoc",dirpath:"/static/posts",created:1399993200000,modified:1399993200000,otherLangs:["es"],author:"Carlos",previewimage:void 0,path:"/langs/en/posts/serialization-java-serializable-externalizable"},jsonLd:"\u003Cscript type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"Webpage\",\"@id\":\"https://google.com/article\"},\"headline\":\"Java serialization ways: Performance Comparison\",\"alternativeHeadline\":\"Java serialization ways, performance comparison\",\"description\":\"Java serialization ways, performance comparison\",\"datePublished\":\"2014-05-13T15:00:00.000Z\",\"dateModified\":\"2014-05-13T15:00:00.000Z\",\"keywords\":[\"Java\",\"Performance\"],\"author\":{\"@type\":\"Person\",\"name\":\"Carlos\"},\"publisher\":{\"@type\":\"Person\",\"name\":\"Carlos\"}}\u003C/script>"},"uses":{"params":["slug","lang"]}}];

					Promise.all([
						import("../../../../_app/immutable/entry/start.C6GL3CUo.js"),
						import("../../../../_app/immutable/entry/app.CwDFx9-h.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 8],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
